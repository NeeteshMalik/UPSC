/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => main_default
});
module.exports = __toCommonJS(main_exports);

// src/taskmarker-Plugin.ts
var import_obsidian4 = require("obsidian");

// src/taskmarker-TaskMarker.ts
var import_obsidian = require("obsidian");
var TaskMarker = class {
  constructor(app) {
    this.app = app;
    this.app = app;
    this.anyListItem = new RegExp(/^([\s>]*- )([^\\[].*)$/);
    this.anyTaskMark = new RegExp(/^([\s>]*- \[)(.)(\] .*)$/);
    this.blockQuote = new RegExp(/^(\s*>[\s>]*)(.*)$/);
    this.blockRef = new RegExp(/^(.*?)( \^[A-Za-z0-9-]+)?$/);
    this.continuation = new RegExp(/^( {2,}|\t)/);
    this.stripTask = new RegExp(/^([\s>]*-) \[.\] (.*)$/);
  }
  updateSettings(settings) {
    this.settings = settings;
    let momentMatchString = null;
    if (settings.appendDateFormat) {
      const literals = [];
      const regex1 = RegExp("(\\[.*?\\]\\]?)", "g");
      let match;
      let i = 0;
      momentMatchString = settings.appendDateFormat;
      while ((match = regex1.exec(momentMatchString)) !== null) {
        momentMatchString = momentMatchString.replace(
          match[0],
          `%$${i}$%`
        );
        literals.push(
          match[0].substring(1, match[0].length - 1).replace(/\(/g, "\\(").replace(/\)/g, "\\)").replace(/\[/g, "\\[").replace(/\]/g, "\\]")
        );
        i++;
      }
      momentMatchString = momentMatchString.replace("YYYY", "\\d{4}").replace("YY", "\\d{2}").replace("DD", "\\d{2}").replace("D", "\\d{1,2}").replace("MMM", "[A-Za-z]{3}").replace("MM", "\\d{2}").replace("M", "\\d{1,2}").replace("HH", "\\d{2}").replace("H", "\\d{1,2}").replace("hh", "\\d{2}").replace("h", "\\d{1,2}").replace("mm", "\\d{2}").replace("m", "\\d{1,2}");
      if (literals.length > 0) {
        for (let i2 = 0; i2 < literals.length; i2++) {
          momentMatchString = momentMatchString.replace(
            `%$${i2}$%`,
            literals[i2]
          );
        }
      }
      momentMatchString = `\\s*${momentMatchString}\\s*`;
    }
    if (settings.appendTextFormatMark) {
      const literals = [];
      const regex1 = RegExp("(\\[.*?\\]\\]?)", "g");
      let match;
      let i = 0;
      momentMatchString = settings.appendTextFormatMark;
      while ((match = regex1.exec(momentMatchString)) !== null) {
        momentMatchString = momentMatchString.replace(
          match[0],
          `%$${i}$%`
        );
        literals.push(
          match[0].substring(1, match[0].length - 1).replace(/\(/g, "\\(").replace(/\)/g, "\\)").replace(/\[/g, "\\[").replace(/\]/g, "\\]")
        );
        i++;
      }
      momentMatchString = momentMatchString.replace("YYYY", "\\d{4}").replace("YY", "\\d{2}").replace("DD", "\\d{2}").replace("D", "\\d{1,2}").replace("MMM", "[A-Za-z]{3}").replace("MM", "\\d{2}").replace("M", "\\d{1,2}").replace("HH", "\\d{2}").replace("H", "\\d{1,2}").replace("hh", "\\d{2}").replace("h", "\\d{1,2}").replace("mm", "\\d{2}").replace("m", "\\d{1,2}");
      if (literals.length > 0) {
        for (let i2 = 0; i2 < literals.length; i2++) {
          momentMatchString = momentMatchString.replace(
            `%$${i2}$%`,
            literals[i2]
          );
        }
      }
      momentMatchString = `\\s*${momentMatchString}\\s*`;
    }
    if (settings.appendTextFormatMarkRow2) {
      const literals = [];
      const regex1 = RegExp("(\\[.*?\\]\\]?)", "g");
      let match;
      let i = 0;
      momentMatchString = settings.appendTextFormatMarkRow2;
      while ((match = regex1.exec(momentMatchString)) !== null) {
        momentMatchString = momentMatchString.replace(
          match[0],
          `%$${i}$%`
        );
        literals.push(
          match[0].substring(1, match[0].length - 1).replace(/\(/g, "\\(").replace(/\)/g, "\\)").replace(/\[/g, "\\[").replace(/\]/g, "\\]")
        );
        i++;
      }
      momentMatchString = momentMatchString.replace("YYYY", "\\d{4}").replace("YY", "\\d{2}").replace("DD", "\\d{2}").replace("D", "\\d{1,2}").replace("MMM", "[A-Za-z]{3}").replace("MM", "\\d{2}").replace("M", "\\d{1,2}").replace("HH", "\\d{2}").replace("H", "\\d{1,2}").replace("hh", "\\d{2}").replace("h", "\\d{1,2}").replace("mm", "\\d{2}").replace("m", "\\d{1,2}");
      if (literals.length > 0) {
        for (let i2 = 0; i2 < literals.length; i2++) {
          momentMatchString = momentMatchString.replace(
            `%$${i2}$%`,
            literals[i2]
          );
        }
      }
      momentMatchString = `\\s*${momentMatchString}\\s*`;
    }
    if (settings.appendTextFormatCreation) {
      const literals = [];
      const regex1 = RegExp("(\\[.*?\\]\\]?)", "g");
      let match;
      let i = 0;
      momentMatchString = settings.appendTextFormatCreation;
      while ((match = regex1.exec(momentMatchString)) !== null) {
        momentMatchString = momentMatchString.replace(
          match[0],
          `%$${i}$%`
        );
        literals.push(
          match[0].substring(1, match[0].length - 1).replace(/\(/g, "\\(").replace(/\)/g, "\\)").replace(/\[/g, "\\[").replace(/\]/g, "\\]")
        );
        i++;
      }
      momentMatchString = momentMatchString.replace("YYYY", "\\d{4}").replace("YY", "\\d{2}").replace("DD", "\\d{2}").replace("D", "\\d{1,2}").replace("MMM", "[A-Za-z]{3}").replace("MM", "\\d{2}").replace("M", "\\d{1,2}").replace("HH", "\\d{2}").replace("H", "\\d{1,2}").replace("hh", "\\d{2}").replace("h", "\\d{1,2}").replace("mm", "\\d{2}").replace("m", "\\d{1,2}");
      if (literals.length > 0) {
        for (let i2 = 0; i2 < literals.length; i2++) {
          momentMatchString = momentMatchString.replace(
            `%$${i2}$%`,
            literals[i2]
          );
        }
      }
      momentMatchString = `\\s*${momentMatchString}\\s*`;
    }
    if (settings.appendTextFormatAppend) {
      const literals = [];
      const regex1 = RegExp("(\\[.*?\\]\\]?)", "g");
      let match;
      let i = 0;
      momentMatchString = settings.appendTextFormatAppend;
      while ((match = regex1.exec(momentMatchString)) !== null) {
        momentMatchString = momentMatchString.replace(
          match[0],
          `%$${i}$%`
        );
        literals.push(
          match[0].substring(1, match[0].length - 1).replace(/\(/g, "\\(").replace(/\)/g, "\\)").replace(/\[/g, "\\[").replace(/\]/g, "\\]")
        );
        i++;
      }
      momentMatchString = momentMatchString.replace("YYYY", "\\d{4}").replace("YY", "\\d{2}").replace("DD", "\\d{2}").replace("D", "\\d{1,2}").replace("MMM", "[A-Za-z]{3}").replace("MM", "\\d{2}").replace("M", "\\d{1,2}").replace("HH", "\\d{2}").replace("H", "\\d{1,2}").replace("hh", "\\d{2}").replace("h", "\\d{1,2}").replace("mm", "\\d{2}").replace("m", "\\d{1,2}");
      if (literals.length > 0) {
        for (let i2 = 0; i2 < literals.length; i2++) {
          momentMatchString = momentMatchString.replace(
            `%$${i2}$%`,
            literals[i2]
          );
        }
      }
      momentMatchString = `\\s*${momentMatchString}\\s*`;
    }
    const completedTasks = (this.settings.onlyLowercaseX ? "x" : "xX") + (this.settings.supportCanceledTasks ? "-" : "");
    if (this.settings.incompleteTaskValues.indexOf(" ") < 0) {
      this.settings.incompleteTaskValues = " " + this.settings.incompleteTaskValues;
    }
    const rightClickTaskMenu = this.settings.rightClickComplete || this.settings.rightClickMark || this.settings.rightClickCycle || this.settings.rightClickCreate || this.settings.rightClickAppend || this.settings.rightClickResetTask || this.settings.rightClickResetAll || this.settings.rightClickToggleAll;
    this.initSettings = {
      removeRegExp: this.tryCreateRemoveRegex(
        this.settings.removeExpression
      ),
      resetRegExp: this.tryCreateResetRegex(momentMatchString),
      incompleteTaskRegExp: this.tryCreateIncompleteRegex(
        this.settings.incompleteTaskValues
      ),
      incompleteTaskRegExpRow2: this.tryCreateIncompleteRegex(
        this.settings.incompleteTaskValuesRow2
      ),
      rightClickTaskMenu,
      registerHandlers: rightClickTaskMenu || this.settings.previewOnClick,
      completedTasks,
      completedTaskRegExp: this.tryCreateCompleteRegex(completedTasks)
    };
    console.debug(
      "Task Marker: updated configuration %o, %o",
      this.settings,
      this.initSettings
    );
  }
  tryCreateRemoveRegex(param) {
    return param ? new RegExp(param, "g") : null;
  }
  tryCreateResetRegex(param) {
    return param ? new RegExp(param + "( \\^[A-Za-z0-9-]+)?$") : null;
  }
  tryCreateCompleteRegex(param) {
    return new RegExp(`^([\\s>]*- \\[)[${param}](\\] .*)$`);
  }
  tryCreateIncompleteRegex(param) {
    return new RegExp(`^([\\s>]*- \\[)[${param}](\\] .*)$`);
  }
  removeCheckboxFromLine(lineText) {
    return lineText.replace(this.stripTask, "$1 $2");
  }
  completeTaskLine(lineText, mark = "x") {
    console.debug("Task Marker: complete task with %s: %s", mark, lineText);
    let marked = lineText.replace(this.anyTaskMark, `$1${mark}$3`);
    if (this.initSettings.removeRegExp) {
      marked = marked.replace(this.initSettings.removeRegExp, "");
    }
    if (this.settings.appendDateFormat) {
      const strictLineEnding = lineText.endsWith("  ");
      let blockid = "";
      const match = this.blockRef.exec(marked);
      if (match && match[2]) {
        marked = match[1];
        blockid = match[2];
      }
      if (!marked.endsWith(" ")) {
        marked += " ";
      }
      marked += (0, import_obsidian.moment)().format(this.settings.appendDateFormat) + blockid;
      if (strictLineEnding) {
        marked += "  ";
      }
    }
    return marked;
  }
  markAllTasksComplete(source, mark) {
    const lines = source.split("\n");
    const result = [];
    for (const line of lines) {
      if (this.initSettings.incompleteTaskRegExp.exec(line)) {
        result.push(this.completeTaskLine(line, mark));
      } else if (this.initSettings.incompleteTaskRegExpRow2.exec(line)) {
        result.push(this.completeTaskLine(line, mark));
      } else {
        result.push(line);
      }
    }
    return result.join("\n");
  }
  markTaskInSource(source, mark, lines = []) {
    const split = source.split("\n");
    for (const n of lines) {
      split[n] = this.markTaskLine(split[n], mark);
    }
    return split.join("\n");
  }
  markTaskInSourceCycle(source, mark, lines = []) {
    const split = source.split("\n");
    for (const n of lines) {
      split[n] = this.markTaskLineCycle(split[n], mark);
    }
    return split.join("\n");
  }
  markTaskInSourceCreate(source, mark, lines = []) {
    const split = source.split("\n");
    for (const n of lines) {
      split[n] = this.markTaskLineCreate(split[n], mark);
    }
    return split.join("\n");
  }
  appendTextInSource(source, mark, lines = []) {
    const split = source.split("\n");
    for (const n of lines) {
      split[n] = this.appendTextLine(split[n], mark);
    }
    return split.join("\n");
  }
  markTaskLine(lineText, mark) {
    const taskMatch = this.anyTaskMark.exec(lineText);
    const markString = "- [" + mark + "] ";
    if (mark === "Backspace") {
      lineText = this.removeCheckboxFromLine(lineText);
    } else if (taskMatch) {
      const completeMark = this.initSettings.completedTasks.indexOf(mark) >= 0;
      if (mark !== " ") {
        if (lineText.trim().startsWith(markString)) {
          new import_obsidian.Notice(`Task Marker: task already marked with the same status "${mark}"!`);
        } else {
          let marked = lineText.replace(this.anyTaskMark, `$1${mark}$3`);
          if (this.initSettings.removeRegExp) {
            marked = marked.replace(this.initSettings.removeRegExp, "");
          }
          if (this.settings.appendDateFormat && completeMark) {
            const strictLineEnding = lineText.endsWith("  ");
            let blockid = "";
            const match = this.blockRef.exec(marked);
            if (match && match[2]) {
              marked = match[1];
              blockid = match[2];
            }
            if (!marked.endsWith(" ")) {
              marked += " ";
            }
            marked += (0, import_obsidian.moment)().format(this.settings.appendDateFormat) + blockid;
            if (strictLineEnding) {
              marked += "  ";
            }
          } else if (this.settings.appendTextFormatMark && this.settings.incompleteTaskValues.indexOf(mark) >= 0) {
            const strictLineEnding = lineText.endsWith("  ");
            let blockid = "";
            const match = this.blockRef.exec(marked);
            if (match && match[2]) {
              marked = match[1];
              blockid = match[2];
            }
            if (!marked.endsWith(" ")) {
              marked += " ";
            }
            marked += (0, import_obsidian.moment)().format(this.settings.appendTextFormatMark) + blockid;
            if (strictLineEnding) {
              marked += "  ";
            }
          } else if (this.settings.appendTextFormatMarkRow2 && this.settings.incompleteTaskValuesRow2.indexOf(mark) >= 0) {
            const strictLineEnding = lineText.endsWith("  ");
            let blockid = "";
            const match = this.blockRef.exec(marked);
            if (match && match[2]) {
              marked = match[1];
              blockid = match[2];
            }
            if (!marked.endsWith(" ")) {
              marked += " ";
            }
            marked += (0, import_obsidian.moment)().format(this.settings.appendTextFormatMarkRow2) + blockid;
            if (strictLineEnding) {
              marked += "  ";
            }
          }
          lineText = marked;
        }
      } else if (mark === " ") {
        lineText = this.resetTaskLine(lineText, mark);
      } else {
        new import_obsidian.Notice(`Task Marker: unknown mark ${mark}!`);
        console.log(
          "Task Marker: unknown mark (%s), leaving unchanged: %s",
          mark,
          lineText
        );
      }
    } else if (mark !== "Backspace") {
      const match = this.anyListItem.exec(lineText);
      if (match && match[2]) {
        console.debug("Task Marker: list item, convert to a task %s", lineText);
        lineText = this.markTaskLine(
          `${match[1]}[ ] ${match[2]}`,
          mark
        );
      } else {
        new import_obsidian.Notice(`Task Marker: not a task or list item!`);
        console.debug("Task Marker: not a task or list item %s", lineText);
      }
    }
    return lineText;
  }
  markTaskLineCycle(lineText, mark) {
    const markValue = this.settings.cycleTaskValues;
    const markValueLength = markValue.length;
    let markStringArray = new Array(markValueLength);
    for (let i = 0; i < markValueLength; i++) {
      markStringArray[i] = "- [" + markValue[i] + "] ";
    }
    let markIndex = 0;
    for (let i = 0; i < markValueLength; i++) {
      if (lineText.trim().startsWith(markStringArray[i])) {
        if (i + 2 <= markValueLength) {
          markIndex = i + 1;
        } else {
          markIndex = 0;
        }
      }
    }
    let marked = lineText.replace(this.anyTaskMark, `$1${markValue[markIndex]}$3`);
    if (this.initSettings.removeRegExp) {
      marked = marked.replace(this.initSettings.removeRegExp, "");
    }
    const strictLineEnding = lineText.endsWith("  ");
    let blockid = "";
    const match = this.blockRef.exec(marked);
    if (match && match[2]) {
      marked = match[1];
      blockid = match[2];
    }
    marked += blockid;
    if (strictLineEnding) {
      marked += "  ";
    }
    lineText = marked;
    return lineText;
  }
  markTaskLineCreate(lineText, mark) {
    const taskMatch = this.anyTaskMark.exec(lineText);
    if (taskMatch) {
      if (!lineText.trim().startsWith("- [ ] ")) {
        new import_obsidian.Notice(`Task Marker: task already marked!`);
        console.log("Task Marker: task already marked, leaving unchanged: %s", lineText);
      } else {
        let marked = lineText.replace(this.anyTaskMark, `$1${mark}$3`);
        if (this.settings.appendTextFormatCreation) {
          const strictLineEnding = lineText.endsWith("  ");
          let blockid = "";
          const match = this.blockRef.exec(marked);
          if (match && match[2]) {
            marked = match[1];
            blockid = match[2];
          }
          if (!marked.endsWith(" ")) {
            marked += " ";
          }
          marked += (0, import_obsidian.moment)().format(this.settings.appendTextFormatCreation) + blockid;
          if (strictLineEnding) {
            marked += "  ";
          }
        } else {
          console.log("Task Marker: appending string empty, nothing appended: %s", lineText);
        }
        lineText = marked;
      }
    } else {
      const match = this.anyListItem.exec(lineText);
      if (match && match[2]) {
        console.debug("Task Marker: list item, convert to a task %s", lineText);
        let marked = `${match[1]}[ ] ${match[2]}`;
        if (this.settings.appendTextFormatCreation) {
          const strictLineEnding = lineText.endsWith("  ");
          let blockid = "";
          const match2 = this.blockRef.exec(marked);
          if (match2 && match2[2]) {
            marked = match2[1];
            blockid = match2[2];
          }
          if (!marked.endsWith(" ")) {
            marked += " ";
          }
          marked += (0, import_obsidian.moment)().format(this.settings.appendTextFormatCreation) + blockid;
          if (strictLineEnding) {
            marked += "  ";
          }
        } else {
          console.log("Task Marker: appending string empty, nothing appended: %s", lineText);
        }
        lineText = marked;
      } else {
        new import_obsidian.Notice(`Task Marker: not a task or list item!`);
        console.debug("Task Marker: not a task or list item %s", lineText);
      }
    }
    return lineText;
  }
  appendTextLine(lineText, mark) {
    let marked = lineText;
    if (this.settings.appendTextFormatAppend) {
      const strictLineEnding = lineText.endsWith("  ");
      let blockid = "";
      const match = this.blockRef.exec(marked);
      if (match && match[2]) {
        marked = match[1];
        blockid = match[2];
      }
      if (!marked.endsWith(" ")) {
        marked += " ";
      }
      marked += (0, import_obsidian.moment)().format(this.settings.appendTextFormatAppend) + blockid;
      if (strictLineEnding) {
        marked += "  ";
      }
    } else {
      new import_obsidian.Notice(`Task Marker: appending string empty!`);
      console.log("Task Marker: appending string empty, nothing appended: %s", lineText);
    }
    lineText = marked;
    return lineText;
  }
  resetTaskLine(lineText, mark = " ") {
    console.debug("Task Marker: reset task with %s: %s", mark, lineText);
    lineText = lineText.replace(this.anyTaskMark, `$1${mark}$3`);
    const strictLineEnding = lineText.endsWith("  ");
    let blockid = "";
    const match = this.blockRef.exec(lineText);
    if (match && match[2]) {
      lineText = match[1];
      blockid = match[2];
    }
    if (this.initSettings.resetRegExp) {
      lineText = lineText.replace(this.initSettings.resetRegExp, "");
    }
    lineText = lineText.replace(/\s*$/, blockid);
    if (this.settings.appendRemoveAllTasks && mark !== " ") {
      lineText = this.completeTaskLine(lineText, mark);
    }
    if (strictLineEnding) {
      lineText += "  ";
    }
    return lineText;
  }
  resetAllTasks(source) {
    const lines = source.split("\n");
    const result = [];
    let inCompletedSection = false;
    for (const line of lines) {
      if (inCompletedSection) {
        if (line.startsWith("#") || line.trim() === "---") {
          inCompletedSection = false;
        }
        result.push(line);
      } else if (this.isCompletedTaskLine(line)) {
        result.push(this.resetTaskLine(line));
      } else {
        result.push(line);
      }
    }
    return result.join("\n");
  }
  isCompletedTaskLine(lineText) {
    return this.initSettings.completedTaskRegExp.test(lineText);
  }
  isIncompleteTaskLine(lineText) {
    return this.initSettings.incompleteTaskRegExp.test(lineText) || this.initSettings.incompleteTaskRegExpRow2.test(lineText);
  }
  isTaskLine(lineText) {
    return this.anyTaskMark.test(lineText);
  }
  isContinuation(lineText, inCallout) {
    if (inCallout) {
      const match = this.blockQuote.exec(lineText);
      if (match) {
        return match[1].endsWith(">") || match[1].endsWith("  ") || match[1].endsWith("	");
      }
    }
    return this.continuation.test(lineText);
  }
  isCallout(lineText) {
    return this.blockQuote.test(lineText);
  }
};

// src/taskmarker-Settings.ts
var DEFAULT_SETTINGS = {
  removeExpression: "",
  appendDateFormat: "",
  appendTextFormatMark: "",
  appendTextFormatMarkRow2: "",
  appendTextFormatCreation: "",
  appendTextFormatAppend: "",
  appendRemoveAllTasks: false,
  incompleteTaskValues: " ",
  incompleteTaskValuesRow2: "",
  cycleTaskValues: "",
  onlyLowercaseX: false,
  supportCanceledTasks: true,
  previewOnClick: false,
  rightClickComplete: false,
  rightClickMark: false,
  rightClickCycle: false,
  rightClickCreate: false,
  rightClickAppend: false,
  rightClickResetTask: false,
  rightClickResetAll: false,
  rightClickToggleAll: false
};

// src/taskmarker-SettingsTab.ts
var import_obsidian2 = require("obsidian");
var TaskMarkerSettingsTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin, taskMarker) {
    super(app, plugin);
    this.plugin = plugin;
    this.taskMarker = taskMarker;
  }
  display() {
    this.containerEl.empty();
    this.containerEl.createEl("h1", { text: "Task Marker" });
    const tempSettings = Object.assign(
      this.taskMarker.settings
    );
    this.containerEl.createEl("p", {
      text: "**Reopen the vault or restart Obsidian if the following setting changes do not take effect.**"
    });
    this.containerEl.createEl("h2", { text: "Creating tasks" });
    this.containerEl.createEl("p", {
      text: "Created tasks gain treatment based on the settings below."
    });
    new import_obsidian2.Setting(this.containerEl).setName("Append text to created task").setDesc(
      "Default empty. If set non-empty, append the string of moment.js format to the end of the task text."
    ).addMomentFormat(
      (momentFormat) => momentFormat.setPlaceholder("[\u{1F4DD} ]YYYY-MM-DD").setValue(tempSettings.appendTextFormatCreation).onChange((value) => __async(this, null, function* () {
        try {
          (0, import_obsidian2.moment)().format(value);
          tempSettings.appendTextFormatCreation = value;
          this.taskMarker.updateSettings(tempSettings);
          yield this.plugin.saveSettings();
        } catch (e) {
          console.log(
            `Error parsing specified date format: ${value}`
          );
        }
      }))
    );
    this.containerEl.createEl("h2", { text: "Completing tasks" });
    this.containerEl.createEl("p", {
      text: "Completed tasks gain treatment based on the settings below."
    });
    new import_obsidian2.Setting(this.containerEl).setName("Only support x for completed tasks").setDesc(
      "Only use 'x' (lower case) to indicate completed tasks (hide X (upper case))."
    ).addToggle(
      (toggle) => toggle.setValue(tempSettings.onlyLowercaseX).onChange((value) => __async(this, null, function* () {
        tempSettings.onlyLowercaseX = value;
        this.taskMarker.updateSettings(tempSettings);
        yield this.plugin.saveSettings();
      }))
    );
    new import_obsidian2.Setting(this.containerEl).setName("Support canceled tasks").setDesc(
      "Use '-' to indicate canceled tasks. Canceled tasks are processed in the same way as completed tasks."
    ).addToggle(
      (toggle) => toggle.setValue(tempSettings.supportCanceledTasks).onChange((value) => __async(this, null, function* () {
        tempSettings.supportCanceledTasks = value;
        this.taskMarker.updateSettings(tempSettings);
        yield this.plugin.saveSettings();
      }))
    );
    new import_obsidian2.Setting(this.containerEl).setName("Append text to completed task").setDesc(
      "Default empty. If set non-empty, append the string of moment.js format to the end of the task text."
    ).addMomentFormat(
      (momentFormat) => momentFormat.setPlaceholder("[\u2705 ]YYYY-MM-DD").setValue(tempSettings.appendDateFormat).onChange((value) => __async(this, null, function* () {
        try {
          (0, import_obsidian2.moment)().format(value);
          tempSettings.appendDateFormat = value;
          this.taskMarker.updateSettings(tempSettings);
          yield this.plugin.saveSettings();
        } catch (e) {
          console.log(
            `Error parsing specified date format: ${value}`
          );
        }
      }))
    );
    this.containerEl.createEl("h2", { text: "Marking tasks" });
    this.containerEl.createEl("p", {
      text: "Marked tasks gain treatment based on the settings below. **Note that if a mark contains both in row 1 and row 2, then the mark would work as specified in row 1.**"
    });
    new import_obsidian2.Setting(this.containerEl).setName("Additional task statuses (row 1)").setDesc(
      "Specify the set of characters that indicate in-progress or incomplete tasks, e.g. 'i>!?D'. **All of them (excluding the first open status) can be assigned with hotkeys.**"
    ).addText(
      (text) => text.setPlaceholder(">!?").setValue(tempSettings.incompleteTaskValues).onChange((value) => __async(this, null, function* () {
        if (value.contains("x")) {
          console.log(
            `Set of characters should not contain the marker for completed tasks (x): ${value}`
          );
        } else if (!tempSettings.onlyLowercaseX && value.contains("X")) {
          console.log(
            `Set of characters should not contain the marker for completed tasks (X): ${value}`
          );
        } else if (tempSettings.supportCanceledTasks && value.contains("-")) {
          console.log(
            `Set of characters should not contain the marker for canceled tasks (-): ${value}`
          );
        } else {
          if (!value.contains(" ")) {
            value = " " + value;
          }
          tempSettings.incompleteTaskValues = value;
          this.taskMarker.updateSettings(tempSettings);
          yield this.plugin.saveSettings();
        }
      }))
    );
    new import_obsidian2.Setting(this.containerEl).setName("Append text to marked task (row 1)").setDesc(
      "Default empty. If set non-empty, append the string of moment.js format to the end of the task text."
    ).addMomentFormat(
      (momentFormat) => momentFormat.setPlaceholder("[\u274E ]YYYY-MM-DD").setValue(tempSettings.appendTextFormatMark).onChange((value) => __async(this, null, function* () {
        try {
          (0, import_obsidian2.moment)().format(value);
          tempSettings.appendTextFormatMark = value;
          this.taskMarker.updateSettings(tempSettings);
          yield this.plugin.saveSettings();
        } catch (e) {
          console.log(
            `Error parsing specified date format: ${value}`
          );
        }
      }))
    );
    new import_obsidian2.Setting(this.containerEl).setName("Additional task statuses (row 2)").setDesc(
      "Specify the set of characters that indicate task statuses, e.g. 'Rip'. **All of them can be assigned with hotkeys.**"
    ).addText(
      (text) => text.setPlaceholder("Rip").setValue(tempSettings.incompleteTaskValuesRow2).onChange((value) => __async(this, null, function* () {
        if (value.contains("x")) {
          console.log(
            `Set of characters should not contain the marker for completed tasks (x): ${value}`
          );
        } else if (!tempSettings.onlyLowercaseX && value.contains("X")) {
          console.log(
            `Set of characters should not contain the marker for completed tasks (X): ${value}`
          );
        } else if (tempSettings.supportCanceledTasks && value.contains("-")) {
          console.log(
            `Set of characters should not contain the marker for canceled tasks (-): ${value}`
          );
        } else {
          tempSettings.incompleteTaskValuesRow2 = value;
          this.taskMarker.updateSettings(tempSettings);
          yield this.plugin.saveSettings();
        }
      }))
    );
    new import_obsidian2.Setting(this.containerEl).setName("Append text to marked task (row 2)").setDesc(
      "Default empty. If set non-empty, append the string of moment.js format to the end of the task text."
    ).addMomentFormat(
      (momentFormat) => momentFormat.setPlaceholder("YYYY-MM-DD").setValue(tempSettings.appendTextFormatMarkRow2).onChange((value) => __async(this, null, function* () {
        try {
          (0, import_obsidian2.moment)().format(value);
          tempSettings.appendTextFormatMarkRow2 = value;
          this.taskMarker.updateSettings(tempSettings);
          yield this.plugin.saveSettings();
        } catch (e) {
          console.log(
            `Error parsing specified date format: ${value}`
          );
        }
      }))
    );
    this.containerEl.createEl("h2", { text: "Cycling tasks" });
    this.containerEl.createEl("p", {
      text: "Cycled tasks gain treatment based on the settings below."
    });
    new import_obsidian2.Setting(this.containerEl).setName("Cycled task statuses").setDesc(
      "Specify the set of characters that indicate any task statuses, e.g. 'x- Rip>'."
    ).addText(
      (text) => text.setPlaceholder("x- Rip").setValue(tempSettings.cycleTaskValues).onChange((value) => __async(this, null, function* () {
        tempSettings.cycleTaskValues = value;
        this.taskMarker.updateSettings(tempSettings);
        yield this.plugin.saveSettings();
      }))
    );
    this.containerEl.createEl("h2", { text: "Appending text" });
    this.containerEl.createEl("p", {
      text: "Appended text gains treatment based on the settings below."
    });
    new import_obsidian2.Setting(this.containerEl).setName("Append text to any line").setDesc(
      "Default empty. If set non-empty, append the string of moment.js format to the end of the line text."
    ).addMomentFormat(
      (momentFormat) => momentFormat.setPlaceholder("[\u{1F4DD} ]YYYY-MM-DD").setValue(tempSettings.appendTextFormatAppend).onChange((value) => __async(this, null, function* () {
        try {
          (0, import_obsidian2.moment)().format(value);
          tempSettings.appendTextFormatAppend = value;
          this.taskMarker.updateSettings(tempSettings);
          yield this.plugin.saveSettings();
        } catch (e) {
          console.log(
            `Error parsing specified date format: ${value}`
          );
        }
      }))
    );
    this.containerEl.createEl("h2", {
      text: "Marking tasks using menus"
    });
    this.containerEl.createEl("p", {
      text: "Task Marker creates commands that can be bound to hotkeys for completing, marking and resetting tasks in Editing view. The following settings add right click context menu items for those commands."
    });
    new import_obsidian2.Setting(this.containerEl).setName("Add menu item for creating a task").setDesc(
      "The menu item will create the task, on the current line (or within the current selection), in a way as specified in the section **Creating tasks**."
    ).addToggle(
      (toggle) => toggle.setValue(tempSettings.rightClickCreate).onChange((value) => __async(this, null, function* () {
        tempSettings.rightClickCreate = value;
        this.taskMarker.updateSettings(tempSettings);
        yield this.plugin.saveSettings();
      }))
    );
    new import_obsidian2.Setting(this.containerEl).setName("Add menu item for completing a task").setDesc(
      "The menu item will complete the task, on the current line (or within the current selection), in a way as specified in the section **Completing tasks**."
    ).addToggle(
      (toggle) => toggle.setValue(tempSettings.rightClickComplete).onChange((value) => __async(this, null, function* () {
        tempSettings.rightClickComplete = value;
        this.taskMarker.updateSettings(tempSettings);
        yield this.plugin.saveSettings();
      }))
    );
    new import_obsidian2.Setting(this.containerEl).setName("Add menu item for marking a task").setDesc(
      "The selected value will mark the task, on the current line (or within the current selection), in a way as specified in the section **Marking tasks**."
    ).addToggle(
      (toggle) => toggle.setValue(tempSettings.rightClickMark).onChange((value) => __async(this, null, function* () {
        tempSettings.rightClickMark = value;
        this.taskMarker.updateSettings(tempSettings);
        yield this.plugin.saveSettings();
      }))
    );
    new import_obsidian2.Setting(this.containerEl).setName("Add menu item for cycling a a task").setDesc(
      "The menu item will cycle the status of the task, on the current line (or within the current selection), in a way as specified in the section **Cycling tasks**."
    ).addToggle(
      (toggle) => toggle.setValue(tempSettings.rightClickCycle).onChange((value) => __async(this, null, function* () {
        tempSettings.rightClickCycle = value;
        this.taskMarker.updateSettings(tempSettings);
        yield this.plugin.saveSettings();
      }))
    );
    new import_obsidian2.Setting(this.containerEl).setName("Add menu item for resetting a task").setDesc(
      "The menu item will reset the task on the current line (or within the current selection)."
    ).addToggle(
      (toggle) => toggle.setValue(tempSettings.rightClickResetTask).onChange((value) => __async(this, null, function* () {
        tempSettings.rightClickResetTask = value;
        this.taskMarker.updateSettings(tempSettings);
        yield this.plugin.saveSettings();
      }))
    );
    new import_obsidian2.Setting(this.containerEl).setName("Add menu item for appending text to a line").setDesc(
      "The menu item will append text, on the current line (or within the current selection), in a way as specified in the section **Appending text**."
    ).addToggle(
      (toggle) => toggle.setValue(tempSettings.rightClickAppend).onChange((value) => __async(this, null, function* () {
        tempSettings.rightClickAppend = value;
        this.taskMarker.updateSettings(tempSettings);
        yield this.plugin.saveSettings();
      }))
    );
  }
};

// src/taskmarker-TaskMarkModal.ts
var import_obsidian3 = require("obsidian");
function promptForMark(app, taskMarker) {
  return new Promise((resolve) => {
    const modal = new TaskMarkModal(app, taskMarker);
    modal.onClose = () => {
      resolve(modal.chosenMark);
    };
    modal.open();
  });
}
var TaskMarkModal = class extends import_obsidian3.Modal {
  constructor(app, taskMarker) {
    super(app);
    this.taskMarker = taskMarker;
    this.containerEl.id = "taskmarker-modal";
  }
  onOpen() {
    const selector = this.contentEl.createDiv(
      "taskmarker-selector markdown-preview-view"
    );
    const completedList = selector.createEl("ul");
    completedList.addClass("contains-task-list");
    this.addTaskValues(
      completedList,
      this.taskMarker.initSettings.completedTasks,
      true
    );
    const list = selector.createEl("ul");
    list.addClass("contains-task-list");
    this.addTaskValues(
      list,
      this.taskMarker.settings.incompleteTaskValues,
      false
    );
    const listRow2 = selector.createEl("ul");
    listRow2.addClass("contains-task-list");
    this.addTaskValues(
      listRow2,
      this.taskMarker.settings.incompleteTaskValuesRow2,
      false
    );
    const footer = selector.createEl("nav");
    const esc = footer.createSpan();
    esc.innerHTML = "<b>esc</b> to dismiss";
    const bksp = footer.createSpan();
    bksp.innerHTML = "<b>bksp</b> to remove <code>[]</code>";
    const self = this;
    const keyListener = function(event) {
      self.chosenMark = event.key;
      event.preventDefault();
      event.stopImmediatePropagation();
      self.close();
    };
    this.scope.register([], null, keyListener);
    this.scope.register(["Shift"], null, keyListener);
  }
  addTaskValues(list, choices, markComplete) {
    const self = this;
    for (const character of choices) {
      const li = list.createEl("li", {
        cls: "task-list-item " + (character == " " ? "" : " is-checked"),
        attr: {
          "data-task": character
        }
      });
      li.addEventListener("click", function(event) {
        self.chosenMark = character;
        self.close();
      });
      const input = li.createEl("input", {
        cls: "task-list-item-checkbox",
        attr: {
          id: "task-list-item-checkbox-" + character,
          type: "checkbox",
          style: "pointer-events: none;"
        }
      });
      if (character != " ") {
        input.setAttribute("checked", "");
      }
      li.createEl("span", {
        text: character == " " ? "\u2423" : character,
        attr: {
          style: "pointer-events: none;"
        }
      });
    }
  }
  onClose() {
    this.contentEl.empty();
  }
};

// src/taskmarker-Api.ts
var TaskMarkerApi = class {
  constructor(app, taskMarker) {
    this.app = app;
    this.taskMarker = taskMarker;
  }
  getCompletedTaskValues() {
    return this.taskMarker.initSettings.completedTasks;
  }
  getIncompleteTaskValues() {
    return this.taskMarker.settings.incompleteTaskValues;
  }
  getMark() {
    return promptForMark(this.app, this.taskMarker);
  }
  isComplete(value) {
    return this.getCompletedTaskValues().contains(value);
  }
  isCanceled(value) {
    return value === "-";
  }
};

// src/taskmarker-Plugin.ts
var TaskMarkerPlugin = class extends import_obsidian4.Plugin {
  constructor() {
    super(...arguments);
    this.handlersRegistered = false;
  }
  onload() {
    return __async(this, null, function* () {
      console.log("loading Task Marker (TM)");
      this.taskMarker = new TaskMarker(this.app);
      this.addSettingTab(
        new TaskMarkerSettingsTab(this.app, this, this.taskMarker)
      );
      yield this.loadSettings();
      (0, import_obsidian4.addIcon)(
        "tm-complete-task" /* COMPLETE */,
        '<svg xmlns="http://www.w3.org/2000/svg" width="100px" height="100px" fill="currentColor" class="bi bi-check-square-fill" viewBox="0 0 14 14">  <path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm10.03 4.97a.75.75 0 0 1 .011 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.75.75 0 0 1 1.08-.022z"/></svg>'
      );
      (0, import_obsidian4.addIcon)(
        "tm-cancel-task" /* CANCEL */,
        '<svg xmlns="http://www.w3.org/2000/svg" width="100px" height="100px" fill="currentColor" class="bi bi-dash-square-fill" viewBox="0 0 14 14">  <path d="M2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2zm2.5 7.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1 0-1z"/></svg>'
      );
      (0, import_obsidian4.addIcon)(
        "tm-reset-task" /* RESET */,
        '<svg xmlns="http://www.w3.org/2000/svg" width="100px" height="100px" fill="currentColor" class="bi bi-square-fill" viewBox="0 0 14 14"><path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2z"/></svg>'
      );
      (0, import_obsidian4.addIcon)(
        "tm-mark-task" /* MARK */,
        '<svg class="bi bi-square-fill" width="100px" height="100px" fill="currentColor" version="1.1" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><path transform="scale(.16)" d="m12.5 0a12.5 12.5 0 00-12.5 12.5v75a12.5 12.5 0 0012.5 12.5h75a12.5 12.5 0 0012.5-12.5v-75a12.5 12.5 0 00-12.5-12.5h-75zm38.146 21.135 8.7324 19.098 20.684 3.6328-15.465 14.207 2.9355 20.793-18.289-10.316-18.869 9.2188 4.1602-20.584-14.598-15.098 20.861-2.4043 9.8477-18.547z" stroke-width="6.25"/></svg>'
      );
      (0, import_obsidian4.addIcon)(
        "tm-complete-all-tasks" /* COMPLETE_ALL */,
        '<svg class="bi bi-square-fill" fill="currentColor" version="1.1" width="100px" height="100px" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><path d="m2 0a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2v-12a2 2 0 00-2-2h-12zm1.5098 2.041h1.5a1.5 1.5 0 011.5 1.5v1.5a1.5 1.5 0 01-1.5 1.5h-1.5a1.5 1.5 0 01-1.5-1.5v-1.5a1.5 1.5 0 011.5-1.5zm4.3945 1.2207h5.6895a.40645.5 0 01.40625.5v1a.40645.5 0 01-.40625.5h-5.6895a.40645.5 0 01-.40625-.5v-1a.40645.5 0 01.40625-.5zm-4.4023 6.2656h1.5a1.5 1.5 0 011.5 1.5v1.5a1.5 1.5 0 01-1.5 1.5h-1.5a1.5 1.5 0 01-1.5-1.5v-1.5a1.5 1.5 0 011.5-1.5zm4.4023 1.2656h5.6895a.40645.5 0 01.40625.5v1a.40645.5 0 01-.40625.5h-5.6895a.40645.5 0 01-.40625-.5v-1a.40645.5 0 01.40625-.5z"/><g transform="translate(.49737 -.0026315)" fill="currentColor"><path d="m3.6171 13.149a.5.5 0 01-.708 0l-1-1a.50063.50063 0 01.708-.708l.646.647 1.646-1.647a.50063.50063 0 01.708.708z"/><path d="m3.6171 5.6181a.5.5 0 01-.708 0l-1-1a.50063.50063 0 11.708-.708l.646.647 1.646-1.647a.50063.50063 0 11.708.708z"/></g></svg>'
      );
      (0, import_obsidian4.addIcon)(
        "tm-clear-all-tasks" /* CLEAR */,
        '<svg class="bi bi-square-fill" fill="currentColor" version="1.1" width="100px" height="100px" viewBox="0 0 14 14" xmlns="http://www.w3.org/2000/svg"><path d="m2 0a2 2 0 00-2 2v12a2 2 0 002 2h12a2 2 0 002-2v-12a2 2 0 00-2-2h-12zm1.5098 2.041h1.5a1.5 1.5 0 011.5 1.5v1.5a1.5 1.5 0 01-1.5 1.5h-1.5a1.5 1.5 0 01-1.5-1.5v-1.5a1.5 1.5 0 011.5-1.5zm4.3945 1.2207h5.6895a.40645.5 0 01.40625.5v1a.40645.5 0 01-.40625.5h-5.6895a.40645.5 0 01-.40625-.5v-1a.40645.5 0 01.40625-.5zm-4.4023 6.2656h1.5a1.5 1.5 0 011.5 1.5v1.5a1.5 1.5 0 01-1.5 1.5h-1.5a1.5 1.5 0 01-1.5-1.5v-1.5a1.5 1.5 0 011.5-1.5zm4.4023 1.2656h5.6895a.40645.5 0 01.40625.5v1a.40645.5 0 01-.40625.5h-5.6895a.40645.5 0 01-.40625-.5v-1a.40645.5 0 01.40625-.5z"/></svg>'
      );
      this.addCommand({
        id: "task-marker-create",
        name: "Create task",
        icon: "tm-reset-task" /* RESET */,
        editorCallback: (editor, view) => {
          this.markTaskOnLinesCreate(
            " ",
            this.getCurrentLinesFromEditor(editor)
          );
        }
      });
      this.addCommand({
        id: "task-marker-complete",
        name: "Complete task",
        icon: "tm-complete-task" /* COMPLETE */,
        editorCallback: (editor, view) => {
          this.markTaskOnLines(
            "x",
            this.getCurrentLinesFromEditor(editor)
          );
        }
      });
      this.addCommand({
        id: "task-marker-cancel",
        name: "Cancel task",
        icon: "tm-cancel-task" /* CANCEL */,
        editorCheckCallback: (checking, editor, view) => {
          const value = this.taskMarker.settings.supportCanceledTasks;
          if (value) {
            if (!checking) {
              this.markTaskOnLines(
                "-",
                this.getCurrentLinesFromEditor(editor)
              );
            }
            return true;
          }
          return false;
        }
      });
      this.addCommand({
        id: "task-marker-mark",
        name: "Mark task",
        icon: "tm-mark-task" /* MARK */,
        editorCallback: (editor, view) => __async(this, null, function* () {
          const mark = yield promptForMark(this.app, this.taskMarker);
          if (mark) {
            this.markTaskOnLines(
              mark,
              this.getCurrentLinesFromEditor(editor)
            );
          }
        })
      });
      this.addCommand({
        id: "task-marker-reset",
        name: "Reset task",
        icon: "tm-reset-task" /* RESET */,
        editorCallback: (editor, view) => {
          this.markTaskOnLines(
            " ",
            this.getCurrentLinesFromEditor(editor)
          );
        }
      });
      this.addCommand({
        id: "task-marker-complete-all",
        name: "Complete all tasks",
        icon: "tm-complete-all-tasks" /* COMPLETE_ALL */,
        callback: () => __async(this, null, function* () {
          this.completeAllTasks();
        })
      });
      this.addCommand({
        id: "task-marker-reset-all",
        name: "Reset all completed tasks",
        icon: "tm-clear-all-tasks" /* CLEAR */,
        callback: () => __async(this, null, function* () {
          this.resetAllTasks();
        })
      });
      const incompleteTaskValuesLength = this.taskMarker.settings.incompleteTaskValues.length;
      if (incompleteTaskValuesLength >= 2) {
        for (let i = 1; i <= incompleteTaskValuesLength - 1; i++) {
          this.addCommand({
            id: "task-marker-mark-task-status-row1-" + i.toString(),
            name: "Mark task (row 1) as status " + i.toString() + ' "' + this.taskMarker.settings.incompleteTaskValues[i] + '"',
            icon: "tm-mark-task" /* MARK */,
            editorCallback: (editor, view) => {
              this.markTaskOnLines(
                this.taskMarker.settings.incompleteTaskValues[i],
                this.getCurrentLinesFromEditor(editor)
              );
            }
          });
        }
      }
      const incompleteTaskValuesRow2Length = this.taskMarker.settings.incompleteTaskValuesRow2.length;
      if (incompleteTaskValuesRow2Length >= 1) {
        for (let i = 0; i <= incompleteTaskValuesRow2Length - 1; i++) {
          this.addCommand({
            id: "task-marker-mark-task-status-row2-" + (i + 1).toString(),
            name: "Mark task (row 2) as status " + (i + 1).toString() + ' "' + this.taskMarker.settings.incompleteTaskValuesRow2[i] + '"',
            icon: "tm-mark-task" /* MARK */,
            editorCallback: (editor, view) => {
              this.markTaskOnLines(
                this.taskMarker.settings.incompleteTaskValuesRow2[i],
                this.getCurrentLinesFromEditor(editor)
              );
            }
          });
        }
      }
      this.addCommand({
        id: "task-marker-cycle-task-status",
        name: "Cycle task status",
        icon: "tm-mark-task" /* MARK */,
        editorCallback: (editor, view) => {
          this.markTaskOnLinesCycle(
            "y",
            this.getCurrentLinesFromEditor(editor)
          );
        }
      });
      this.addCommand({
        id: "task-marker-append-text",
        name: "Append text",
        editorCallback: (editor, view) => {
          this.appendTextOnLines(
            "y",
            this.getCurrentLinesFromEditor(editor)
          );
        }
      });
      this.registerHandlers();
      this.api = new TaskMarkerApi(this.app, this.taskMarker);
    });
  }
  getCurrentLinesFromEditor(editor) {
    const lines = [];
    if (editor.somethingSelected()) {
      const cursorStart = editor.getCursor("from");
      const cursorEnd = editor.getCursor("to");
      for (let i = cursorStart.line; i <= cursorEnd.line; i++) {
        lines.push(i);
      }
    } else {
      const anchor = editor.getCursor("from");
      lines.push(anchor.line);
    }
    return lines;
  }
  buildMenu(menu, lines) {
    if (this.taskMarker.settings.rightClickCreate) {
      menu.addItem(
        (item) => item.setTitle("(TM) Create task").setIcon("tm-reset-task" /* RESET */).onClick(() => {
          this.markTaskOnLinesCreate(" ", lines);
        })
      );
    }
    if (this.taskMarker.settings.rightClickComplete) {
      menu.addItem(
        (item) => item.setTitle("(TM) Complete task").setIcon("tm-complete-task" /* COMPLETE */).onClick(() => {
          this.markTaskOnLines("x", lines);
        })
      );
      if (this.taskMarker.settings.supportCanceledTasks) {
        menu.addItem(
          (item) => item.setTitle("(TM) Cancel task").setIcon("tm-cancel-task" /* CANCEL */).onClick(() => {
            this.markTaskOnLines("-", lines);
          })
        );
      }
    }
    if (this.taskMarker.settings.rightClickMark) {
      menu.addItem(
        (item) => item.setTitle("(TM) Mark task").setIcon("tm-mark-task" /* MARK */).onClick(() => __async(this, null, function* () {
          const mark = yield promptForMark(
            this.app,
            this.taskMarker
          );
          if (mark) {
            this.markTaskOnLines(mark, lines);
          }
        }))
      );
    }
    if (this.taskMarker.settings.rightClickCycle) {
      menu.addItem(
        (item) => item.setTitle("(TM) Cycle task status").setIcon("tm-complete-task" /* COMPLETE */).onClick(() => {
          this.markTaskOnLinesCycle("y", lines);
        })
      );
    }
    if (this.taskMarker.settings.rightClickResetTask) {
      menu.addItem(
        (item) => item.setTitle("(TM) Reset task").setIcon("tm-reset-task" /* RESET */).onClick(() => {
          this.markTaskOnLines(" ", lines);
        })
      );
    }
    if (this.taskMarker.settings.rightClickAppend) {
      menu.addItem(
        (item) => item.setTitle("(TM) Append text").onClick(() => {
          this.appendTextOnLines("y", lines);
        })
      );
    }
    if (this.taskMarker.settings.rightClickToggleAll) {
      menu.addItem(
        (item) => item.setTitle("(TM) Complete all tasks").setIcon("tm-complete-all-tasks" /* COMPLETE_ALL */).onClick(() => __async(this, null, function* () {
          this.completeAllTasks();
        }))
      );
    }
    if (this.taskMarker.settings.rightClickResetAll) {
      menu.addItem(
        (item) => item.setTitle("(TM) Reset all tasks").setIcon("tm-clear-all-tasks" /* CLEAR */).onClick(() => __async(this, null, function* () {
          this.resetAllTasks();
        }))
      );
    }
  }
  markTaskOnLines(mark, lines) {
    return __async(this, null, function* () {
      const activeFile = this.app.workspace.getActiveFile();
      const source = yield this.app.vault.read(activeFile);
      const result = this.taskMarker.markTaskInSource(source, mark, lines);
      this.app.vault.modify(activeFile, result);
    });
  }
  markTaskOnLinesCycle(mark, lines) {
    return __async(this, null, function* () {
      const activeFile = this.app.workspace.getActiveFile();
      const source = yield this.app.vault.read(activeFile);
      const result = this.taskMarker.markTaskInSourceCycle(source, mark, lines);
      this.app.vault.modify(activeFile, result);
    });
  }
  markTaskOnLinesCreate(mark, lines) {
    return __async(this, null, function* () {
      const activeFile = this.app.workspace.getActiveFile();
      const source = yield this.app.vault.read(activeFile);
      const result = this.taskMarker.markTaskInSourceCreate(source, mark, lines);
      this.app.vault.modify(activeFile, result);
    });
  }
  appendTextOnLines(mark, lines) {
    return __async(this, null, function* () {
      const activeFile = this.app.workspace.getActiveFile();
      const source = yield this.app.vault.read(activeFile);
      const result = this.taskMarker.appendTextInSource(source, mark, lines);
      this.app.vault.modify(activeFile, result);
    });
  }
  completeAllTasks() {
    return __async(this, null, function* () {
      const activeFile = this.app.workspace.getActiveFile();
      const source = yield this.app.vault.read(activeFile);
      const result = this.taskMarker.markAllTasksComplete(source, "x");
      this.app.vault.modify(activeFile, result);
    });
  }
  resetAllTasks() {
    return __async(this, null, function* () {
      const activeFile = this.app.workspace.getActiveFile();
      const source = yield this.app.vault.read(activeFile);
      const result = this.taskMarker.resetAllTasks(source);
      this.app.vault.modify(activeFile, result);
    });
  }
  registerHandlers() {
    if (this.taskMarker.initSettings.registerHandlers && !this.handlersRegistered) {
      this.handlersRegistered = true;
      if (this.taskMarker.initSettings.rightClickTaskMenu) {
        this.registerEvent(
          this.eventRef = this.app.workspace.on(
            "editor-menu",
            (menu, editor) => {
              this.buildMenu(
                menu,
                this.getCurrentLinesFromEditor(editor)
              );
            }
          )
        );
      }
      this.registerMarkdownPostProcessor(
        this.postProcessor = (el, ctx) => {
          const checkboxes = el.querySelectorAll(
            ".task-list-item-checkbox"
          );
          if (!checkboxes.length)
            return;
          const section = ctx.getSectionInfo(el);
          if (!section)
            return;
          const { lineStart } = section;
          for (const checkbox of Array.from(checkboxes)) {
            const line = Number(checkbox.dataset.line);
            if (this.taskMarker.initSettings.rightClickTaskMenu) {
              this.registerDomEvent(
                checkbox.parentElement,
                "contextmenu",
                (ev) => {
                  ev.preventDefault();
                  const view = this.app.workspace.getActiveViewOfType(
                    import_obsidian4.MarkdownView
                  );
                  if (view && view.editor) {
                    const menu = new import_obsidian4.Menu(this.app);
                    this.buildMenu(menu, [
                      lineStart + line
                    ]);
                    menu.showAtMouseEvent(ev);
                  }
                }
              );
            }
            if (this.taskMarker.settings.previewOnClick) {
              this.registerDomEvent(
                checkbox,
                "click",
                (ev) => __async(this, null, function* () {
                  ev.stopImmediatePropagation();
                  ev.preventDefault();
                  const mark = yield promptForMark(
                    this.app,
                    this.taskMarker
                  );
                  if (mark) {
                    this.markTaskOnLines(mark, [
                      lineStart + line
                    ]);
                  }
                })
              );
            }
          }
        }
      );
    }
  }
  unregisterHandlers() {
    this.handlersRegistered = false;
    if (this.eventRef) {
      this.app.workspace.offref(this.eventRef);
      this.eventRef = null;
    }
    if (this.postProcessor) {
      import_obsidian4.MarkdownPreviewRenderer.unregisterPostProcessor(this.postProcessor);
      this.postProcessor = null;
    }
  }
  onunload() {
    console.log("unloading Task Marker (TM)");
  }
  loadSettings() {
    return __async(this, null, function* () {
      const settings = Object.assign(
        {},
        DEFAULT_SETTINGS,
        yield this.loadData()
      );
      if (settings.rightClickReset) {
        delete settings.rightClickReset;
        yield this.saveData(settings);
      }
      this.taskMarker.updateSettings(settings);
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      yield this.saveData(this.taskMarker.settings);
      if (this.taskMarker.initSettings.rightClickTaskMenu && !this.handlersRegistered) {
        this.registerHandlers();
      }
      if (!this.taskMarker.initSettings.rightClickTaskMenu && this.handlersRegistered) {
        this.unregisterHandlers();
      }
    });
  }
};

// src/main.ts
var main_default = TaskMarkerPlugin;
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vc3JjL21haW4udHMiLCAiLi4vc3JjL3Rhc2ttYXJrZXItUGx1Z2luLnRzIiwgIi4uL3NyYy90YXNrbWFya2VyLVRhc2tNYXJrZXIudHMiLCAiLi4vc3JjL3Rhc2ttYXJrZXItU2V0dGluZ3MudHMiLCAiLi4vc3JjL3Rhc2ttYXJrZXItU2V0dGluZ3NUYWIudHMiLCAiLi4vc3JjL3Rhc2ttYXJrZXItVGFza01hcmtNb2RhbC50cyIsICIuLi9zcmMvdGFza21hcmtlci1BcGkudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IFRhc2tNYXJrZXJQbHVnaW4gfSBmcm9tIFwiLi90YXNrbWFya2VyLVBsdWdpblwiO1xuXG5leHBvcnQgZGVmYXVsdCBUYXNrTWFya2VyUGx1Z2luO1xuIiwgImltcG9ydCB7XG4gICAgYWRkSWNvbixcbiAgICBFZGl0b3IsXG4gICAgTWFya2Rvd25WaWV3LFxuICAgIFBsdWdpbixcbiAgICBDb21tYW5kLFxuICAgIE1lbnUsXG4gICAgRXZlbnRSZWYsXG4gICAgTWFya2Rvd25Qb3N0UHJvY2Vzc29yLFxuICAgIE1hcmtkb3duUHJldmlld1JlbmRlcmVyLFxufSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IFRhc2tNYXJrZXIgfSBmcm9tIFwiLi90YXNrbWFya2VyLVRhc2tNYXJrZXJcIjtcbmltcG9ydCB7IERFRkFVTFRfU0VUVElOR1MgfSBmcm9tIFwiLi90YXNrbWFya2VyLVNldHRpbmdzXCI7XG5pbXBvcnQgeyBUYXNrTWFya2VyU2V0dGluZ3NUYWIgfSBmcm9tIFwiLi90YXNrbWFya2VyLVNldHRpbmdzVGFiXCI7XG5pbXBvcnQgeyBwcm9tcHRGb3JNYXJrIH0gZnJvbSBcIi4vdGFza21hcmtlci1UYXNrTWFya01vZGFsXCI7XG5pbXBvcnQgeyBBUEkgfSBmcm9tIFwiLi9AdHlwZXMvYXBpXCI7XG5pbXBvcnQgeyBUYXNrTWFya2VyQXBpIH0gZnJvbSBcIi4vdGFza21hcmtlci1BcGlcIjtcblxuZW51bSBJY29ucyB7XG4gICAgQ09NUExFVEUgPSBcInRtLWNvbXBsZXRlLXRhc2tcIixcbiAgICBDQU5DRUwgPSBcInRtLWNhbmNlbC10YXNrXCIsXG4gICAgUkVTRVQgPSBcInRtLXJlc2V0LXRhc2tcIixcbiAgICBNQVJLID0gXCJ0bS1tYXJrLXRhc2tcIixcbiAgICBDT01QTEVURV9BTEwgPSBcInRtLWNvbXBsZXRlLWFsbC10YXNrc1wiLFxuICAgIENMRUFSID0gXCJ0bS1jbGVhci1hbGwtdGFza3NcIixcbiAgICBNT1ZFID0gXCJ0bS1tb3ZlLWFsbC1jaGVja2VkLXRhc2tzXCIsXG59XG5cbmV4cG9ydCBjbGFzcyBUYXNrTWFya2VyUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcbiAgICB0YXNrTWFya2VyOiBUYXNrTWFya2VyO1xuXG4gICAgLyoqIEV4dGVybmFsLWZhY2luZyBwbHVnaW4gQVBJLiAqL1xuICAgIHB1YmxpYyBhcGk6IEFQSTtcblxuICAgIGFzeW5jIG9ubG9hZCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc29sZS5sb2coXCJsb2FkaW5nIFRhc2sgTWFya2VyIChUTSlcIik7XG4gICAgICAgIHRoaXMudGFza01hcmtlciA9IG5ldyBUYXNrTWFya2VyKHRoaXMuYXBwKTtcbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKFxuICAgICAgICAgICAgbmV3IFRhc2tNYXJrZXJTZXR0aW5nc1RhYih0aGlzLmFwcCwgdGhpcywgdGhpcy50YXNrTWFya2VyKVxuICAgICAgICApO1xuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXG4gICAgICAgIGFkZEljb24oXG4gICAgICAgICAgICBJY29ucy5DT01QTEVURSxcbiAgICAgICAgICAgICc8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjEwMHB4XCIgaGVpZ2h0PVwiMTAwcHhcIiBmaWxsPVwiY3VycmVudENvbG9yXCIgY2xhc3M9XCJiaSBiaS1jaGVjay1zcXVhcmUtZmlsbFwiIHZpZXdCb3g9XCIwIDAgMTQgMTRcIj4gIDxwYXRoIGQ9XCJNMiAwYTIgMiAwIDAgMC0yIDJ2MTJhMiAyIDAgMCAwIDIgMmgxMmEyIDIgMCAwIDAgMi0yVjJhMiAyIDAgMCAwLTItMkgyem0xMC4wMyA0Ljk3YS43NS43NSAwIDAgMSAuMDExIDEuMDVsLTMuOTkyIDQuOTlhLjc1Ljc1IDAgMCAxLTEuMDguMDJMNC4zMjQgOC4zODRhLjc1Ljc1IDAgMSAxIDEuMDYtMS4wNmwyLjA5NCAyLjA5MyAzLjQ3My00LjQyNWEuNzUuNzUgMCAwIDEgMS4wOC0uMDIyelwiLz48L3N2Zz4nXG4gICAgICAgICk7XG4gICAgICAgIGFkZEljb24oXG4gICAgICAgICAgICBJY29ucy5DQU5DRUwsXG4gICAgICAgICAgICAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCIxMDBweFwiIGhlaWdodD1cIjEwMHB4XCIgZmlsbD1cImN1cnJlbnRDb2xvclwiIGNsYXNzPVwiYmkgYmktZGFzaC1zcXVhcmUtZmlsbFwiIHZpZXdCb3g9XCIwIDAgMTQgMTRcIj4gIDxwYXRoIGQ9XCJNMiAwYTIgMiAwIDAgMC0yIDJ2MTJhMiAyIDAgMCAwIDIgMmgxMmEyIDIgMCAwIDAgMi0yVjJhMiAyIDAgMCAwLTItMkgyem0yLjUgNy41aDdhLjUuNSAwIDAgMSAwIDFoLTdhLjUuNSAwIDAgMSAwLTF6XCIvPjwvc3ZnPidcbiAgICAgICAgKTtcbiAgICAgICAgYWRkSWNvbihcbiAgICAgICAgICAgIEljb25zLlJFU0VULFxuICAgICAgICAgICAgJzxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMTAwcHhcIiBoZWlnaHQ9XCIxMDBweFwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIiBjbGFzcz1cImJpIGJpLXNxdWFyZS1maWxsXCIgdmlld0JveD1cIjAgMCAxNCAxNFwiPjxwYXRoIGQ9XCJNMCAyYTIgMiAwIDAgMSAyLTJoMTJhMiAyIDAgMCAxIDIgMnYxMmEyIDIgMCAwIDEtMiAySDJhMiAyIDAgMCAxLTItMlYyelwiLz48L3N2Zz4nXG4gICAgICAgICk7XG4gICAgICAgIGFkZEljb24oXG4gICAgICAgICAgICBJY29ucy5NQVJLLFxuICAgICAgICAgICAgJzxzdmcgY2xhc3M9XCJiaSBiaS1zcXVhcmUtZmlsbFwiIHdpZHRoPVwiMTAwcHhcIiBoZWlnaHQ9XCIxMDBweFwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIiB2ZXJzaW9uPVwiMS4xXCIgdmlld0JveD1cIjAgMCAxNCAxNFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48cGF0aCB0cmFuc2Zvcm09XCJzY2FsZSguMTYpXCIgZD1cIm0xMi41IDBhMTIuNSAxMi41IDAgMDAtMTIuNSAxMi41djc1YTEyLjUgMTIuNSAwIDAwMTIuNSAxMi41aDc1YTEyLjUgMTIuNSAwIDAwMTIuNS0xMi41di03NWExMi41IDEyLjUgMCAwMC0xMi41LTEyLjVoLTc1em0zOC4xNDYgMjEuMTM1IDguNzMyNCAxOS4wOTggMjAuNjg0IDMuNjMyOC0xNS40NjUgMTQuMjA3IDIuOTM1NSAyMC43OTMtMTguMjg5LTEwLjMxNi0xOC44NjkgOS4yMTg4IDQuMTYwMi0yMC41ODQtMTQuNTk4LTE1LjA5OCAyMC44NjEtMi40MDQzIDkuODQ3Ny0xOC41NDd6XCIgc3Ryb2tlLXdpZHRoPVwiNi4yNVwiLz48L3N2Zz4nXG4gICAgICAgICk7XG4gICAgICAgIGFkZEljb24oXG4gICAgICAgICAgICBJY29ucy5DT01QTEVURV9BTEwsXG4gICAgICAgICAgICAnPHN2ZyBjbGFzcz1cImJpIGJpLXNxdWFyZS1maWxsXCIgZmlsbD1cImN1cnJlbnRDb2xvclwiIHZlcnNpb249XCIxLjFcIiB3aWR0aD1cIjEwMHB4XCIgaGVpZ2h0PVwiMTAwcHhcIiB2aWV3Qm94PVwiMCAwIDE0IDE0XCIgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiPjxwYXRoIGQ9XCJtMiAwYTIgMiAwIDAwLTIgMnYxMmEyIDIgMCAwMDIgMmgxMmEyIDIgMCAwMDItMnYtMTJhMiAyIDAgMDAtMi0yaC0xMnptMS41MDk4IDIuMDQxaDEuNWExLjUgMS41IDAgMDExLjUgMS41djEuNWExLjUgMS41IDAgMDEtMS41IDEuNWgtMS41YTEuNSAxLjUgMCAwMS0xLjUtMS41di0xLjVhMS41IDEuNSAwIDAxMS41LTEuNXptNC4zOTQ1IDEuMjIwN2g1LjY4OTVhLjQwNjQ1LjUgMCAwMS40MDYyNS41djFhLjQwNjQ1LjUgMCAwMS0uNDA2MjUuNWgtNS42ODk1YS40MDY0NS41IDAgMDEtLjQwNjI1LS41di0xYS40MDY0NS41IDAgMDEuNDA2MjUtLjV6bS00LjQwMjMgNi4yNjU2aDEuNWExLjUgMS41IDAgMDExLjUgMS41djEuNWExLjUgMS41IDAgMDEtMS41IDEuNWgtMS41YTEuNSAxLjUgMCAwMS0xLjUtMS41di0xLjVhMS41IDEuNSAwIDAxMS41LTEuNXptNC40MDIzIDEuMjY1Nmg1LjY4OTVhLjQwNjQ1LjUgMCAwMS40MDYyNS41djFhLjQwNjQ1LjUgMCAwMS0uNDA2MjUuNWgtNS42ODk1YS40MDY0NS41IDAgMDEtLjQwNjI1LS41di0xYS40MDY0NS41IDAgMDEuNDA2MjUtLjV6XCIvPjxnIHRyYW5zZm9ybT1cInRyYW5zbGF0ZSguNDk3MzcgLS4wMDI2MzE1KVwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIj48cGF0aCBkPVwibTMuNjE3MSAxMy4xNDlhLjUuNSAwIDAxLS43MDggMGwtMS0xYS41MDA2My41MDA2MyAwIDAxLjcwOC0uNzA4bC42NDYuNjQ3IDEuNjQ2LTEuNjQ3YS41MDA2My41MDA2MyAwIDAxLjcwOC43MDh6XCIvPjxwYXRoIGQ9XCJtMy42MTcxIDUuNjE4MWEuNS41IDAgMDEtLjcwOCAwbC0xLTFhLjUwMDYzLjUwMDYzIDAgMTEuNzA4LS43MDhsLjY0Ni42NDcgMS42NDYtMS42NDdhLjUwMDYzLjUwMDYzIDAgMTEuNzA4LjcwOHpcIi8+PC9nPjwvc3ZnPidcbiAgICAgICAgKTtcbiAgICAgICAgYWRkSWNvbihcbiAgICAgICAgICAgIEljb25zLkNMRUFSLFxuICAgICAgICAgICAgJzxzdmcgY2xhc3M9XCJiaSBiaS1zcXVhcmUtZmlsbFwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIiB2ZXJzaW9uPVwiMS4xXCIgd2lkdGg9XCIxMDBweFwiIGhlaWdodD1cIjEwMHB4XCIgdmlld0JveD1cIjAgMCAxNCAxNFwiIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIj48cGF0aCBkPVwibTIgMGEyIDIgMCAwMC0yIDJ2MTJhMiAyIDAgMDAyIDJoMTJhMiAyIDAgMDAyLTJ2LTEyYTIgMiAwIDAwLTItMmgtMTJ6bTEuNTA5OCAyLjA0MWgxLjVhMS41IDEuNSAwIDAxMS41IDEuNXYxLjVhMS41IDEuNSAwIDAxLTEuNSAxLjVoLTEuNWExLjUgMS41IDAgMDEtMS41LTEuNXYtMS41YTEuNSAxLjUgMCAwMTEuNS0xLjV6bTQuMzk0NSAxLjIyMDdoNS42ODk1YS40MDY0NS41IDAgMDEuNDA2MjUuNXYxYS40MDY0NS41IDAgMDEtLjQwNjI1LjVoLTUuNjg5NWEuNDA2NDUuNSAwIDAxLS40MDYyNS0uNXYtMWEuNDA2NDUuNSAwIDAxLjQwNjI1LS41em0tNC40MDIzIDYuMjY1NmgxLjVhMS41IDEuNSAwIDAxMS41IDEuNXYxLjVhMS41IDEuNSAwIDAxLTEuNSAxLjVoLTEuNWExLjUgMS41IDAgMDEtMS41LTEuNXYtMS41YTEuNSAxLjUgMCAwMTEuNS0xLjV6bTQuNDAyMyAxLjI2NTZoNS42ODk1YS40MDY0NS41IDAgMDEuNDA2MjUuNXYxYS40MDY0NS41IDAgMDEtLjQwNjI1LjVoLTUuNjg5NWEuNDA2NDUuNSAwIDAxLS40MDYyNS0uNXYtMWEuNDA2NDUuNSAwIDAxLjQwNjI1LS41elwiLz48L3N2Zz4nXG4gICAgICAgICk7XG4gICAgICAgIC8vIGFkZEljb24oXG4gICAgICAgIC8vICAgICBJY29ucy5NT1ZFLFxuICAgICAgICAvLyAgICAgJzxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMTAwcHhcIiBoZWlnaHQ9XCIxMDBweFwiIGZpbGw9XCJjdXJyZW50Q29sb3JcIiBjbGFzcz1cImJpIGJpLXNhdmUtZmlsbFwiIHZpZXdCb3g9XCIwIDAgMTQgMTRcIj4gIDxwYXRoIGQ9XCJNOC41IDEuNUExLjUgMS41IDAgMCAxIDEwIDBoNGEyIDIgMCAwIDEgMiAydjEyYTIgMiAwIDAgMS0yIDJIMmEyIDIgMCAwIDEtMi0yVjJhMiAyIDAgMCAxIDItMmg2Yy0uMzE0LjQxOC0uNS45MzctLjUgMS41djcuNzkzTDQuODU0IDYuNjQ2YS41LjUgMCAxIDAtLjcwOC43MDhsMy41IDMuNWEuNS41IDAgMCAwIC43MDggMGwzLjUtMy41YS41LjUgMCAwIDAtLjcwOC0uNzA4TDguNSA5LjI5M1YxLjV6XCIvPjwvc3ZnPidcbiAgICAgICAgLy8gKTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6IFwidGFzay1tYXJrZXItY3JlYXRlXCIsXG4gICAgICAgICAgICBuYW1lOiBcIkNyZWF0ZSB0YXNrXCIsXG4gICAgICAgICAgICBpY29uOiBJY29ucy5SRVNFVCxcbiAgICAgICAgICAgIGVkaXRvckNhbGxiYWNrOiAoZWRpdG9yOiBFZGl0b3IsIHZpZXc6IE1hcmtkb3duVmlldykgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMubWFya1Rhc2tPbkxpbmVzQ3JlYXRlKFxuICAgICAgICAgICAgICAgICAgICBcIiBcIixcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRDdXJyZW50TGluZXNGcm9tRWRpdG9yKGVkaXRvcilcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiBcInRhc2stbWFya2VyLWNvbXBsZXRlXCIsXG4gICAgICAgICAgICBuYW1lOiBcIkNvbXBsZXRlIHRhc2tcIixcbiAgICAgICAgICAgIGljb246IEljb25zLkNPTVBMRVRFLFxuICAgICAgICAgICAgZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvciwgdmlldzogTWFya2Rvd25WaWV3KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXJrVGFza09uTGluZXMoXG4gICAgICAgICAgICAgICAgICAgIFwieFwiLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEN1cnJlbnRMaW5lc0Zyb21FZGl0b3IoZWRpdG9yKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6IFwidGFzay1tYXJrZXItY2FuY2VsXCIsXG4gICAgICAgICAgICBuYW1lOiBcIkNhbmNlbCB0YXNrXCIsXG4gICAgICAgICAgICBpY29uOiBJY29ucy5DQU5DRUwsXG4gICAgICAgICAgICBlZGl0b3JDaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4sIGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93blZpZXcpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMudGFza01hcmtlci5zZXR0aW5ncy5zdXBwb3J0Q2FuY2VsZWRUYXNrcztcbiAgICBcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgIGlmICghY2hlY2tpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1hcmtUYXNrT25MaW5lcyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXCItXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q3VycmVudExpbmVzRnJvbUVkaXRvcihlZGl0b3IpXG4gICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXG4gICAgICAgICAgICAgICAgfSAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiBcInRhc2stbWFya2VyLW1hcmtcIixcbiAgICAgICAgICAgIG5hbWU6IFwiTWFyayB0YXNrXCIsXG4gICAgICAgICAgICBpY29uOiBJY29ucy5NQVJLLFxuICAgICAgICAgICAgZWRpdG9yQ2FsbGJhY2s6IGFzeW5jIChlZGl0b3I6IEVkaXRvciwgdmlldzogTWFya2Rvd25WaWV3KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbWFyayA9IGF3YWl0IHByb21wdEZvck1hcmsodGhpcy5hcHAsIHRoaXMudGFza01hcmtlcik7XG4gICAgICAgICAgICAgICAgaWYgKG1hcmspIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXJrVGFza09uTGluZXMoXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRDdXJyZW50TGluZXNGcm9tRWRpdG9yKGVkaXRvcilcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6IFwidGFzay1tYXJrZXItcmVzZXRcIixcbiAgICAgICAgICAgIG5hbWU6IFwiUmVzZXQgdGFza1wiLFxuICAgICAgICAgICAgaWNvbjogSWNvbnMuUkVTRVQsXG4gICAgICAgICAgICBlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93blZpZXcpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLm1hcmtUYXNrT25MaW5lcyhcbiAgICAgICAgICAgICAgICAgICAgXCIgXCIsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q3VycmVudExpbmVzRnJvbUVkaXRvcihlZGl0b3IpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogXCJ0YXNrLW1hcmtlci1jb21wbGV0ZS1hbGxcIixcbiAgICAgICAgICAgIG5hbWU6IFwiQ29tcGxldGUgYWxsIHRhc2tzXCIsXG4gICAgICAgICAgICBpY29uOiBJY29ucy5DT01QTEVURV9BTEwsXG4gICAgICAgICAgICBjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuY29tcGxldGVBbGxUYXNrcygpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiBcInRhc2stbWFya2VyLXJlc2V0LWFsbFwiLFxuICAgICAgICAgICAgbmFtZTogXCJSZXNldCBhbGwgY29tcGxldGVkIHRhc2tzXCIsXG4gICAgICAgICAgICBpY29uOiBJY29ucy5DTEVBUixcbiAgICAgICAgICAgIGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXNldEFsbFRhc2tzKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBTZXQgaG90a2V5cyBmb3IgYWRkaXRpb25hbCB0YXNrIHN0YXR1c2VzIChyb3cgMSlcbiAgICAgICAgY29uc3QgaW5jb21wbGV0ZVRhc2tWYWx1ZXNMZW5ndGggPSB0aGlzLnRhc2tNYXJrZXIuc2V0dGluZ3MuaW5jb21wbGV0ZVRhc2tWYWx1ZXMubGVuZ3RoXG5cbiAgICAgICAgaWYgKGluY29tcGxldGVUYXNrVmFsdWVzTGVuZ3RoID49IDIpIHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IGluY29tcGxldGVUYXNrVmFsdWVzTGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IFwidGFzay1tYXJrZXItbWFyay10YXNrLXN0YXR1cy1yb3cxLVwiICsgaS50b1N0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIk1hcmsgdGFzayAocm93IDEpIGFzIHN0YXR1cyBcIiArIGkudG9TdHJpbmcoKSArIFwiIFxcXCJcIiArIHRoaXMudGFza01hcmtlci5zZXR0aW5ncy5pbmNvbXBsZXRlVGFza1ZhbHVlc1tpXSArIFwiXFxcIlwiLFxuICAgICAgICAgICAgICAgICAgICBpY29uOiBJY29ucy5NQVJLLFxuICAgICAgICAgICAgICAgICAgICBlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93blZpZXcpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWFya1Rhc2tPbkxpbmVzKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGFza01hcmtlci5zZXR0aW5ncy5pbmNvbXBsZXRlVGFza1ZhbHVlc1tpXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEN1cnJlbnRMaW5lc0Zyb21FZGl0b3IoZWRpdG9yKVxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNldCBob3RrZXlzIGZvciBhZGRpdGlvbmFsIHRhc2sgc3RhdHVzZXMgKHJvdyAyKVxuICAgICAgICBjb25zdCBpbmNvbXBsZXRlVGFza1ZhbHVlc1JvdzJMZW5ndGggPSB0aGlzLnRhc2tNYXJrZXIuc2V0dGluZ3MuaW5jb21wbGV0ZVRhc2tWYWx1ZXNSb3cyLmxlbmd0aFxuXG4gICAgICAgIGlmIChpbmNvbXBsZXRlVGFza1ZhbHVlc1JvdzJMZW5ndGggPj0gMSkge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPD0gaW5jb21wbGV0ZVRhc2tWYWx1ZXNSb3cyTGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IFwidGFzay1tYXJrZXItbWFyay10YXNrLXN0YXR1cy1yb3cyLVwiICsgKGkgKyAxKS50b1N0cmluZygpLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBcIk1hcmsgdGFzayAocm93IDIpIGFzIHN0YXR1cyBcIiArIChpICsgMSkudG9TdHJpbmcoKSArIFwiIFxcXCJcIiArIHRoaXMudGFza01hcmtlci5zZXR0aW5ncy5pbmNvbXBsZXRlVGFza1ZhbHVlc1JvdzJbaV0gKyBcIlxcXCJcIixcbiAgICAgICAgICAgICAgICAgICAgaWNvbjogSWNvbnMuTUFSSyxcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvciwgdmlldzogTWFya2Rvd25WaWV3KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1hcmtUYXNrT25MaW5lcyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRhc2tNYXJrZXIuc2V0dGluZ3MuaW5jb21wbGV0ZVRhc2tWYWx1ZXNSb3cyW2ldLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q3VycmVudExpbmVzRnJvbUVkaXRvcihlZGl0b3IpXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIGhvdGtleXMgZm9yIGN5Y2xpbmcgdGFzayBzdGF0dXNlc1xuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6IFwidGFzay1tYXJrZXItY3ljbGUtdGFzay1zdGF0dXNcIixcbiAgICAgICAgICAgIG5hbWU6IFwiQ3ljbGUgdGFzayBzdGF0dXNcIixcbiAgICAgICAgICAgIGljb246IEljb25zLk1BUkssXG4gICAgICAgICAgICBlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93blZpZXcpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLm1hcmtUYXNrT25MaW5lc0N5Y2xlKFxuICAgICAgICAgICAgICAgICAgICAneScsIC8vIFRoaXMgdmFsdWUgZG9lcyBub3QgbWF0dGVyLlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEN1cnJlbnRMaW5lc0Zyb21FZGl0b3IoZWRpdG9yKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBBZGQgaG90a2V5cyBmb3IgYXBwZW5kaW5nIHRleHRcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiBcInRhc2stbWFya2VyLWFwcGVuZC10ZXh0XCIsXG4gICAgICAgICAgICBuYW1lOiBcIkFwcGVuZCB0ZXh0XCIsXG4gICAgICAgICAgICAvLyBpY29uOiBJY29ucy5SRVNFVCxcbiAgICAgICAgICAgIGVkaXRvckNhbGxiYWNrOiAoZWRpdG9yOiBFZGl0b3IsIHZpZXc6IE1hcmtkb3duVmlldykgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwZW5kVGV4dE9uTGluZXMoXG4gICAgICAgICAgICAgICAgICAgIFwieVwiLCAvLyBUaGUgbWFyayB2YWx1ZSBkb2VzIG5vdCBtYXR0ZXIuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q3VycmVudExpbmVzRnJvbUVkaXRvcihlZGl0b3IpXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMucmVnaXN0ZXJIYW5kbGVycygpO1xuICAgICAgICB0aGlzLmFwaSA9IG5ldyBUYXNrTWFya2VyQXBpKHRoaXMuYXBwLCB0aGlzLnRhc2tNYXJrZXIpO1xuICAgIH1cblxuICAgIGdldEN1cnJlbnRMaW5lc0Zyb21FZGl0b3IoZWRpdG9yOiBFZGl0b3IpOiBudW1iZXJbXSB7XG4gICAgICAgIGNvbnN0IGxpbmVzOiBudW1iZXJbXSA9IFtdO1xuICAgICAgICBpZiAoZWRpdG9yLnNvbWV0aGluZ1NlbGVjdGVkKCkpIHtcbiAgICAgICAgICAgIGNvbnN0IGN1cnNvclN0YXJ0ID0gZWRpdG9yLmdldEN1cnNvcihcImZyb21cIik7XG4gICAgICAgICAgICBjb25zdCBjdXJzb3JFbmQgPSBlZGl0b3IuZ2V0Q3Vyc29yKFwidG9cIik7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gY3Vyc29yU3RhcnQubGluZTsgaSA8PSBjdXJzb3JFbmQubGluZTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgbGluZXMucHVzaChpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGFuY2hvciA9IGVkaXRvci5nZXRDdXJzb3IoXCJmcm9tXCIpO1xuICAgICAgICAgICAgbGluZXMucHVzaChhbmNob3IubGluZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxpbmVzO1xuICAgIH1cblxuICAgIGJ1aWxkTWVudShtZW51OiBNZW51LCBsaW5lcz86IG51bWJlcltdKTogdm9pZCB7XG4gICAgICAgIC8vIGlmIHJpZ2h0LWNsaWNrIGNyZWF0ZSBtZW51IGl0ZW0gaXMgZW5hYmxlZFxuICAgICAgICBpZiAodGhpcy50YXNrTWFya2VyLnNldHRpbmdzLnJpZ2h0Q2xpY2tDcmVhdGUpIHtcbiAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT5cbiAgICAgICAgICAgICAgICBpdGVtXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUaXRsZShcIihUTSkgQ3JlYXRlIHRhc2tcIilcbiAgICAgICAgICAgICAgICAgICAgLnNldEljb24oSWNvbnMuUkVTRVQpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWFya1Rhc2tPbkxpbmVzQ3JlYXRlKFwiIFwiLCBsaW5lcyk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYgcmlnaHQtY2xpY2sgY29tcGxldGUgbWVudSBpdGVtIGlzIGVuYWJsZWRcbiAgICAgICAgaWYgKHRoaXMudGFza01hcmtlci5zZXR0aW5ncy5yaWdodENsaWNrQ29tcGxldGUpIHtcbiAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT5cbiAgICAgICAgICAgICAgICBpdGVtXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUaXRsZShcIihUTSkgQ29tcGxldGUgdGFza1wiKVxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihJY29ucy5DT01QTEVURSlcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXJrVGFza09uTGluZXMoXCJ4XCIsIGxpbmVzKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIC8vIGlmIGNhbmNlbGxpbmcgdGFza3MgaXMgc3VwcG9ydGVkLCBhZGQgdGhlIG1lbnUgaXRlbSBmb3IgdGhhdC5cbiAgICAgICAgICAgIGlmICh0aGlzLnRhc2tNYXJrZXIuc2V0dGluZ3Muc3VwcG9ydENhbmNlbGVkVGFza3MpIHtcbiAgICAgICAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+XG4gICAgICAgICAgICAgICAgICAgIGl0ZW1cbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRUaXRsZShcIihUTSkgQ2FuY2VsIHRhc2tcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKEljb25zLkNBTkNFTClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1hcmtUYXNrT25MaW5lcyhcIi1cIiwgbGluZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYgcmlnaHQtY2xpY2sgbWFyayBtZW51IGl0ZW0gaXMgZW5hYmxlZFxuICAgICAgICBpZiAodGhpcy50YXNrTWFya2VyLnNldHRpbmdzLnJpZ2h0Q2xpY2tNYXJrKSB7XG4gICAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+XG4gICAgICAgICAgICAgICAgaXRlbVxuICAgICAgICAgICAgICAgICAgICAuc2V0VGl0bGUoXCIoVE0pIE1hcmsgdGFza1wiKVxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihJY29ucy5NQVJLKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXJrID0gYXdhaXQgcHJvbXB0Rm9yTWFyayhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRhc2tNYXJrZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWFyaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWFya1Rhc2tPbkxpbmVzKG1hcmssIGxpbmVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpZiByaWdodC1jbGljayBjeWNsZSBtZW51IGl0ZW0gaXMgZW5hYmxlZFxuICAgICAgICBpZiAodGhpcy50YXNrTWFya2VyLnNldHRpbmdzLnJpZ2h0Q2xpY2tDeWNsZSkge1xuICAgICAgICAgICAgbWVudS5hZGRJdGVtKChpdGVtKSA9PlxuICAgICAgICAgICAgICAgIGl0ZW1cbiAgICAgICAgICAgICAgICAgICAgLnNldFRpdGxlKFwiKFRNKSBDeWNsZSB0YXNrIHN0YXR1c1wiKVxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihJY29ucy5DT01QTEVURSlcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXJrVGFza09uTGluZXNDeWNsZShcInlcIiwgbGluZXMpOyAvLyBUaGUgbWFyayB2YWx1ZSBkb2VzIG5vdCBtYXR0ZXIuXG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gYWRkIGFuIGl0ZW0gZm9yIHJlc2V0dGluZyBzZWxlY3RlZCB0YXNrcyBpZiBlbmFibGVkXG4gICAgICAgIGlmICh0aGlzLnRhc2tNYXJrZXIuc2V0dGluZ3MucmlnaHRDbGlja1Jlc2V0VGFzaykge1xuICAgICAgICAgICAgbWVudS5hZGRJdGVtKChpdGVtKSA9PlxuICAgICAgICAgICAgICAgIGl0ZW1cbiAgICAgICAgICAgICAgICAgICAgLnNldFRpdGxlKFwiKFRNKSBSZXNldCB0YXNrXCIpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKEljb25zLlJFU0VUKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1hcmtUYXNrT25MaW5lcyhcIiBcIiwgbGluZXMpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGlmIHJpZ2h0LWNsaWNrIGFwcGVuZCBtZW51IGl0ZW0gaXMgZW5hYmxlZFxuICAgICAgICBpZiAodGhpcy50YXNrTWFya2VyLnNldHRpbmdzLnJpZ2h0Q2xpY2tBcHBlbmQpIHtcbiAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT5cbiAgICAgICAgICAgICAgICBpdGVtXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUaXRsZShcIihUTSkgQXBwZW5kIHRleHRcIilcbiAgICAgICAgICAgICAgICAgICAgLy8gLnNldEljb24oSWNvbnMuUkVTRVQpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwZW5kVGV4dE9uTGluZXMoXCJ5XCIsIGxpbmVzKTsgLy8gVGhlIG1hcmsgdmFsdWUgZG9lcyBub3QgbWF0dGVyLlxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIHJpZ2h0LWNsaWNrIG1vdmUgY29tcGxldGVkIHRhc2tzIGlzIGVuYWJsZWQ6XG4gICAgICAgIC8vIGlmICh0aGlzLnRhc2tNYXJrZXIuc2V0dGluZ3MucmlnaHRDbGlja01vdmUpIHtcbiAgICAgICAgLy8gICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT5cbiAgICAgICAgLy8gICAgICAgICBpdGVtXG4gICAgICAgIC8vICAgICAgICAgICAgIC5zZXRUaXRsZShcIihUTSkgTW92ZSBjb21wbGV0ZWQgdGFza3NcIilcbiAgICAgICAgLy8gICAgICAgICAgICAgLnNldEljb24oSWNvbnMuTU9WRSlcbiAgICAgICAgLy8gICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgdGhpcy5tb3ZlQWxsVGFza3MoKTtcbiAgICAgICAgLy8gICAgICAgICAgICAgfSlcbiAgICAgICAgLy8gICAgICk7XG4gICAgICAgIC8vIH1cblxuICAgICAgICAvLyBJZiByaWdodC1jbGljayB0b2dnbGUtYWxsIG1lbnUgaXRlbSBpcyBlbmFibGVkOlxuICAgICAgICBpZiAodGhpcy50YXNrTWFya2VyLnNldHRpbmdzLnJpZ2h0Q2xpY2tUb2dnbGVBbGwpIHtcbiAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT5cbiAgICAgICAgICAgICAgICBpdGVtXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUaXRsZShcIihUTSkgQ29tcGxldGUgYWxsIHRhc2tzXCIpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKEljb25zLkNPTVBMRVRFX0FMTClcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jb21wbGV0ZUFsbFRhc2tzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gYWRkIGFuIGl0ZW0gZm9yIHJlc2V0dGluZyBzZWxlY3RlZCB0YXNrcyBpZiBlbmFibGVkXG4gICAgICAgIGlmICh0aGlzLnRhc2tNYXJrZXIuc2V0dGluZ3MucmlnaHRDbGlja1Jlc2V0QWxsKSB7XG4gICAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+XG4gICAgICAgICAgICAgICAgaXRlbVxuICAgICAgICAgICAgICAgICAgICAuc2V0VGl0bGUoXCIoVE0pIFJlc2V0IGFsbCB0YXNrc1wiKVxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihJY29ucy5DTEVBUilcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXNldEFsbFRhc2tzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgbWFya1Rhc2tPbkxpbmVzKG1hcms6IHN0cmluZywgbGluZXM/OiBudW1iZXJbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgY29uc3Qgc291cmNlID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChhY3RpdmVGaWxlKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy50YXNrTWFya2VyLm1hcmtUYXNrSW5Tb3VyY2Uoc291cmNlLCBtYXJrLCBsaW5lcyk7XG4gICAgICAgIHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShhY3RpdmVGaWxlLCByZXN1bHQpO1xuICAgIH1cblxuICAgIGFzeW5jIG1hcmtUYXNrT25MaW5lc0N5Y2xlKG1hcms6IHN0cmluZywgbGluZXM/OiBudW1iZXJbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgY29uc3Qgc291cmNlID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChhY3RpdmVGaWxlKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy50YXNrTWFya2VyLm1hcmtUYXNrSW5Tb3VyY2VDeWNsZShzb3VyY2UsIG1hcmssIGxpbmVzKTtcbiAgICAgICAgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGFjdGl2ZUZpbGUsIHJlc3VsdCk7XG4gICAgfVxuXG4gICAgYXN5bmMgbWFya1Rhc2tPbkxpbmVzQ3JlYXRlKG1hcms6IHN0cmluZywgbGluZXM/OiBudW1iZXJbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgY29uc3Qgc291cmNlID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChhY3RpdmVGaWxlKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy50YXNrTWFya2VyLm1hcmtUYXNrSW5Tb3VyY2VDcmVhdGUoc291cmNlLCBtYXJrLCBsaW5lcyk7XG4gICAgICAgIHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShhY3RpdmVGaWxlLCByZXN1bHQpO1xuICAgIH1cblxuICAgIGFzeW5jIGFwcGVuZFRleHRPbkxpbmVzKG1hcms6IHN0cmluZywgbGluZXM/OiBudW1iZXJbXSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgY29uc3Qgc291cmNlID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChhY3RpdmVGaWxlKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy50YXNrTWFya2VyLmFwcGVuZFRleHRJblNvdXJjZShzb3VyY2UsIG1hcmssIGxpbmVzKTtcbiAgICAgICAgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGFjdGl2ZUZpbGUsIHJlc3VsdCk7XG4gICAgfVxuXG4gICAgLy8gYXN5bmMgbW92ZUFsbFRhc2tzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIC8vICAgICBjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAvLyAgICAgY29uc3Qgc291cmNlID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChhY3RpdmVGaWxlKTtcbiAgICAvLyAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy50YXNrTWFya2VyLm1vdmVDb21wbGV0ZWRUYXNrc0luRmlsZShzb3VyY2UpO1xuICAgIC8vICAgICB0aGlzLmFwcC52YXVsdC5tb2RpZnkoYWN0aXZlRmlsZSwgcmVzdWx0KTtcbiAgICAvLyB9XG5cbiAgICBhc3luYyBjb21wbGV0ZUFsbFRhc2tzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgY29uc3Qgc291cmNlID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChhY3RpdmVGaWxlKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy50YXNrTWFya2VyLm1hcmtBbGxUYXNrc0NvbXBsZXRlKHNvdXJjZSwgXCJ4XCIpO1xuICAgICAgICB0aGlzLmFwcC52YXVsdC5tb2RpZnkoYWN0aXZlRmlsZSwgcmVzdWx0KTtcbiAgICB9XG5cbiAgICBhc3luYyByZXNldEFsbFRhc2tzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcbiAgICAgICAgY29uc3Qgc291cmNlID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChhY3RpdmVGaWxlKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdGhpcy50YXNrTWFya2VyLnJlc2V0QWxsVGFza3Moc291cmNlKTtcbiAgICAgICAgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGFjdGl2ZUZpbGUsIHJlc3VsdCk7XG4gICAgfVxuXG4gICAgaGFuZGxlcnNSZWdpc3RlcmVkID0gZmFsc2U7XG4gICAgZXZlbnRSZWY6IEV2ZW50UmVmO1xuICAgIHBvc3RQcm9jZXNzb3I6IE1hcmtkb3duUG9zdFByb2Nlc3NvcjtcbiAgICByZWdpc3RlckhhbmRsZXJzKCk6IHZvaWQge1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICB0aGlzLnRhc2tNYXJrZXIuaW5pdFNldHRpbmdzLnJlZ2lzdGVySGFuZGxlcnMgJiZcbiAgICAgICAgICAgICF0aGlzLmhhbmRsZXJzUmVnaXN0ZXJlZFxuICAgICAgICApIHtcbiAgICAgICAgICAgIHRoaXMuaGFuZGxlcnNSZWdpc3RlcmVkID0gdHJ1ZTtcblxuICAgICAgICAgICAgLy8gU291cmNlIC8gRWRpdCBtb2RlXG4gICAgICAgICAgICBpZiAodGhpcy50YXNrTWFya2VyLmluaXRTZXR0aW5ncy5yaWdodENsaWNrVGFza01lbnUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICAgICAgICAgICAgICAgICh0aGlzLmV2ZW50UmVmID0gdGhpcy5hcHAud29ya3NwYWNlLm9uKFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJlZGl0b3ItbWVudVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgKG1lbnUsIGVkaXRvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vZ2V0IGxpbmUgc2VsZWN0aW9ucyBoZXJlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idWlsZE1lbnUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lbnUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0Q3VycmVudExpbmVzRnJvbUVkaXRvcihlZGl0b3IpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgKSlcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBQcmV2aWV3IC8gTGl2ZSBQcmV2aWV3XG4gICAgICAgICAgICB0aGlzLnJlZ2lzdGVyTWFya2Rvd25Qb3N0UHJvY2Vzc29yKFxuICAgICAgICAgICAgICAgICh0aGlzLnBvc3RQcm9jZXNzb3IgPSAoZWwsIGN0eCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGVja2JveGVzID0gZWwucXVlcnlTZWxlY3RvckFsbDxIVE1MSW5wdXRFbGVtZW50PihcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiLnRhc2stbGlzdC1pdGVtLWNoZWNrYm94XCJcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFjaGVja2JveGVzLmxlbmd0aCkgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlY3Rpb24gPSBjdHguZ2V0U2VjdGlvbkluZm8oZWwpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXNlY3Rpb24pIHJldHVybjtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCB7IGxpbmVTdGFydCB9ID0gc2VjdGlvbjtcblxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGNoZWNrYm94IG9mIEFycmF5LmZyb20oY2hlY2tib3hlcykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxpbmUgPSBOdW1iZXIoY2hlY2tib3guZGF0YXNldC5saW5lKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGFza01hcmtlci5pbml0U2V0dGluZ3MucmlnaHRDbGlja1Rhc2tNZW51XG4gICAgICAgICAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoZWNrYm94LnBhcmVudEVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiY29udGV4dG1lbnVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGV2KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmlldyA9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hcmtkb3duVmlld1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmlldyAmJiB2aWV3LmVkaXRvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1lbnUgPSBuZXcgTWVudSh0aGlzLmFwcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5idWlsZE1lbnUobWVudSwgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lU3RhcnQgKyBsaW5lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lbnUuc2hvd0F0TW91c2VFdmVudChldik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy50YXNrTWFya2VyLnNldHRpbmdzLnByZXZpZXdPbkNsaWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWdpc3RlckRvbUV2ZW50KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGVja2JveCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJjbGlja1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3luYyAoZXYpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXYucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hcmsgPSBhd2FpdCBwcm9tcHRGb3JNYXJrKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGFza01hcmtlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXJrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXJrVGFza09uTGluZXMobWFyaywgW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lU3RhcnQgKyBsaW5lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdW5yZWdpc3RlckhhbmRsZXJzKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmhhbmRsZXJzUmVnaXN0ZXJlZCA9IGZhbHNlO1xuXG4gICAgICAgIGlmICh0aGlzLmV2ZW50UmVmKSB7XG4gICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub2ZmcmVmKHRoaXMuZXZlbnRSZWYpO1xuICAgICAgICAgICAgdGhpcy5ldmVudFJlZiA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5wb3N0UHJvY2Vzc29yKSB7XG4gICAgICAgICAgICBNYXJrZG93blByZXZpZXdSZW5kZXJlci51bnJlZ2lzdGVyUG9zdFByb2Nlc3Nvcih0aGlzLnBvc3RQcm9jZXNzb3IpO1xuICAgICAgICAgICAgdGhpcy5wb3N0UHJvY2Vzc29yID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9udW5sb2FkKCk6IHZvaWQge1xuICAgICAgICBjb25zb2xlLmxvZyhcInVubG9hZGluZyBUYXNrIE1hcmtlciAoVE0pXCIpO1xuICAgIH1cblxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKFxuICAgICAgICAgICAge30sXG4gICAgICAgICAgICBERUZBVUxUX1NFVFRJTkdTLFxuICAgICAgICAgICAgYXdhaXQgdGhpcy5sb2FkRGF0YSgpXG4gICAgICAgICk7XG4gICAgICAgIC8vIHJlbW92ZSBvbGQgYXR0cmlidXRlXG4gICAgICAgIGlmIChzZXR0aW5ncy5yaWdodENsaWNrUmVzZXQpIHtcbiAgICAgICAgICAgIGRlbGV0ZSBzZXR0aW5ncy5yaWdodENsaWNrUmVzZXQ7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHNldHRpbmdzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnRhc2tNYXJrZXIudXBkYXRlU2V0dGluZ3Moc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnRhc2tNYXJrZXIuc2V0dGluZ3MpO1xuICAgICAgICBpZiAoXG4gICAgICAgICAgICB0aGlzLnRhc2tNYXJrZXIuaW5pdFNldHRpbmdzLnJpZ2h0Q2xpY2tUYXNrTWVudSAmJlxuICAgICAgICAgICAgIXRoaXMuaGFuZGxlcnNSZWdpc3RlcmVkXG4gICAgICAgICkge1xuICAgICAgICAgICAgdGhpcy5yZWdpc3RlckhhbmRsZXJzKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFxuICAgICAgICAgICAgIXRoaXMudGFza01hcmtlci5pbml0U2V0dGluZ3MucmlnaHRDbGlja1Rhc2tNZW51ICYmXG4gICAgICAgICAgICB0aGlzLmhhbmRsZXJzUmVnaXN0ZXJlZFxuICAgICAgICApIHtcbiAgICAgICAgICAgIHRoaXMudW5yZWdpc3RlckhhbmRsZXJzKCk7XG4gICAgICAgIH1cbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgQXBwLCBtb21lbnQsIE5vdGljZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHtcbiAgICBUYXNrTWFya2VyU2V0dGluZ3MsXG4gICAgQ29tcGlsZWRUYXNrc1NldHRpbmdzLFxufSBmcm9tIFwiLi90YXNrbWFya2VyLVNldHRpbmdzXCI7XG5cbmV4cG9ydCBjbGFzcyBUYXNrTWFya2VyIHtcbiAgICBzZXR0aW5nczogVGFza01hcmtlclNldHRpbmdzO1xuICAgIGluaXRTZXR0aW5nczogQ29tcGlsZWRUYXNrc1NldHRpbmdzO1xuICAgIGFueUxpc3RJdGVtOiBSZWdFeHA7XG4gICAgdGFza01hcms6IFJlZ0V4cDtcbiAgICBhbnlUYXNrTWFyazogUmVnRXhwO1xuICAgIGJsb2NrUXVvdGU6IFJlZ0V4cDtcbiAgICBibG9ja1JlZjogUmVnRXhwO1xuICAgIGNvbnRpbnVhdGlvbjogUmVnRXhwO1xuICAgIHN0cmlwVGFzazogUmVnRXhwO1xuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBhcHA6IEFwcCkge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy5hbnlMaXN0SXRlbSA9IG5ldyBSZWdFeHAoL14oW1xccz5dKi0gKShbXlxcXFxbXS4qKSQvKTtcbiAgICAgICAgdGhpcy5hbnlUYXNrTWFyayA9IG5ldyBSZWdFeHAoL14oW1xccz5dKi0gXFxbKSguKShcXF0gLiopJC8pO1xuICAgICAgICB0aGlzLmJsb2NrUXVvdGUgPSBuZXcgUmVnRXhwKC9eKFxccyo+W1xccz5dKikoLiopJC8pO1xuICAgICAgICB0aGlzLmJsb2NrUmVmID0gbmV3IFJlZ0V4cCgvXiguKj8pKCBcXF5bQS1aYS16MC05LV0rKT8kLyk7XG4gICAgICAgIHRoaXMuY29udGludWF0aW9uID0gbmV3IFJlZ0V4cCgvXiggezIsfXxcXHQpLyk7XG4gICAgICAgIHRoaXMuc3RyaXBUYXNrID0gbmV3IFJlZ0V4cCgvXihbXFxzPl0qLSkgXFxbLlxcXSAoLiopJC8pO1xuICAgIH1cblxuICAgIHVwZGF0ZVNldHRpbmdzKHNldHRpbmdzOiBUYXNrTWFya2VyU2V0dGluZ3MpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgICAgICBsZXQgbW9tZW50TWF0Y2hTdHJpbmcgPSBudWxsO1xuXG4gICAgICAgIGlmIChzZXR0aW5ncy5hcHBlbmREYXRlRm9ybWF0KSB7XG4gICAgICAgICAgICAvLyBZWVlZLU1NLUREIG9yIEREIE1NLCBZWVlZIG9yIC4uIFsoXVlZWVktTU0tRERbKV0gd2hlcmUgdGhlIHN0dWZmIGluIHRoZSBicmFja2V0cyBpcyBsaXRlcmFsXG4gICAgICAgICAgICBjb25zdCBsaXRlcmFscyA9IFtdO1xuXG4gICAgICAgICAgICBjb25zdCByZWdleDEgPSBSZWdFeHAoXCIoXFxcXFsuKj9cXFxcXVxcXFxdPylcIiwgXCJnXCIpO1xuICAgICAgICAgICAgbGV0IG1hdGNoO1xuICAgICAgICAgICAgbGV0IGkgPSAwO1xuXG4gICAgICAgICAgICBtb21lbnRNYXRjaFN0cmluZyA9IHNldHRpbmdzLmFwcGVuZERhdGVGb3JtYXQ7XG4gICAgICAgICAgICB3aGlsZSAoKG1hdGNoID0gcmVnZXgxLmV4ZWMobW9tZW50TWF0Y2hTdHJpbmcpKSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIG1vbWVudE1hdGNoU3RyaW5nID0gbW9tZW50TWF0Y2hTdHJpbmcucmVwbGFjZShcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hbMF0sXG4gICAgICAgICAgICAgICAgICAgIGAlJCR7aX0kJWBcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGxpdGVyYWxzLnB1c2goXG4gICAgICAgICAgICAgICAgICAgIG1hdGNoWzBdXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3Vic3RyaW5nKDEsIG1hdGNoWzBdLmxlbmd0aCAtIDEpXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFwoL2csIFwiXFxcXChcIikgLy8gZXNjYXBlIGEgbmFrZWQgKFxuICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcKS9nLCBcIlxcXFwpXCIpIC8vIGVzY2FwZSBhIG5ha2VkIClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXFsvZywgXCJcXFxcW1wiKSAvLyBlc2NhcGUgYSBuYWtlZCBbXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFxdL2csIFwiXFxcXF1cIilcbiAgICAgICAgICAgICAgICApOyAvLyBlc2NhcGUgYSBuYWtlZCBdXG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBOb3cgbGV0J3MgcmVwbGFjZSBtb21lbnQgZGF0ZSBmb3JtYXR0aW5nXG4gICAgICAgICAgICBtb21lbnRNYXRjaFN0cmluZyA9IG1vbWVudE1hdGNoU3RyaW5nXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoXCJZWVlZXCIsIFwiXFxcXGR7NH1cIikgLy8gNC1kaWdpdCB5ZWFyXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoXCJZWVwiLCBcIlxcXFxkezJ9XCIpIC8vIDItZGlnaXQgeWVhclxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiRERcIiwgXCJcXFxcZHsyfVwiKSAvLyBkYXkgb2YgbW9udGgsIHBhZGRlZFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiRFwiLCBcIlxcXFxkezEsMn1cIikgLy8gZGF5IG9mIG1vbnRoLCBub3QgcGFkZGVkXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoXCJNTU1cIiwgXCJbQS1aYS16XXszfVwiKSAvLyBtb250aCwgYWJicnZcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIk1NXCIsIFwiXFxcXGR7Mn1cIikgLy8gbW9udGgsIHBhZGRlZFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiTVwiLCBcIlxcXFxkezEsMn1cIikgLy8gbW9udGgsIG5vdCBwYWRkZWRcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIkhIXCIsIFwiXFxcXGR7Mn1cIikgLy8gMjQtaG91ciwgcGFkZGVkXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoXCJIXCIsIFwiXFxcXGR7MSwyfVwiKSAvLyAyNC1ob3VyLCBub3QgcGFkZGVkXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoXCJoaFwiLCBcIlxcXFxkezJ9XCIpIC8vIDEyLWhvdXIsIHBhZGRlZFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiaFwiLCBcIlxcXFxkezEsMn1cIikgLy8gMTItaG91ciwgbm90IHBhZGRlZFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwibW1cIiwgXCJcXFxcZHsyfVwiKSAvLyBtaW51dGUsIHBhZGRlZFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwibVwiLCBcIlxcXFxkezEsMn1cIik7IC8vIG1pbnV0ZSwgbm90IHBhZGRlZFxuXG4gICAgICAgICAgICBpZiAobGl0ZXJhbHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGl0ZXJhbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbW9tZW50TWF0Y2hTdHJpbmcgPSBtb21lbnRNYXRjaFN0cmluZy5yZXBsYWNlKFxuICAgICAgICAgICAgICAgICAgICAgICAgYCUkJHtpfSQlYCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpdGVyYWxzW2ldXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbW9tZW50TWF0Y2hTdHJpbmcgPSBgXFxcXHMqJHttb21lbnRNYXRjaFN0cmluZ31cXFxccypgO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHNldHRpbmdzLmFwcGVuZFRleHRGb3JtYXRNYXJrKSB7XG4gICAgICAgICAgICAvLyBZWVlZLU1NLUREIG9yIEREIE1NLCBZWVlZIG9yIC4uIFsoXVlZWVktTU0tRERbKV0gd2hlcmUgdGhlIHN0dWZmIGluIHRoZSBicmFja2V0cyBpcyBsaXRlcmFsXG4gICAgICAgICAgICBjb25zdCBsaXRlcmFscyA9IFtdO1xuXG4gICAgICAgICAgICBjb25zdCByZWdleDEgPSBSZWdFeHAoXCIoXFxcXFsuKj9cXFxcXVxcXFxdPylcIiwgXCJnXCIpO1xuICAgICAgICAgICAgbGV0IG1hdGNoO1xuICAgICAgICAgICAgbGV0IGkgPSAwO1xuXG4gICAgICAgICAgICBtb21lbnRNYXRjaFN0cmluZyA9IHNldHRpbmdzLmFwcGVuZFRleHRGb3JtYXRNYXJrO1xuICAgICAgICAgICAgd2hpbGUgKChtYXRjaCA9IHJlZ2V4MS5leGVjKG1vbWVudE1hdGNoU3RyaW5nKSkgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBtb21lbnRNYXRjaFN0cmluZyA9IG1vbWVudE1hdGNoU3RyaW5nLnJlcGxhY2UoXG4gICAgICAgICAgICAgICAgICAgIG1hdGNoWzBdLFxuICAgICAgICAgICAgICAgICAgICBgJSQke2l9JCVgXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBsaXRlcmFscy5wdXNoKFxuICAgICAgICAgICAgICAgICAgICBtYXRjaFswXVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1YnN0cmluZygxLCBtYXRjaFswXS5sZW5ndGggLSAxKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcKC9nLCBcIlxcXFwoXCIpIC8vIGVzY2FwZSBhIG5ha2VkIChcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXCkvZywgXCJcXFxcKVwiKSAvLyBlc2NhcGUgYSBuYWtlZCApXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFxbL2csIFwiXFxcXFtcIikgLy8gZXNjYXBlIGEgbmFrZWQgW1xuICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcXS9nLCBcIlxcXFxdXCIpXG4gICAgICAgICAgICAgICAgKTsgLy8gZXNjYXBlIGEgbmFrZWQgXVxuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gTm93IGxldCdzIHJlcGxhY2UgbW9tZW50IGRhdGUgZm9ybWF0dGluZ1xuICAgICAgICAgICAgbW9tZW50TWF0Y2hTdHJpbmcgPSBtb21lbnRNYXRjaFN0cmluZ1xuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiWVlZWVwiLCBcIlxcXFxkezR9XCIpIC8vIDQtZGlnaXQgeWVhclxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiWVlcIiwgXCJcXFxcZHsyfVwiKSAvLyAyLWRpZ2l0IHllYXJcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIkREXCIsIFwiXFxcXGR7Mn1cIikgLy8gZGF5IG9mIG1vbnRoLCBwYWRkZWRcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIkRcIiwgXCJcXFxcZHsxLDJ9XCIpIC8vIGRheSBvZiBtb250aCwgbm90IHBhZGRlZFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiTU1NXCIsIFwiW0EtWmEtel17M31cIikgLy8gbW9udGgsIGFiYnJ2XG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoXCJNTVwiLCBcIlxcXFxkezJ9XCIpIC8vIG1vbnRoLCBwYWRkZWRcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIk1cIiwgXCJcXFxcZHsxLDJ9XCIpIC8vIG1vbnRoLCBub3QgcGFkZGVkXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoXCJISFwiLCBcIlxcXFxkezJ9XCIpIC8vIDI0LWhvdXIsIHBhZGRlZFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiSFwiLCBcIlxcXFxkezEsMn1cIikgLy8gMjQtaG91ciwgbm90IHBhZGRlZFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiaGhcIiwgXCJcXFxcZHsyfVwiKSAvLyAxMi1ob3VyLCBwYWRkZWRcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcImhcIiwgXCJcXFxcZHsxLDJ9XCIpIC8vIDEyLWhvdXIsIG5vdCBwYWRkZWRcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIm1tXCIsIFwiXFxcXGR7Mn1cIikgLy8gbWludXRlLCBwYWRkZWRcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIm1cIiwgXCJcXFxcZHsxLDJ9XCIpOyAvLyBtaW51dGUsIG5vdCBwYWRkZWRcblxuICAgICAgICAgICAgaWYgKGxpdGVyYWxzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpdGVyYWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG1vbWVudE1hdGNoU3RyaW5nID0gbW9tZW50TWF0Y2hTdHJpbmcucmVwbGFjZShcbiAgICAgICAgICAgICAgICAgICAgICAgIGAlJCR7aX0kJWAsXG4gICAgICAgICAgICAgICAgICAgICAgICBsaXRlcmFsc1tpXVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1vbWVudE1hdGNoU3RyaW5nID0gYFxcXFxzKiR7bW9tZW50TWF0Y2hTdHJpbmd9XFxcXHMqYDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzZXR0aW5ncy5hcHBlbmRUZXh0Rm9ybWF0TWFya1JvdzIpIHtcbiAgICAgICAgICAgIC8vIFlZWVktTU0tREQgb3IgREQgTU0sIFlZWVkgb3IgLi4gWyhdWVlZWS1NTS1ERFspXSB3aGVyZSB0aGUgc3R1ZmYgaW4gdGhlIGJyYWNrZXRzIGlzIGxpdGVyYWxcbiAgICAgICAgICAgIGNvbnN0IGxpdGVyYWxzID0gW107XG5cbiAgICAgICAgICAgIGNvbnN0IHJlZ2V4MSA9IFJlZ0V4cChcIihcXFxcWy4qP1xcXFxdXFxcXF0/KVwiLCBcImdcIik7XG4gICAgICAgICAgICBsZXQgbWF0Y2g7XG4gICAgICAgICAgICBsZXQgaSA9IDA7XG5cbiAgICAgICAgICAgIG1vbWVudE1hdGNoU3RyaW5nID0gc2V0dGluZ3MuYXBwZW5kVGV4dEZvcm1hdE1hcmtSb3cyO1xuICAgICAgICAgICAgd2hpbGUgKChtYXRjaCA9IHJlZ2V4MS5leGVjKG1vbWVudE1hdGNoU3RyaW5nKSkgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBtb21lbnRNYXRjaFN0cmluZyA9IG1vbWVudE1hdGNoU3RyaW5nLnJlcGxhY2UoXG4gICAgICAgICAgICAgICAgICAgIG1hdGNoWzBdLFxuICAgICAgICAgICAgICAgICAgICBgJSQke2l9JCVgXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBsaXRlcmFscy5wdXNoKFxuICAgICAgICAgICAgICAgICAgICBtYXRjaFswXVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1YnN0cmluZygxLCBtYXRjaFswXS5sZW5ndGggLSAxKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcKC9nLCBcIlxcXFwoXCIpIC8vIGVzY2FwZSBhIG5ha2VkIChcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXCkvZywgXCJcXFxcKVwiKSAvLyBlc2NhcGUgYSBuYWtlZCApXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFxbL2csIFwiXFxcXFtcIikgLy8gZXNjYXBlIGEgbmFrZWQgW1xuICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcXS9nLCBcIlxcXFxdXCIpXG4gICAgICAgICAgICAgICAgKTsgLy8gZXNjYXBlIGEgbmFrZWQgXVxuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gTm93IGxldCdzIHJlcGxhY2UgbW9tZW50IGRhdGUgZm9ybWF0dGluZ1xuICAgICAgICAgICAgbW9tZW50TWF0Y2hTdHJpbmcgPSBtb21lbnRNYXRjaFN0cmluZ1xuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiWVlZWVwiLCBcIlxcXFxkezR9XCIpIC8vIDQtZGlnaXQgeWVhclxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiWVlcIiwgXCJcXFxcZHsyfVwiKSAvLyAyLWRpZ2l0IHllYXJcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIkREXCIsIFwiXFxcXGR7Mn1cIikgLy8gZGF5IG9mIG1vbnRoLCBwYWRkZWRcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIkRcIiwgXCJcXFxcZHsxLDJ9XCIpIC8vIGRheSBvZiBtb250aCwgbm90IHBhZGRlZFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiTU1NXCIsIFwiW0EtWmEtel17M31cIikgLy8gbW9udGgsIGFiYnJ2XG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoXCJNTVwiLCBcIlxcXFxkezJ9XCIpIC8vIG1vbnRoLCBwYWRkZWRcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIk1cIiwgXCJcXFxcZHsxLDJ9XCIpIC8vIG1vbnRoLCBub3QgcGFkZGVkXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoXCJISFwiLCBcIlxcXFxkezJ9XCIpIC8vIDI0LWhvdXIsIHBhZGRlZFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiSFwiLCBcIlxcXFxkezEsMn1cIikgLy8gMjQtaG91ciwgbm90IHBhZGRlZFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiaGhcIiwgXCJcXFxcZHsyfVwiKSAvLyAxMi1ob3VyLCBwYWRkZWRcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcImhcIiwgXCJcXFxcZHsxLDJ9XCIpIC8vIDEyLWhvdXIsIG5vdCBwYWRkZWRcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIm1tXCIsIFwiXFxcXGR7Mn1cIikgLy8gbWludXRlLCBwYWRkZWRcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIm1cIiwgXCJcXFxcZHsxLDJ9XCIpOyAvLyBtaW51dGUsIG5vdCBwYWRkZWRcblxuICAgICAgICAgICAgaWYgKGxpdGVyYWxzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpdGVyYWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG1vbWVudE1hdGNoU3RyaW5nID0gbW9tZW50TWF0Y2hTdHJpbmcucmVwbGFjZShcbiAgICAgICAgICAgICAgICAgICAgICAgIGAlJCR7aX0kJWAsXG4gICAgICAgICAgICAgICAgICAgICAgICBsaXRlcmFsc1tpXVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1vbWVudE1hdGNoU3RyaW5nID0gYFxcXFxzKiR7bW9tZW50TWF0Y2hTdHJpbmd9XFxcXHMqYDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzZXR0aW5ncy5hcHBlbmRUZXh0Rm9ybWF0Q3JlYXRpb24pIHtcbiAgICAgICAgICAgIC8vIFlZWVktTU0tREQgb3IgREQgTU0sIFlZWVkgb3IgLi4gWyhdWVlZWS1NTS1ERFspXSB3aGVyZSB0aGUgc3R1ZmYgaW4gdGhlIGJyYWNrZXRzIGlzIGxpdGVyYWxcbiAgICAgICAgICAgIGNvbnN0IGxpdGVyYWxzID0gW107XG5cbiAgICAgICAgICAgIGNvbnN0IHJlZ2V4MSA9IFJlZ0V4cChcIihcXFxcWy4qP1xcXFxdXFxcXF0/KVwiLCBcImdcIik7XG4gICAgICAgICAgICBsZXQgbWF0Y2g7XG4gICAgICAgICAgICBsZXQgaSA9IDA7XG5cbiAgICAgICAgICAgIG1vbWVudE1hdGNoU3RyaW5nID0gc2V0dGluZ3MuYXBwZW5kVGV4dEZvcm1hdENyZWF0aW9uO1xuICAgICAgICAgICAgd2hpbGUgKChtYXRjaCA9IHJlZ2V4MS5leGVjKG1vbWVudE1hdGNoU3RyaW5nKSkgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBtb21lbnRNYXRjaFN0cmluZyA9IG1vbWVudE1hdGNoU3RyaW5nLnJlcGxhY2UoXG4gICAgICAgICAgICAgICAgICAgIG1hdGNoWzBdLFxuICAgICAgICAgICAgICAgICAgICBgJSQke2l9JCVgXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBsaXRlcmFscy5wdXNoKFxuICAgICAgICAgICAgICAgICAgICBtYXRjaFswXVxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1YnN0cmluZygxLCBtYXRjaFswXS5sZW5ndGggLSAxKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcKC9nLCBcIlxcXFwoXCIpIC8vIGVzY2FwZSBhIG5ha2VkIChcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXCkvZywgXCJcXFxcKVwiKSAvLyBlc2NhcGUgYSBuYWtlZCApXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFxbL2csIFwiXFxcXFtcIikgLy8gZXNjYXBlIGEgbmFrZWQgW1xuICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcXS9nLCBcIlxcXFxdXCIpXG4gICAgICAgICAgICAgICAgKTsgLy8gZXNjYXBlIGEgbmFrZWQgXVxuICAgICAgICAgICAgICAgIGkrKztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gTm93IGxldCdzIHJlcGxhY2UgbW9tZW50IGRhdGUgZm9ybWF0dGluZ1xuICAgICAgICAgICAgbW9tZW50TWF0Y2hTdHJpbmcgPSBtb21lbnRNYXRjaFN0cmluZ1xuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiWVlZWVwiLCBcIlxcXFxkezR9XCIpIC8vIDQtZGlnaXQgeWVhclxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiWVlcIiwgXCJcXFxcZHsyfVwiKSAvLyAyLWRpZ2l0IHllYXJcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIkREXCIsIFwiXFxcXGR7Mn1cIikgLy8gZGF5IG9mIG1vbnRoLCBwYWRkZWRcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIkRcIiwgXCJcXFxcZHsxLDJ9XCIpIC8vIGRheSBvZiBtb250aCwgbm90IHBhZGRlZFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiTU1NXCIsIFwiW0EtWmEtel17M31cIikgLy8gbW9udGgsIGFiYnJ2XG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoXCJNTVwiLCBcIlxcXFxkezJ9XCIpIC8vIG1vbnRoLCBwYWRkZWRcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIk1cIiwgXCJcXFxcZHsxLDJ9XCIpIC8vIG1vbnRoLCBub3QgcGFkZGVkXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoXCJISFwiLCBcIlxcXFxkezJ9XCIpIC8vIDI0LWhvdXIsIHBhZGRlZFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiSFwiLCBcIlxcXFxkezEsMn1cIikgLy8gMjQtaG91ciwgbm90IHBhZGRlZFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiaGhcIiwgXCJcXFxcZHsyfVwiKSAvLyAxMi1ob3VyLCBwYWRkZWRcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcImhcIiwgXCJcXFxcZHsxLDJ9XCIpIC8vIDEyLWhvdXIsIG5vdCBwYWRkZWRcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIm1tXCIsIFwiXFxcXGR7Mn1cIikgLy8gbWludXRlLCBwYWRkZWRcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIm1cIiwgXCJcXFxcZHsxLDJ9XCIpOyAvLyBtaW51dGUsIG5vdCBwYWRkZWRcblxuICAgICAgICAgICAgaWYgKGxpdGVyYWxzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpdGVyYWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG1vbWVudE1hdGNoU3RyaW5nID0gbW9tZW50TWF0Y2hTdHJpbmcucmVwbGFjZShcbiAgICAgICAgICAgICAgICAgICAgICAgIGAlJCR7aX0kJWAsXG4gICAgICAgICAgICAgICAgICAgICAgICBsaXRlcmFsc1tpXVxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1vbWVudE1hdGNoU3RyaW5nID0gYFxcXFxzKiR7bW9tZW50TWF0Y2hTdHJpbmd9XFxcXHMqYDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzZXR0aW5ncy5hcHBlbmRUZXh0Rm9ybWF0QXBwZW5kKSB7XG4gICAgICAgICAgICAvLyBZWVlZLU1NLUREIG9yIEREIE1NLCBZWVlZIG9yIC4uIFsoXVlZWVktTU0tRERbKV0gd2hlcmUgdGhlIHN0dWZmIGluIHRoZSBicmFja2V0cyBpcyBsaXRlcmFsXG4gICAgICAgICAgICBjb25zdCBsaXRlcmFscyA9IFtdO1xuXG4gICAgICAgICAgICBjb25zdCByZWdleDEgPSBSZWdFeHAoXCIoXFxcXFsuKj9cXFxcXVxcXFxdPylcIiwgXCJnXCIpO1xuICAgICAgICAgICAgbGV0IG1hdGNoO1xuICAgICAgICAgICAgbGV0IGkgPSAwO1xuXG4gICAgICAgICAgICBtb21lbnRNYXRjaFN0cmluZyA9IHNldHRpbmdzLmFwcGVuZFRleHRGb3JtYXRBcHBlbmQ7XG4gICAgICAgICAgICB3aGlsZSAoKG1hdGNoID0gcmVnZXgxLmV4ZWMobW9tZW50TWF0Y2hTdHJpbmcpKSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIG1vbWVudE1hdGNoU3RyaW5nID0gbW9tZW50TWF0Y2hTdHJpbmcucmVwbGFjZShcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hbMF0sXG4gICAgICAgICAgICAgICAgICAgIGAlJCR7aX0kJWBcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGxpdGVyYWxzLnB1c2goXG4gICAgICAgICAgICAgICAgICAgIG1hdGNoWzBdXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3Vic3RyaW5nKDEsIG1hdGNoWzBdLmxlbmd0aCAtIDEpXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFwoL2csIFwiXFxcXChcIikgLy8gZXNjYXBlIGEgbmFrZWQgKFxuICAgICAgICAgICAgICAgICAgICAgICAgLnJlcGxhY2UoL1xcKS9nLCBcIlxcXFwpXCIpIC8vIGVzY2FwZSBhIG5ha2VkIClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXFsvZywgXCJcXFxcW1wiKSAvLyBlc2NhcGUgYSBuYWtlZCBbXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZSgvXFxdL2csIFwiXFxcXF1cIilcbiAgICAgICAgICAgICAgICApOyAvLyBlc2NhcGUgYSBuYWtlZCBdXG4gICAgICAgICAgICAgICAgaSsrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBOb3cgbGV0J3MgcmVwbGFjZSBtb21lbnQgZGF0ZSBmb3JtYXR0aW5nXG4gICAgICAgICAgICBtb21lbnRNYXRjaFN0cmluZyA9IG1vbWVudE1hdGNoU3RyaW5nXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoXCJZWVlZXCIsIFwiXFxcXGR7NH1cIikgLy8gNC1kaWdpdCB5ZWFyXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoXCJZWVwiLCBcIlxcXFxkezJ9XCIpIC8vIDItZGlnaXQgeWVhclxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiRERcIiwgXCJcXFxcZHsyfVwiKSAvLyBkYXkgb2YgbW9udGgsIHBhZGRlZFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiRFwiLCBcIlxcXFxkezEsMn1cIikgLy8gZGF5IG9mIG1vbnRoLCBub3QgcGFkZGVkXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoXCJNTU1cIiwgXCJbQS1aYS16XXszfVwiKSAvLyBtb250aCwgYWJicnZcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIk1NXCIsIFwiXFxcXGR7Mn1cIikgLy8gbW9udGgsIHBhZGRlZFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiTVwiLCBcIlxcXFxkezEsMn1cIikgLy8gbW9udGgsIG5vdCBwYWRkZWRcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIkhIXCIsIFwiXFxcXGR7Mn1cIikgLy8gMjQtaG91ciwgcGFkZGVkXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoXCJIXCIsIFwiXFxcXGR7MSwyfVwiKSAvLyAyNC1ob3VyLCBub3QgcGFkZGVkXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoXCJoaFwiLCBcIlxcXFxkezJ9XCIpIC8vIDEyLWhvdXIsIHBhZGRlZFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiaFwiLCBcIlxcXFxkezEsMn1cIikgLy8gMTItaG91ciwgbm90IHBhZGRlZFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwibW1cIiwgXCJcXFxcZHsyfVwiKSAvLyBtaW51dGUsIHBhZGRlZFxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwibVwiLCBcIlxcXFxkezEsMn1cIik7IC8vIG1pbnV0ZSwgbm90IHBhZGRlZFxuXG4gICAgICAgICAgICBpZiAobGl0ZXJhbHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGl0ZXJhbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgbW9tZW50TWF0Y2hTdHJpbmcgPSBtb21lbnRNYXRjaFN0cmluZy5yZXBsYWNlKFxuICAgICAgICAgICAgICAgICAgICAgICAgYCUkJHtpfSQlYCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpdGVyYWxzW2ldXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbW9tZW50TWF0Y2hTdHJpbmcgPSBgXFxcXHMqJHttb21lbnRNYXRjaFN0cmluZ31cXFxccypgO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29tcGxldGVkVGFza3MgPVxuICAgICAgICAgICAgKHRoaXMuc2V0dGluZ3Mub25seUxvd2VyY2FzZVggPyBcInhcIiA6IFwieFhcIikgK1xuICAgICAgICAgICAgKHRoaXMuc2V0dGluZ3Muc3VwcG9ydENhbmNlbGVkVGFza3MgPyBcIi1cIiA6IFwiXCIpO1xuXG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmluY29tcGxldGVUYXNrVmFsdWVzLmluZGV4T2YoXCIgXCIpIDwgMCkgeyAvLyBObyBuZWVkIHRvIGhhbmRsZSBSb3cyXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLmluY29tcGxldGVUYXNrVmFsdWVzID1cbiAgICAgICAgICAgICAgICBcIiBcIiArIHRoaXMuc2V0dGluZ3MuaW5jb21wbGV0ZVRhc2tWYWx1ZXM7IC8vIE5vdCB3b3JraW5nIGlmIHJlbW92aW5nIHNwYWNlXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByaWdodENsaWNrVGFza01lbnUgPVxuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5yaWdodENsaWNrQ29tcGxldGUgfHxcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MucmlnaHRDbGlja01hcmsgfHxcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MucmlnaHRDbGlja0N5Y2xlIHx8XG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLnJpZ2h0Q2xpY2tDcmVhdGUgfHxcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MucmlnaHRDbGlja0FwcGVuZCB8fFxuICAgICAgICAgICAgLy8gdGhpcy5zZXR0aW5ncy5yaWdodENsaWNrTW92ZSB8fFxuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5yaWdodENsaWNrUmVzZXRUYXNrIHx8XG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLnJpZ2h0Q2xpY2tSZXNldEFsbCB8fFxuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5yaWdodENsaWNrVG9nZ2xlQWxsO1xuXG4gICAgICAgIHRoaXMuaW5pdFNldHRpbmdzID0ge1xuICAgICAgICAgICAgcmVtb3ZlUmVnRXhwOiB0aGlzLnRyeUNyZWF0ZVJlbW92ZVJlZ2V4KFxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MucmVtb3ZlRXhwcmVzc2lvblxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIHJlc2V0UmVnRXhwOiB0aGlzLnRyeUNyZWF0ZVJlc2V0UmVnZXgobW9tZW50TWF0Y2hTdHJpbmcpLFxuICAgICAgICAgICAgaW5jb21wbGV0ZVRhc2tSZWdFeHA6IHRoaXMudHJ5Q3JlYXRlSW5jb21wbGV0ZVJlZ2V4KFxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuaW5jb21wbGV0ZVRhc2tWYWx1ZXNcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICBpbmNvbXBsZXRlVGFza1JlZ0V4cFJvdzI6IHRoaXMudHJ5Q3JlYXRlSW5jb21wbGV0ZVJlZ2V4KFxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuaW5jb21wbGV0ZVRhc2tWYWx1ZXNSb3cyXG4gICAgICAgICAgICApLFxuICAgICAgICAgICAgcmlnaHRDbGlja1Rhc2tNZW51OiByaWdodENsaWNrVGFza01lbnUsXG4gICAgICAgICAgICByZWdpc3RlckhhbmRsZXJzOlxuICAgICAgICAgICAgICAgIHJpZ2h0Q2xpY2tUYXNrTWVudSB8fCB0aGlzLnNldHRpbmdzLnByZXZpZXdPbkNsaWNrLFxuICAgICAgICAgICAgY29tcGxldGVkVGFza3M6IGNvbXBsZXRlZFRhc2tzLFxuICAgICAgICAgICAgY29tcGxldGVkVGFza1JlZ0V4cDogdGhpcy50cnlDcmVhdGVDb21wbGV0ZVJlZ2V4KGNvbXBsZXRlZFRhc2tzKSxcbiAgICAgICAgfTtcbiAgICAgICAgY29uc29sZS5kZWJ1ZyhcbiAgICAgICAgICAgIFwiVGFzayBNYXJrZXI6IHVwZGF0ZWQgY29uZmlndXJhdGlvbiAlbywgJW9cIixcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MsXG4gICAgICAgICAgICB0aGlzLmluaXRTZXR0aW5nc1xuICAgICAgICApO1xuICAgIH1cblxuICAgIHRyeUNyZWF0ZVJlbW92ZVJlZ2V4KHBhcmFtOiBzdHJpbmcpOiBSZWdFeHAge1xuICAgICAgICByZXR1cm4gcGFyYW0gPyBuZXcgUmVnRXhwKHBhcmFtLCBcImdcIikgOiBudWxsO1xuICAgIH1cblxuICAgIHByaXZhdGUgdHJ5Q3JlYXRlUmVzZXRSZWdleChwYXJhbTogc3RyaW5nKTogUmVnRXhwIHtcbiAgICAgICAgcmV0dXJuIHBhcmFtID8gbmV3IFJlZ0V4cChwYXJhbSArIFwiKCBcXFxcXltBLVphLXowLTktXSspPyRcIikgOiBudWxsO1xuICAgIH1cblxuICAgIHByaXZhdGUgdHJ5Q3JlYXRlQ29tcGxldGVSZWdleChwYXJhbTogc3RyaW5nKTogUmVnRXhwIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZWdFeHAoYF4oW1xcXFxzPl0qLSBcXFxcWylbJHtwYXJhbX1dKFxcXFxdIC4qKSRgKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHRyeUNyZWF0ZUluY29tcGxldGVSZWdleChwYXJhbTogc3RyaW5nKTogUmVnRXhwIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZWdFeHAoYF4oW1xcXFxzPl0qLSBcXFxcWylbJHtwYXJhbX1dKFxcXFxdIC4qKSRgKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlbW92ZUNoZWNrYm94RnJvbUxpbmUobGluZVRleHQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBsaW5lVGV4dC5yZXBsYWNlKHRoaXMuc3RyaXBUYXNrLCBcIiQxICQyXCIpO1xuICAgIH1cblxuICAgIC8qKiBfQ29tcGxldGVfIGEgdGFzazogYXBwZW5kIGNvbXBsZXRpb24gdGV4dCwgcmVtb3ZlIGNvbmZpZ3VyZWQgc3RyaW5ncyAqL1xuICAgIHByaXZhdGUgY29tcGxldGVUYXNrTGluZShsaW5lVGV4dDogc3RyaW5nLCBtYXJrID0gXCJ4XCIpOiBzdHJpbmcge1xuICAgICAgICBjb25zb2xlLmRlYnVnKFwiVGFzayBNYXJrZXI6IGNvbXBsZXRlIHRhc2sgd2l0aCAlczogJXNcIiwgbWFyaywgbGluZVRleHQpO1xuICAgICAgICBsZXQgbWFya2VkID0gbGluZVRleHQucmVwbGFjZSh0aGlzLmFueVRhc2tNYXJrLCBgJDEke21hcmt9JDNgKTtcbiAgICAgICAgaWYgKHRoaXMuaW5pdFNldHRpbmdzLnJlbW92ZVJlZ0V4cCkge1xuICAgICAgICAgICAgbWFya2VkID0gbWFya2VkLnJlcGxhY2UodGhpcy5pbml0U2V0dGluZ3MucmVtb3ZlUmVnRXhwLCBcIlwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5hcHBlbmREYXRlRm9ybWF0KSB7XG4gICAgICAgICAgICBjb25zdCBzdHJpY3RMaW5lRW5kaW5nID0gbGluZVRleHQuZW5kc1dpdGgoXCIgIFwiKTtcbiAgICAgICAgICAgIGxldCBibG9ja2lkID0gXCJcIjtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gdGhpcy5ibG9ja1JlZi5leGVjKG1hcmtlZCk7XG4gICAgICAgICAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMl0pIHtcbiAgICAgICAgICAgICAgICBtYXJrZWQgPSBtYXRjaFsxXTtcbiAgICAgICAgICAgICAgICBibG9ja2lkID0gbWF0Y2hbMl07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIW1hcmtlZC5lbmRzV2l0aChcIiBcIikpIHtcbiAgICAgICAgICAgICAgICBtYXJrZWQgKz0gXCIgXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtYXJrZWQgKz0gbW9tZW50KCkuZm9ybWF0KHRoaXMuc2V0dGluZ3MuYXBwZW5kRGF0ZUZvcm1hdCkgKyBibG9ja2lkO1xuICAgICAgICAgICAgaWYgKHN0cmljdExpbmVFbmRpbmcpIHtcbiAgICAgICAgICAgICAgICBtYXJrZWQgKz0gXCIgIFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtYXJrZWQ7XG4gICAgfVxuXG4gICAgbWFya0FsbFRhc2tzQ29tcGxldGUoc291cmNlOiBzdHJpbmcsIG1hcms6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGxpbmVzID0gc291cmNlLnNwbGl0KFwiXFxuXCIpO1xuICAgICAgICBjb25zdCByZXN1bHQ6IHN0cmluZ1tdID0gW107XG5cbiAgICAgICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pbml0U2V0dGluZ3MuaW5jb21wbGV0ZVRhc2tSZWdFeHAuZXhlYyhsaW5lKSkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHRoaXMuY29tcGxldGVUYXNrTGluZShsaW5lLCBtYXJrKSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaW5pdFNldHRpbmdzLmluY29tcGxldGVUYXNrUmVnRXhwUm93Mi5leGVjKGxpbmUpKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2godGhpcy5jb21wbGV0ZVRhc2tMaW5lKGxpbmUsIG1hcmspKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gobGluZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdC5qb2luKFwiXFxuXCIpO1xuICAgIH1cblxuICAgIG1hcmtUYXNrSW5Tb3VyY2UoXG4gICAgICAgIHNvdXJjZTogc3RyaW5nLFxuICAgICAgICBtYXJrOiBzdHJpbmcsXG4gICAgICAgIGxpbmVzOiBudW1iZXJbXSA9IFtdXG4gICAgKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3Qgc3BsaXQgPSBzb3VyY2Uuc3BsaXQoXCJcXG5cIik7XG4gICAgICAgIGZvciAoY29uc3QgbiBvZiBsaW5lcykge1xuICAgICAgICAgICAgc3BsaXRbbl0gPSB0aGlzLm1hcmtUYXNrTGluZShzcGxpdFtuXSwgbWFyayk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNwbGl0LmpvaW4oXCJcXG5cIik7XG4gICAgfVxuXG4gICAgbWFya1Rhc2tJblNvdXJjZUN5Y2xlKFxuICAgICAgICBzb3VyY2U6IHN0cmluZyxcbiAgICAgICAgbWFyazogc3RyaW5nLFxuICAgICAgICBsaW5lczogbnVtYmVyW10gPSBbXVxuICAgICk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IHNwbGl0ID0gc291cmNlLnNwbGl0KFwiXFxuXCIpO1xuICAgICAgICBmb3IgKGNvbnN0IG4gb2YgbGluZXMpIHtcbiAgICAgICAgICAgIHNwbGl0W25dID0gdGhpcy5tYXJrVGFza0xpbmVDeWNsZShzcGxpdFtuXSwgbWFyayk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNwbGl0LmpvaW4oXCJcXG5cIik7XG4gICAgfVxuXG4gICAgbWFya1Rhc2tJblNvdXJjZUNyZWF0ZShcbiAgICAgICAgc291cmNlOiBzdHJpbmcsXG4gICAgICAgIG1hcms6IHN0cmluZyxcbiAgICAgICAgbGluZXM6IG51bWJlcltdID0gW11cbiAgICApOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBzcGxpdCA9IHNvdXJjZS5zcGxpdChcIlxcblwiKTtcbiAgICAgICAgZm9yIChjb25zdCBuIG9mIGxpbmVzKSB7XG4gICAgICAgICAgICBzcGxpdFtuXSA9IHRoaXMubWFya1Rhc2tMaW5lQ3JlYXRlKHNwbGl0W25dLCBtYXJrKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3BsaXQuam9pbihcIlxcblwiKTtcbiAgICB9XG5cbiAgICBhcHBlbmRUZXh0SW5Tb3VyY2UoXG4gICAgICAgIHNvdXJjZTogc3RyaW5nLFxuICAgICAgICBtYXJrOiBzdHJpbmcsXG4gICAgICAgIGxpbmVzOiBudW1iZXJbXSA9IFtdXG4gICAgKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3Qgc3BsaXQgPSBzb3VyY2Uuc3BsaXQoXCJcXG5cIik7XG4gICAgICAgIGZvciAoY29uc3QgbiBvZiBsaW5lcykge1xuICAgICAgICAgICAgc3BsaXRbbl0gPSB0aGlzLmFwcGVuZFRleHRMaW5lKHNwbGl0W25dLCBtYXJrKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3BsaXQuam9pbihcIlxcblwiKTtcbiAgICB9XG5cbiAgICBtYXJrVGFza0xpbmUobGluZVRleHQ6IHN0cmluZywgbWFyazogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgdGFza01hdGNoID0gdGhpcy5hbnlUYXNrTWFyay5leGVjKGxpbmVUZXh0KTtcbiAgICAgICAgY29uc3QgbWFya1N0cmluZyA9IFwiLSBbXCIgKyBtYXJrICsgXCJdIFwiO1xuXG4gICAgICAgIGlmIChtYXJrID09PSBcIkJhY2tzcGFjZVwiKSB7XG4gICAgICAgICAgICBsaW5lVGV4dCA9IHRoaXMucmVtb3ZlQ2hlY2tib3hGcm9tTGluZShsaW5lVGV4dCk7XG4gICAgICAgIH0gZWxzZSBpZiAodGFza01hdGNoKSB7XG4gICAgICAgICAgICBjb25zdCBjb21wbGV0ZU1hcmsgPVxuICAgICAgICAgICAgICAgIHRoaXMuaW5pdFNldHRpbmdzLmNvbXBsZXRlZFRhc2tzLmluZGV4T2YobWFyaykgPj0gMDtcblxuICAgICAgICAgICAgaWYgKG1hcmsgIT09IFwiIFwiKSB7IC8vIE1hcmsgdGFza3NcbiAgICAgICAgICAgICAgICBpZiAobGluZVRleHQudHJpbSgpLnN0YXJ0c1dpdGgobWFya1N0cmluZykpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShgVGFzayBNYXJrZXI6IHRhc2sgYWxyZWFkeSBtYXJrZWQgd2l0aCB0aGUgc2FtZSBzdGF0dXMgXCIke21hcmt9XCIhYCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHsgLy8gTWFyayB0YXNrc1xuICAgICAgICAgICAgICAgICAgICBsZXQgbWFya2VkID0gbGluZVRleHQucmVwbGFjZSh0aGlzLmFueVRhc2tNYXJrLCBgJDEke21hcmt9JDNgKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdFNldHRpbmdzLnJlbW92ZVJlZ0V4cCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VkID0gbWFya2VkLnJlcGxhY2UodGhpcy5pbml0U2V0dGluZ3MucmVtb3ZlUmVnRXhwLCBcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5hcHBlbmREYXRlRm9ybWF0ICYmIGNvbXBsZXRlTWFyaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RyaWN0TGluZUVuZGluZyA9IGxpbmVUZXh0LmVuZHNXaXRoKFwiICBcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgYmxvY2tpZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXRjaCA9IHRoaXMuYmxvY2tSZWYuZXhlYyhtYXJrZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hdGNoICYmIG1hdGNoWzJdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VkID0gbWF0Y2hbMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tpZCA9IG1hdGNoWzJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFtYXJrZWQuZW5kc1dpdGgoXCIgXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VkICs9IFwiIFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VkICs9IG1vbWVudCgpLmZvcm1hdCh0aGlzLnNldHRpbmdzLmFwcGVuZERhdGVGb3JtYXQpICsgYmxvY2tpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdHJpY3RMaW5lRW5kaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VkICs9IFwiICBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNldHRpbmdzLmFwcGVuZFRleHRGb3JtYXRNYXJrICYmIHRoaXMuc2V0dGluZ3MuaW5jb21wbGV0ZVRhc2tWYWx1ZXMuaW5kZXhPZihtYXJrKSA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJpY3RMaW5lRW5kaW5nID0gbGluZVRleHQuZW5kc1dpdGgoXCIgIFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBibG9ja2lkID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gdGhpcy5ibG9ja1JlZi5leGVjKG1hcmtlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMl0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZWQgPSBtYXRjaFsxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBibG9ja2lkID0gbWF0Y2hbMl07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIW1hcmtlZC5lbmRzV2l0aChcIiBcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXJrZWQgKz0gXCIgXCI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXJrZWQgKz0gbW9tZW50KCkuZm9ybWF0KHRoaXMuc2V0dGluZ3MuYXBwZW5kVGV4dEZvcm1hdE1hcmspICsgYmxvY2tpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdHJpY3RMaW5lRW5kaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VkICs9IFwiICBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNldHRpbmdzLmFwcGVuZFRleHRGb3JtYXRNYXJrUm93MiAmJiB0aGlzLnNldHRpbmdzLmluY29tcGxldGVUYXNrVmFsdWVzUm93Mi5pbmRleE9mKG1hcmspID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cmljdExpbmVFbmRpbmcgPSBsaW5lVGV4dC5lbmRzV2l0aChcIiAgXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGJsb2NraWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSB0aGlzLmJsb2NrUmVmLmV4ZWMobWFya2VkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXRjaCAmJiBtYXRjaFsyXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlZCA9IG1hdGNoWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJsb2NraWQgPSBtYXRjaFsyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbWFya2VkLmVuZHNXaXRoKFwiIFwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlZCArPSBcIiBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlZCArPSBtb21lbnQoKS5mb3JtYXQodGhpcy5zZXR0aW5ncy5hcHBlbmRUZXh0Rm9ybWF0TWFya1JvdzIpICsgYmxvY2tpZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdHJpY3RMaW5lRW5kaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VkICs9IFwiICBcIjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBsaW5lVGV4dCA9IG1hcmtlZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1hcmsgPT09IFwiIFwiKSB7IC8vIFJlc2V0IHRhc2tzXG4gICAgICAgICAgICAgICAgbGluZVRleHQgPSB0aGlzLnJlc2V0VGFza0xpbmUobGluZVRleHQsIG1hcmspOyAvLyBPcmlnaW5hbCBjb2RlXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYFRhc2sgTWFya2VyOiB1bmtub3duIG1hcmsgJHttYXJrfSFgKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgICAgICAgICAgICAgXCJUYXNrIE1hcmtlcjogdW5rbm93biBtYXJrICglcyksIGxlYXZpbmcgdW5jaGFuZ2VkOiAlc1wiLFxuICAgICAgICAgICAgICAgICAgICBtYXJrLFxuICAgICAgICAgICAgICAgICAgICBsaW5lVGV4dFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAobWFyayAhPT0gXCJCYWNrc3BhY2VcIikge1xuICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSB0aGlzLmFueUxpc3RJdGVtLmV4ZWMobGluZVRleHQpO1xuICAgICAgICAgICAgaWYgKG1hdGNoICYmIG1hdGNoWzJdKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhcIlRhc2sgTWFya2VyOiBsaXN0IGl0ZW0sIGNvbnZlcnQgdG8gYSB0YXNrICVzXCIsIGxpbmVUZXh0KTtcbiAgICAgICAgICAgICAgICAvLyBjb252ZXJ0IHRvIGEgdGFzaywgYW5kIHRoZW4gbWFya1xuICAgICAgICAgICAgICAgIGxpbmVUZXh0ID0gdGhpcy5tYXJrVGFza0xpbmUoXG4gICAgICAgICAgICAgICAgICAgIGAke21hdGNoWzFdfVsgXSAke21hdGNoWzJdfWAsXG4gICAgICAgICAgICAgICAgICAgIG1hcmtcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBUYXNrIE1hcmtlcjogbm90IGEgdGFzayBvciBsaXN0IGl0ZW0hYCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhcIlRhc2sgTWFya2VyOiBub3QgYSB0YXNrIG9yIGxpc3QgaXRlbSAlc1wiLCBsaW5lVGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxpbmVUZXh0O1xuICAgIH1cblxuICAgIG1hcmtUYXNrTGluZUN5Y2xlKGxpbmVUZXh0OiBzdHJpbmcsIG1hcms6IHN0cmluZyk6IHN0cmluZyB7XG5cbiAgICAgICAgY29uc3QgbWFya1ZhbHVlID0gdGhpcy5zZXR0aW5ncy5jeWNsZVRhc2tWYWx1ZXM7XG4gICAgICAgIGNvbnN0IG1hcmtWYWx1ZUxlbmd0aCA9IG1hcmtWYWx1ZS5sZW5ndGg7XG5cbiAgICAgICAgLy8gUmVncm91cCBtYXJrIGFzIHN0cmluZyBhcnJheVxuICAgICAgICBsZXQgbWFya1N0cmluZ0FycmF5ID0gbmV3IEFycmF5PHN0cmluZz4obWFya1ZhbHVlTGVuZ3RoKTtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXJrVmFsdWVMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbWFya1N0cmluZ0FycmF5W2ldID0gXCItIFtcIiArIG1hcmtWYWx1ZVtpXSArIFwiXSBcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZpbmQgdGhlIG5leHQgaW5kZXhcbiAgICAgICAgbGV0IG1hcmtJbmRleCA9IDA7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbWFya1ZhbHVlTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmIChsaW5lVGV4dC50cmltKCkuc3RhcnRzV2l0aChtYXJrU3RyaW5nQXJyYXlbaV0pKSB7XG4gICAgICAgICAgICAgICAgaWYgKGkgKyAyIDw9IG1hcmtWYWx1ZUxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBtYXJrSW5kZXggPSBpICsgMTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBtYXJrSW5kZXggPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgbGV0IG1hcmtlZCA9IGxpbmVUZXh0LnJlcGxhY2UodGhpcy5hbnlUYXNrTWFyaywgYCQxJHttYXJrVmFsdWVbbWFya0luZGV4XX0kM2ApO1xuXG4gICAgICAgIGlmICh0aGlzLmluaXRTZXR0aW5ncy5yZW1vdmVSZWdFeHApIHtcbiAgICAgICAgICAgIG1hcmtlZCA9IG1hcmtlZC5yZXBsYWNlKHRoaXMuaW5pdFNldHRpbmdzLnJlbW92ZVJlZ0V4cCwgXCJcIik7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBzdHJpY3RMaW5lRW5kaW5nID0gbGluZVRleHQuZW5kc1dpdGgoXCIgIFwiKTtcbiAgICAgICAgbGV0IGJsb2NraWQgPSBcIlwiO1xuICAgICAgICBjb25zdCBtYXRjaCA9IHRoaXMuYmxvY2tSZWYuZXhlYyhtYXJrZWQpO1xuICAgICAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMl0pIHtcbiAgICAgICAgICAgIG1hcmtlZCA9IG1hdGNoWzFdO1xuICAgICAgICAgICAgYmxvY2tpZCA9IG1hdGNoWzJdO1xuICAgICAgICB9XG4gICAgICAgIC8vIGlmICghbWFya2VkLmVuZHNXaXRoKFwiIFwiKSkgeyAvLyBOb3Qgc3VyZSB3aHk/XG4gICAgICAgIC8vICAgICBtYXJrZWQgKz0gXCIgXCI7XG4gICAgICAgIC8vIH1cbiAgICAgICAgbWFya2VkICs9IGJsb2NraWQ7XG4gICAgICAgIGlmIChzdHJpY3RMaW5lRW5kaW5nKSB7XG4gICAgICAgICAgICBtYXJrZWQgKz0gXCIgIFwiO1xuICAgICAgICB9XG5cbiAgICAgICAgbGluZVRleHQgPSBtYXJrZWQ7XG5cbiAgICAgICAgcmV0dXJuIGxpbmVUZXh0O1xuICAgIH1cblxuICAgIG1hcmtUYXNrTGluZUNyZWF0ZShsaW5lVGV4dDogc3RyaW5nLCBtYXJrOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCB0YXNrTWF0Y2ggPSB0aGlzLmFueVRhc2tNYXJrLmV4ZWMobGluZVRleHQpO1xuXG4gICAgICAgIGlmICh0YXNrTWF0Y2gpIHtcbiAgICAgICAgICAgIGlmICghbGluZVRleHQudHJpbSgpLnN0YXJ0c1dpdGgoXCItIFsgXSBcIikpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBUYXNrIE1hcmtlcjogdGFzayBhbHJlYWR5IG1hcmtlZCFgKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRhc2sgTWFya2VyOiB0YXNrIGFscmVhZHkgbWFya2VkLCBsZWF2aW5nIHVuY2hhbmdlZDogJXNcIiwgbGluZVRleHQpO1xuICAgICAgICAgICAgLy8gfSBlbHNlIGlmIChsaW5lVGV4dC50cmltKCkuc3RhcnRzV2l0aChcIi0gWyBdIFwiKSkge1xuICAgICAgICAgICAgLy8gICAgIG5ldyBOb3RpY2UoYFRhc2sgTWFya2VyOiB0YXNrIGFscmVhZHkgY3JlYXRlZCFgKTtcbiAgICAgICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhcIlRhc2sgTWFya2VyOiB0YXNrIGFscmVhZHkgY3JlYXRlZCwgbGVhdmluZyB1bmNoYW5nZWQ6ICVzXCIsIGxpbmVUZXh0KTtcbiAgICAgICAgICAgIH0gZWxzZSB7IC8vIENyZWF0ZSB0YXNrIGFuZCBhcHBlbmQgdGV4dFxuICAgICAgICAgICAgICAgIGxldCBtYXJrZWQgPSBsaW5lVGV4dC5yZXBsYWNlKHRoaXMuYW55VGFza01hcmssIGAkMSR7bWFya30kM2ApO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmFwcGVuZFRleHRGb3JtYXRDcmVhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJpY3RMaW5lRW5kaW5nID0gbGluZVRleHQuZW5kc1dpdGgoXCIgIFwiKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGJsb2NraWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXRjaCA9IHRoaXMuYmxvY2tSZWYuZXhlYyhtYXJrZWQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMl0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlZCA9IG1hdGNoWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tpZCA9IG1hdGNoWzJdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghbWFya2VkLmVuZHNXaXRoKFwiIFwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VkICs9IFwiIFwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG1hcmtlZCArPSBtb21lbnQoKS5mb3JtYXQodGhpcy5zZXR0aW5ncy5hcHBlbmRUZXh0Rm9ybWF0Q3JlYXRpb24pICsgYmxvY2tpZDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0cmljdExpbmVFbmRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlZCArPSBcIiAgXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRhc2sgTWFya2VyOiBhcHBlbmRpbmcgc3RyaW5nIGVtcHR5LCBub3RoaW5nIGFwcGVuZGVkOiAlc1wiLCBsaW5lVGV4dCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxpbmVUZXh0ID0gbWFya2VkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSB0aGlzLmFueUxpc3RJdGVtLmV4ZWMobGluZVRleHQpO1xuICAgICAgICAgICAgaWYgKG1hdGNoICYmIG1hdGNoWzJdKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhcIlRhc2sgTWFya2VyOiBsaXN0IGl0ZW0sIGNvbnZlcnQgdG8gYSB0YXNrICVzXCIsIGxpbmVUZXh0KTtcbiAgICAgICAgICAgICAgICAvLyBjb252ZXJ0IHRvIGEgdGFzaywgYW5kIHRoZW4gbWFya1xuICAgICAgICAgICAgICAgIGxldCBtYXJrZWQgPSBgJHttYXRjaFsxXX1bIF0gJHttYXRjaFsyXX1gO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmFwcGVuZFRleHRGb3JtYXRDcmVhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJpY3RMaW5lRW5kaW5nID0gbGluZVRleHQuZW5kc1dpdGgoXCIgIFwiKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGJsb2NraWQgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBtYXRjaCA9IHRoaXMuYmxvY2tSZWYuZXhlYyhtYXJrZWQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMl0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlZCA9IG1hdGNoWzFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYmxvY2tpZCA9IG1hdGNoWzJdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmICghbWFya2VkLmVuZHNXaXRoKFwiIFwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VkICs9IFwiIFwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG1hcmtlZCArPSBtb21lbnQoKS5mb3JtYXQodGhpcy5zZXR0aW5ncy5hcHBlbmRUZXh0Rm9ybWF0Q3JlYXRpb24pICsgYmxvY2tpZDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0cmljdExpbmVFbmRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hcmtlZCArPSBcIiAgXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRhc2sgTWFya2VyOiBhcHBlbmRpbmcgc3RyaW5nIGVtcHR5LCBub3RoaW5nIGFwcGVuZGVkOiAlc1wiLCBsaW5lVGV4dCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxpbmVUZXh0ID0gbWFya2VkO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBUYXNrIE1hcmtlcjogbm90IGEgdGFzayBvciBsaXN0IGl0ZW0hYCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhcIlRhc2sgTWFya2VyOiBub3QgYSB0YXNrIG9yIGxpc3QgaXRlbSAlc1wiLCBsaW5lVGV4dCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxpbmVUZXh0O1xuICAgIH1cblxuICAgIGFwcGVuZFRleHRMaW5lKGxpbmVUZXh0OiBzdHJpbmcsIG1hcms6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGxldCBtYXJrZWQgPSBsaW5lVGV4dDtcblxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5hcHBlbmRUZXh0Rm9ybWF0QXBwZW5kKSB7XG4gICAgICAgICAgICBjb25zdCBzdHJpY3RMaW5lRW5kaW5nID0gbGluZVRleHQuZW5kc1dpdGgoXCIgIFwiKTtcbiAgICAgICAgICAgIGxldCBibG9ja2lkID0gXCJcIjtcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoID0gdGhpcy5ibG9ja1JlZi5leGVjKG1hcmtlZCk7XG4gICAgICAgICAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMl0pIHtcbiAgICAgICAgICAgICAgICBtYXJrZWQgPSBtYXRjaFsxXTtcbiAgICAgICAgICAgICAgICBibG9ja2lkID0gbWF0Y2hbMl07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIW1hcmtlZC5lbmRzV2l0aChcIiBcIikpIHtcbiAgICAgICAgICAgICAgICBtYXJrZWQgKz0gXCIgXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtYXJrZWQgKz0gbW9tZW50KCkuZm9ybWF0KHRoaXMuc2V0dGluZ3MuYXBwZW5kVGV4dEZvcm1hdEFwcGVuZCkgKyBibG9ja2lkO1xuICAgICAgICAgICAgaWYgKHN0cmljdExpbmVFbmRpbmcpIHtcbiAgICAgICAgICAgICAgICBtYXJrZWQgKz0gXCIgIFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbmV3IE5vdGljZShgVGFzayBNYXJrZXI6IGFwcGVuZGluZyBzdHJpbmcgZW1wdHkhYCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRhc2sgTWFya2VyOiBhcHBlbmRpbmcgc3RyaW5nIGVtcHR5LCBub3RoaW5nIGFwcGVuZGVkOiAlc1wiLCBsaW5lVGV4dCk7XG4gICAgICAgIH1cbiAgICAgICAgbGluZVRleHQgPSBtYXJrZWQ7XG4gICAgICAgIHJldHVybiBsaW5lVGV4dDtcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlc2V0VGFza0xpbmUobGluZVRleHQ6IHN0cmluZywgbWFyayA9IFwiIFwiKTogc3RyaW5nIHtcbiAgICAgICAgY29uc29sZS5kZWJ1ZyhcIlRhc2sgTWFya2VyOiByZXNldCB0YXNrIHdpdGggJXM6ICVzXCIsIG1hcmssIGxpbmVUZXh0KTtcbiAgICAgICAgbGluZVRleHQgPSBsaW5lVGV4dC5yZXBsYWNlKHRoaXMuYW55VGFza01hcmssIGAkMSR7bWFya30kM2ApO1xuICAgICAgICBjb25zdCBzdHJpY3RMaW5lRW5kaW5nID0gbGluZVRleHQuZW5kc1dpdGgoXCIgIFwiKTtcblxuICAgICAgICBsZXQgYmxvY2tpZCA9IFwiXCI7XG4gICAgICAgIGNvbnN0IG1hdGNoID0gdGhpcy5ibG9ja1JlZi5leGVjKGxpbmVUZXh0KTtcbiAgICAgICAgaWYgKG1hdGNoICYmIG1hdGNoWzJdKSB7XG4gICAgICAgICAgICBsaW5lVGV4dCA9IG1hdGNoWzFdO1xuICAgICAgICAgICAgYmxvY2tpZCA9IG1hdGNoWzJdO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmluaXRTZXR0aW5ncy5yZXNldFJlZ0V4cCkge1xuICAgICAgICAgICAgbGluZVRleHQgPSBsaW5lVGV4dC5yZXBsYWNlKHRoaXMuaW5pdFNldHRpbmdzLnJlc2V0UmVnRXhwLCBcIlwiKTtcbiAgICAgICAgfVxuICAgICAgICBsaW5lVGV4dCA9IGxpbmVUZXh0LnJlcGxhY2UoL1xccyokLywgYmxvY2tpZCk7XG4gICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmFwcGVuZFJlbW92ZUFsbFRhc2tzICYmIG1hcmsgIT09IFwiIFwiKSB7XG4gICAgICAgICAgICAvLyBjbGVhciBwcmV2aW91cyBhcHBlbmRlZCB0ZXh0XG4gICAgICAgICAgICBsaW5lVGV4dCA9IHRoaXMuY29tcGxldGVUYXNrTGluZShsaW5lVGV4dCwgbWFyayk7XG4gICAgICAgICAgICAvLyBsaW5lVGV4dCA9IHRoaXMubWFya1Rhc2tMaW5lKGxpbmVUZXh0LCBtYXJrKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RyaWN0TGluZUVuZGluZykge1xuICAgICAgICAgICAgbGluZVRleHQgKz0gXCIgIFwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsaW5lVGV4dDtcbiAgICB9XG5cbiAgICByZXNldEFsbFRhc2tzKHNvdXJjZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAgICAgLy8gY29uc3QgTE9HX0hFQURJTkcgPSB0aGlzLnNldHRpbmdzLmNvbXBsZXRlZEFyZWFIZWFkZXIgfHwgXCIjIyBMb2dcIjtcbiAgICAgICAgY29uc3QgbGluZXMgPSBzb3VyY2Uuc3BsaXQoXCJcXG5cIik7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0OiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICBsZXQgaW5Db21wbGV0ZWRTZWN0aW9uID0gZmFsc2U7XG4gICAgICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgICAgICAgICAgaWYgKGluQ29tcGxldGVkU2VjdGlvbikge1xuICAgICAgICAgICAgICAgIGlmIChsaW5lLnN0YXJ0c1dpdGgoXCIjXCIpIHx8IGxpbmUudHJpbSgpID09PSBcIi0tLVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGluQ29tcGxldGVkU2VjdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChsaW5lKTtcbiAgICAgICAgICAgIC8vIH0gZWxzZSBpZiAobGluZS50cmltKCkgPT09IExPR19IRUFESU5HKSB7XG4gICAgICAgICAgICAvLyAgICAgaW5Db21wbGV0ZWRTZWN0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIC8vICAgICByZXN1bHQucHVzaChsaW5lKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5pc0NvbXBsZXRlZFRhc2tMaW5lKGxpbmUpKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2godGhpcy5yZXNldFRhc2tMaW5lKGxpbmUpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gobGluZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdC5qb2luKFwiXFxuXCIpO1xuICAgIH1cblxuICAgIC8vIG1vdmVDb21wbGV0ZWRUYXNrc0luRmlsZShzb3VyY2U6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8gICAgIGNvbnN0IExPR19IRUFESU5HID0gdGhpcy5zZXR0aW5ncy5jb21wbGV0ZWRBcmVhSGVhZGVyIHx8IFwiIyMgTG9nXCI7XG4gICAgLy8gICAgIGNvbnN0IGxpbmVzID0gc291cmNlLnNwbGl0KFwiXFxuXCIpO1xuXG4gICAgLy8gICAgIGlmIChzb3VyY2UuaW5kZXhPZihMT0dfSEVBRElORykgPCAwKSB7XG4gICAgLy8gICAgICAgICBpZiAobGluZXNbbGluZXMubGVuZ3RoIC0gMV0udHJpbSgpICE9PSBcIlwiKSB7XG4gICAgLy8gICAgICAgICAgICAgbGluZXMucHVzaChcIlwiKTtcbiAgICAvLyAgICAgICAgIH1cbiAgICAvLyAgICAgICAgIGxpbmVzLnB1c2goTE9HX0hFQURJTkcpO1xuICAgIC8vICAgICB9XG5cbiAgICAvLyAgICAgY29uc3QgcmVtYWluaW5nID0gW107XG4gICAgLy8gICAgIGNvbnN0IGNvbXBsZXRlZFNlY3Rpb24gPSBbXTtcbiAgICAvLyAgICAgY29uc3QgbmV3VGFza3MgPSBbXTtcbiAgICAvLyAgICAgbGV0IGluQ29tcGxldGVkU2VjdGlvbiA9IGZhbHNlO1xuICAgIC8vICAgICBsZXQgaW5UYXNrID0gZmFsc2U7XG4gICAgLy8gICAgIGxldCBpbkNhbGxvdXQgPSBmYWxzZTtcbiAgICAvLyAgICAgbGV0IGNvbXBsZXRlZFRhc2tzSW5kZXggPSBsaW5lcy5sZW5ndGg7XG5cbiAgICAvLyAgICAgZm9yIChsZXQgbGluZSBvZiBsaW5lcykge1xuICAgIC8vICAgICAgICAgaWYgKGluQ29tcGxldGVkU2VjdGlvbikge1xuICAgIC8vICAgICAgICAgICAgIGlmIChsaW5lLnN0YXJ0c1dpdGgoXCIjXCIpIHx8IGxpbmUudHJpbSgpID09PSBcIi0tLVwiKSB7XG4gICAgLy8gICAgICAgICAgICAgICAgIGluQ29tcGxldGVkU2VjdGlvbiA9IGZhbHNlO1xuICAgIC8vICAgICAgICAgICAgICAgICByZW1haW5pbmcucHVzaChsaW5lKTtcbiAgICAvLyAgICAgICAgICAgICB9IGVsc2Uge1xuICAgIC8vICAgICAgICAgICAgICAgICBjb21wbGV0ZWRTZWN0aW9uLnB1c2gobGluZSk7XG4gICAgLy8gICAgICAgICAgICAgfVxuICAgIC8vICAgICAgICAgfSBlbHNlIGlmIChsaW5lLnRyaW0oKSA9PT0gTE9HX0hFQURJTkcpIHtcbiAgICAvLyAgICAgICAgICAgICBpbkNvbXBsZXRlZFNlY3Rpb24gPSB0cnVlO1xuICAgIC8vICAgICAgICAgICAgIGNvbXBsZXRlZFRhc2tzSW5kZXggPSByZW1haW5pbmcucHVzaChsaW5lKTtcbiAgICAvLyAgICAgICAgICAgICByZW1haW5pbmcucHVzaChcIiUlJUNPTVBMRVRFRF9JVEVNU19HT19IRVJFJSUlXCIpO1xuICAgIC8vICAgICAgICAgfSBlbHNlIHtcbiAgICAvLyAgICAgICAgICAgICBpZiAodGhpcy5pc0NvbXBsZXRlZFRhc2tMaW5lKGxpbmUpKSB7XG4gICAgLy8gICAgICAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmNvbXBsZXRlZEFyZWFSZW1vdmVDaGVja2JveCkge1xuICAgIC8vICAgICAgICAgICAgICAgICAgICAgbGluZSA9IHRoaXMucmVtb3ZlQ2hlY2tib3hGcm9tTGluZShsaW5lKTtcbiAgICAvLyAgICAgICAgICAgICAgICAgfVxuICAgIC8vICAgICAgICAgICAgICAgICBpblRhc2sgPSB0cnVlO1xuICAgIC8vICAgICAgICAgICAgICAgICBpbkNhbGxvdXQgPSB0aGlzLmlzQ2FsbG91dChsaW5lKTsgLy8gaXMgdGFzayBfaW5zaWRlXyB0aGUgY2FsbG91dFxuICAgIC8vICAgICAgICAgICAgICAgICBuZXdUYXNrcy5wdXNoKGxpbmUpO1xuICAgIC8vICAgICAgICAgICAgIH0gZWxzZSBpZiAoXG4gICAgLy8gICAgICAgICAgICAgICAgIGluVGFzayAmJlxuICAgIC8vICAgICAgICAgICAgICAgICAhdGhpcy5pc1Rhc2tMaW5lKGxpbmUpICYmXG4gICAgLy8gICAgICAgICAgICAgICAgIHRoaXMuaXNDb250aW51YXRpb24obGluZSwgaW5DYWxsb3V0KVxuICAgIC8vICAgICAgICAgICAgICkge1xuICAgIC8vICAgICAgICAgICAgICAgICBuZXdUYXNrcy5wdXNoKGxpbmUpO1xuICAgIC8vICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgLy8gICAgICAgICAgICAgICAgIGluVGFzayA9IGZhbHNlO1xuICAgIC8vICAgICAgICAgICAgICAgICBpbkNhbGxvdXQgPSBmYWxzZTtcbiAgICAvLyAgICAgICAgICAgICAgICAgcmVtYWluaW5nLnB1c2gobGluZSk7XG4gICAgLy8gICAgICAgICAgICAgfVxuICAgIC8vICAgICAgICAgfVxuICAgIC8vICAgICB9XG5cbiAgICAvLyAgICAgbGV0IHJlc3VsdCA9IHJlbWFpbmluZ1xuICAgIC8vICAgICAgICAgLnNsaWNlKDAsIGNvbXBsZXRlZFRhc2tzSW5kZXgpXG4gICAgLy8gICAgICAgICAuY29uY2F0KC4uLm5ld1Rhc2tzKVxuICAgIC8vICAgICAgICAgLmNvbmNhdCguLi5jb21wbGV0ZWRTZWN0aW9uKTtcbiAgICAvLyAgICAgaWYgKGNvbXBsZXRlZFRhc2tzSW5kZXggPCByZW1haW5pbmcubGVuZ3RoIC0gMSkge1xuICAgIC8vICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmNvbmNhdChyZW1haW5pbmcuc2xpY2UoY29tcGxldGVkVGFza3NJbmRleCArIDEpKTtcbiAgICAvLyAgICAgfVxuICAgIC8vICAgICByZXR1cm4gcmVzdWx0LmpvaW4oXCJcXG5cIik7XG4gICAgLy8gfVxuXG4gICAgcHJpdmF0ZSBpc0NvbXBsZXRlZFRhc2tMaW5lKGxpbmVUZXh0OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5pdFNldHRpbmdzLmNvbXBsZXRlZFRhc2tSZWdFeHAudGVzdChsaW5lVGV4dCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpc0luY29tcGxldGVUYXNrTGluZShsaW5lVGV4dDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmluaXRTZXR0aW5ncy5pbmNvbXBsZXRlVGFza1JlZ0V4cC50ZXN0KGxpbmVUZXh0KSB8fCB0aGlzLmluaXRTZXR0aW5ncy5pbmNvbXBsZXRlVGFza1JlZ0V4cFJvdzIudGVzdChsaW5lVGV4dCk7IC8vIEFkZCBSb3cyIGhlcmUgb3Igbm90PyBZZXMuXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpc1Rhc2tMaW5lKGxpbmVUZXh0OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYW55VGFza01hcmsudGVzdChsaW5lVGV4dCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpc0NvbnRpbnVhdGlvbihsaW5lVGV4dDogc3RyaW5nLCBpbkNhbGxvdXQ6IGJvb2xlYW4pOiBib29sZWFuIHtcbiAgICAgICAgaWYgKGluQ2FsbG91dCkge1xuICAgICAgICAgICAgY29uc3QgbWF0Y2ggPSB0aGlzLmJsb2NrUXVvdGUuZXhlYyhsaW5lVGV4dCk7XG4gICAgICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAgICAgICBtYXRjaFsxXS5lbmRzV2l0aChcIj5cIikgfHxcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hbMV0uZW5kc1dpdGgoXCIgIFwiKSB8fFxuICAgICAgICAgICAgICAgICAgICBtYXRjaFsxXS5lbmRzV2l0aChcIlxcdFwiKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuY29udGludWF0aW9uLnRlc3QobGluZVRleHQpO1xuICAgIH1cblxuICAgIHByaXZhdGUgaXNDYWxsb3V0KGxpbmVUZXh0OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmxvY2tRdW90ZS50ZXN0KGxpbmVUZXh0KTtcbiAgICB9XG59XG4iLCAiZXhwb3J0IGludGVyZmFjZSBUYXNrTWFya2VyU2V0dGluZ3Mge1xuICAgIC8vIGNvbXBsZXRlZEFyZWFIZWFkZXI6IHN0cmluZztcbiAgICByZW1vdmVFeHByZXNzaW9uOiBzdHJpbmc7XG4gICAgYXBwZW5kRGF0ZUZvcm1hdDogc3RyaW5nO1xuICAgIGFwcGVuZFRleHRGb3JtYXRNYXJrOiBzdHJpbmc7XG4gICAgYXBwZW5kVGV4dEZvcm1hdE1hcmtSb3cyOiBzdHJpbmc7XG4gICAgYXBwZW5kVGV4dEZvcm1hdENyZWF0aW9uOiBzdHJpbmc7XG4gICAgYXBwZW5kVGV4dEZvcm1hdEFwcGVuZDogc3RyaW5nO1xuICAgIGFwcGVuZFJlbW92ZUFsbFRhc2tzOiBib29sZWFuO1xuICAgIGluY29tcGxldGVUYXNrVmFsdWVzOiBzdHJpbmc7XG4gICAgaW5jb21wbGV0ZVRhc2tWYWx1ZXNSb3cyOiBzdHJpbmc7XG4gICAgY3ljbGVUYXNrVmFsdWVzOiBzdHJpbmc7XG4gICAgc3VwcG9ydENhbmNlbGVkVGFza3M6IGJvb2xlYW47XG4gICAgcHJldmlld09uQ2xpY2s6IGJvb2xlYW47XG4gICAgcmlnaHRDbGlja0NvbXBsZXRlOiBib29sZWFuO1xuICAgIHJpZ2h0Q2xpY2tNYXJrOiBib29sZWFuO1xuICAgIHJpZ2h0Q2xpY2tDeWNsZTogYm9vbGVhbjtcbiAgICByaWdodENsaWNrQ3JlYXRlOiBib29sZWFuO1xuICAgIHJpZ2h0Q2xpY2tBcHBlbmQ6IGJvb2xlYW47XG4gICAgLy8gcmlnaHRDbGlja01vdmU6IGJvb2xlYW47XG4gICAgcmlnaHRDbGlja1Jlc2V0VGFzazogYm9vbGVhbjtcbiAgICByaWdodENsaWNrUmVzZXRBbGw6IGJvb2xlYW47XG4gICAgcmlnaHRDbGlja1RvZ2dsZUFsbDogYm9vbGVhbjtcbiAgICAvLyBjb21wbGV0ZWRBcmVhUmVtb3ZlQ2hlY2tib3g6IGJvb2xlYW47XG4gICAgb25seUxvd2VyY2FzZVg6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBUYXNrTWFya2VyU2V0dGluZ3MgPSB7XG4gICAgLy8gY29tcGxldGVkQXJlYUhlYWRlcjogXCIjIyBMb2dcIixcbiAgICByZW1vdmVFeHByZXNzaW9uOiBcIlwiLFxuICAgIGFwcGVuZERhdGVGb3JtYXQ6IFwiXCIsXG4gICAgYXBwZW5kVGV4dEZvcm1hdE1hcms6IFwiXCIsXG4gICAgYXBwZW5kVGV4dEZvcm1hdE1hcmtSb3cyOiBcIlwiLFxuICAgIGFwcGVuZFRleHRGb3JtYXRDcmVhdGlvbjogXCJcIixcbiAgICBhcHBlbmRUZXh0Rm9ybWF0QXBwZW5kOiBcIlwiLFxuICAgIGFwcGVuZFJlbW92ZUFsbFRhc2tzOiBmYWxzZSxcbiAgICBpbmNvbXBsZXRlVGFza1ZhbHVlczogXCIgXCIsXG4gICAgaW5jb21wbGV0ZVRhc2tWYWx1ZXNSb3cyOiBcIlwiLCAvLyBGb3IgY2hvb3Npbmcgd2hldGhlciB0byBzaG93IGluIHRoZSBzZWNvbmQgcm93XG4gICAgY3ljbGVUYXNrVmFsdWVzOiBcIlwiLFxuICAgIG9ubHlMb3dlcmNhc2VYOiBmYWxzZSxcbiAgICBzdXBwb3J0Q2FuY2VsZWRUYXNrczogdHJ1ZSxcbiAgICBwcmV2aWV3T25DbGljazogZmFsc2UsXG4gICAgcmlnaHRDbGlja0NvbXBsZXRlOiBmYWxzZSxcbiAgICByaWdodENsaWNrTWFyazogZmFsc2UsXG4gICAgcmlnaHRDbGlja0N5Y2xlOiBmYWxzZSxcbiAgICByaWdodENsaWNrQ3JlYXRlOiBmYWxzZSxcbiAgICByaWdodENsaWNrQXBwZW5kOiBmYWxzZSxcbiAgICAvLyByaWdodENsaWNrTW92ZTogZmFsc2UsXG4gICAgcmlnaHRDbGlja1Jlc2V0VGFzazogZmFsc2UsXG4gICAgcmlnaHRDbGlja1Jlc2V0QWxsOiBmYWxzZSxcbiAgICByaWdodENsaWNrVG9nZ2xlQWxsOiBmYWxzZSxcbiAgICAvLyBjb21wbGV0ZWRBcmVhUmVtb3ZlQ2hlY2tib3g6IGZhbHNlLFxufTtcbmV4cG9ydCBpbnRlcmZhY2UgQ29tcGlsZWRUYXNrc1NldHRpbmdzIHtcbiAgICByZW1vdmVSZWdFeHA6IFJlZ0V4cDtcbiAgICByZXNldFJlZ0V4cDogUmVnRXhwO1xuICAgIGluY29tcGxldGVUYXNrUmVnRXhwOiBSZWdFeHA7XG4gICAgaW5jb21wbGV0ZVRhc2tSZWdFeHBSb3cyOiBSZWdFeHA7XG4gICAgLy8gY3JlYXRlVGFza1JlZ0V4cDogUmVnRXhwOyAvLyBNYXliZSBub3QgbmVlZGVkXG4gICAgcmlnaHRDbGlja1Rhc2tNZW51OiBib29sZWFuO1xuICAgIGNvbXBsZXRlZFRhc2tzOiBzdHJpbmc7XG4gICAgY29tcGxldGVkVGFza1JlZ0V4cDogUmVnRXhwO1xuICAgIHJlZ2lzdGVySGFuZGxlcnM6IGJvb2xlYW47XG59XG4iLCAiaW1wb3J0IHsgQXBwLCBtb21lbnQsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7XG4gICAgVGFza01hcmtlclNldHRpbmdzLFxuICAgIC8vIERFRkFVTFRfU0VUVElOR1MsXG59IGZyb20gXCIuL3Rhc2ttYXJrZXItU2V0dGluZ3NcIjtcbmltcG9ydCB7IFRhc2tNYXJrZXIgfSBmcm9tIFwiLi90YXNrbWFya2VyLVRhc2tNYXJrZXJcIjtcbmltcG9ydCBUYXNrTWFya2VyUGx1Z2luIGZyb20gXCIuL21haW5cIjtcblxuZXhwb3J0IGNsYXNzIFRhc2tNYXJrZXJTZXR0aW5nc1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICAgIHBsdWdpbjogVGFza01hcmtlclBsdWdpbjtcbiAgICB0YXNrTWFya2VyOiBUYXNrTWFya2VyO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIGFwcDogQXBwLFxuICAgICAgICBwbHVnaW46IFRhc2tNYXJrZXJQbHVnaW4sXG4gICAgICAgIHRhc2tNYXJrZXI6IFRhc2tNYXJrZXJcbiAgICApIHtcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy50YXNrTWFya2VyID0gdGFza01hcmtlcjtcbiAgICB9XG5cbiAgICBkaXNwbGF5KCk6IHZvaWQge1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmVtcHR5KCk7XG5cbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5jcmVhdGVFbChcImgxXCIsIHsgdGV4dDogXCJUYXNrIE1hcmtlclwiIH0pO1xuXG4gICAgICAgIGNvbnN0IHRlbXBTZXR0aW5nczogVGFza01hcmtlclNldHRpbmdzID0gT2JqZWN0LmFzc2lnbihcbiAgICAgICAgICAgIHRoaXMudGFza01hcmtlci5zZXR0aW5nc1xuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5jcmVhdGVFbChcInBcIiwge1xuICAgICAgICAgICAgdGV4dDogXCIqKlJlb3BlbiB0aGUgdmF1bHQgb3IgcmVzdGFydCBPYnNpZGlhbiBpZiB0aGUgZm9sbG93aW5nIHNldHRpbmcgY2hhbmdlcyBkbyBub3QgdGFrZSBlZmZlY3QuKipcIixcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogXCJDcmVhdGluZyB0YXNrc1wiIH0pO1xuXG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRWwoXCJwXCIsIHtcbiAgICAgICAgICAgIHRleHQ6IFwiQ3JlYXRlZCB0YXNrcyBnYWluIHRyZWF0bWVudCBiYXNlZCBvbiB0aGUgc2V0dGluZ3MgYmVsb3cuXCIsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKHRoaXMuY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIkFwcGVuZCB0ZXh0IHRvIGNyZWF0ZWQgdGFza1wiKVxuICAgICAgICAgICAgLnNldERlc2MoXG4gICAgICAgICAgICAgICAgXCJEZWZhdWx0IGVtcHR5LiBJZiBzZXQgbm9uLWVtcHR5LCBhcHBlbmQgdGhlIHN0cmluZyBvZiBtb21lbnQuanMgZm9ybWF0IHRvIHRoZSBlbmQgb2YgdGhlIHRhc2sgdGV4dC5cIlxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgLmFkZE1vbWVudEZvcm1hdCgobW9tZW50Rm9ybWF0KSA9PlxuICAgICAgICAgICAgICAgIG1vbWVudEZvcm1hdFxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJbXHVEODNEXHVEQ0REIF1ZWVlZLU1NLUREXCIpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0ZW1wU2V0dGluZ3MuYXBwZW5kVGV4dEZvcm1hdENyZWF0aW9uKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRyeSBmb3JtYXR0aW5nIFwibm93XCIgd2l0aCB0aGUgc3BlY2lmaWVkIGZvcm1hdCBzdHJpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb21lbnQoKS5mb3JtYXQodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBTZXR0aW5ncy5hcHBlbmRUZXh0Rm9ybWF0Q3JlYXRpb24gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRhc2tNYXJrZXIudXBkYXRlU2V0dGluZ3ModGVtcFNldHRpbmdzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYEVycm9yIHBhcnNpbmcgc3BlY2lmaWVkIGRhdGUgZm9ybWF0OiAke3ZhbHVlfWBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBcIkNvbXBsZXRpbmcgdGFza3NcIiB9KTtcblxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZUVsKFwicFwiLCB7XG4gICAgICAgICAgICB0ZXh0OiBcIkNvbXBsZXRlZCB0YXNrcyBnYWluIHRyZWF0bWVudCBiYXNlZCBvbiB0aGUgc2V0dGluZ3MgYmVsb3cuXCIsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKHRoaXMuY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIk9ubHkgc3VwcG9ydCB4IGZvciBjb21wbGV0ZWQgdGFza3NcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFxuICAgICAgICAgICAgICAgIFwiT25seSB1c2UgJ3gnIChsb3dlciBjYXNlKSB0byBpbmRpY2F0ZSBjb21wbGV0ZWQgdGFza3MgKGhpZGUgWCAodXBwZXIgY2FzZSkpLlwiXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgICAgICAgICAgdG9nZ2xlXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0ZW1wU2V0dGluZ3Mub25seUxvd2VyY2FzZVgpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBTZXR0aW5ncy5vbmx5TG93ZXJjYXNlWCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50YXNrTWFya2VyLnVwZGF0ZVNldHRpbmdzKHRlbXBTZXR0aW5ncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcodGhpcy5jb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiU3VwcG9ydCBjYW5jZWxlZCB0YXNrc1wiKVxuICAgICAgICAgICAgLnNldERlc2MoXG4gICAgICAgICAgICAgICAgXCJVc2UgJy0nIHRvIGluZGljYXRlIGNhbmNlbGVkIHRhc2tzLiBDYW5jZWxlZCB0YXNrcyBhcmUgcHJvY2Vzc2VkIGluIHRoZSBzYW1lIHdheSBhcyBjb21wbGV0ZWQgdGFza3MuXCJcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgICAgICAgICB0b2dnbGVcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRlbXBTZXR0aW5ncy5zdXBwb3J0Q2FuY2VsZWRUYXNrcylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcFNldHRpbmdzLnN1cHBvcnRDYW5jZWxlZFRhc2tzID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRhc2tNYXJrZXIudXBkYXRlU2V0dGluZ3ModGVtcFNldHRpbmdzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyh0aGlzLmNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJBcHBlbmQgdGV4dCB0byBjb21wbGV0ZWQgdGFza1wiKVxuICAgICAgICAgICAgLnNldERlc2MoXG4gICAgICAgICAgICAgICAgXCJEZWZhdWx0IGVtcHR5LiBJZiBzZXQgbm9uLWVtcHR5LCBhcHBlbmQgdGhlIHN0cmluZyBvZiBtb21lbnQuanMgZm9ybWF0IHRvIHRoZSBlbmQgb2YgdGhlIHRhc2sgdGV4dC5cIlxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgLmFkZE1vbWVudEZvcm1hdCgobW9tZW50Rm9ybWF0KSA9PlxuICAgICAgICAgICAgICAgIG1vbWVudEZvcm1hdFxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJbXHUyNzA1IF1ZWVlZLU1NLUREXCIpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0ZW1wU2V0dGluZ3MuYXBwZW5kRGF0ZUZvcm1hdClcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBUcnkgZm9ybWF0dGluZyBcIm5vd1wiIHdpdGggdGhlIHNwZWNpZmllZCBmb3JtYXQgc3RyaW5nXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9tZW50KCkuZm9ybWF0KHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wU2V0dGluZ3MuYXBwZW5kRGF0ZUZvcm1hdCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGFza01hcmtlci51cGRhdGVTZXR0aW5ncyh0ZW1wU2V0dGluZ3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgRXJyb3IgcGFyc2luZyBzcGVjaWZpZWQgZGF0ZSBmb3JtYXQ6ICR7dmFsdWV9YFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuXG4gICAgICAgIC8vIG5ldyBTZXR0aW5nKHRoaXMuY29udGFpbmVyRWwpXG4gICAgICAgIC8vICAgICAuc2V0TmFtZShcIlJlbW92ZSB0ZXh0IGluIGNvbXBsZXRlZCB0YXNrXCIpXG4gICAgICAgIC8vICAgICAuc2V0RGVzYyhcbiAgICAgICAgLy8gICAgICAgICBcIlRleHQgbWF0Y2hpbmcgdGhpcyByZWd1bGFyIGV4cHJlc3Npb24gc2hvdWxkIGJlIHJlbW92ZWQgZnJvbSB0aGUgdGFzayB0ZXh0LiBCZSBjYXJlZnVsISBUZXN0IHlvdXIgZXhwcmVzc2lvbiBmaXJzdC4gVGhlIGdsb2JhbCBmbGFnLCAnZycgaXMgdXNlZCBmb3IgYSBwZXItbGluZSBtYXRjaC5cIlxuICAgICAgICAvLyAgICAgKVxuICAgICAgICAvLyAgICAgLmFkZFRleHQoKHRleHQpID0+XG4gICAgICAgIC8vICAgICAgICAgdGV4dFxuICAgICAgICAvLyAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCIgIyh0b2RvfHRhc2spXCIpXG4gICAgICAgIC8vICAgICAgICAgICAgIC5zZXRWYWx1ZSh0ZW1wU2V0dGluZ3MucmVtb3ZlRXhwcmVzc2lvbilcbiAgICAgICAgLy8gICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAvLyB0cnkgY29tcGlsaW5nIHRoZSByZWd1bGFyIGV4cHJlc3Npb25cbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICB0aGlzLnRhc2tNYXJrZXIudHJ5Q3JlYXRlUmVtb3ZlUmVnZXgodmFsdWUpO1xuXG4gICAgICAgIC8vICAgICAgICAgICAgICAgICAgICAgdGVtcFNldHRpbmdzLnJlbW92ZUV4cHJlc3Npb24gPSB2YWx1ZTtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICB0aGlzLnRhc2tNYXJrZXIudXBkYXRlU2V0dGluZ3ModGVtcFNldHRpbmdzKTtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICAgICAgYEVycm9yIHBhcnNpbmcgcmVndWxhciBleHByZXNzaW9uIGZvciB0ZXh0IHJlcGxhY2VtZW50OiAke3ZhbHVlfWBcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgfVxuICAgICAgICAvLyAgICAgICAgICAgICB9KVxuICAgICAgICAvLyAgICAgKTtcblxuICAgICAgICAvLyBuZXcgU2V0dGluZyh0aGlzLmNvbnRhaW5lckVsKVxuICAgICAgICAvLyAgICAgLnNldE5hbWUoXCJBcHBseSB0aGVzZSBzZXR0aW5ncyB0byBhbGwgdGFza3NcIilcbiAgICAgICAgLy8gICAgIC5zZXREZXNjKFxuICAgICAgICAvLyAgICAgICAgIFwiQXBwZW5kIGFuZCByZW1vdmUgdGV4dCBhcyBjb25maWd1cmVkIGFib3ZlIHdoZW4gbWFya2luZyB0YXNrcyB3aXRoIGFueXRoaW5nIG90aGVyIHRoYW4gYSBzcGFjZSAodG8gcmVzZXQpLlwiXG4gICAgICAgIC8vICAgICApXG4gICAgICAgIC8vICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgIC8vICAgICAgICAgdG9nZ2xlXG4gICAgICAgIC8vICAgICAgICAgICAgIC5zZXRWYWx1ZSh0ZW1wU2V0dGluZ3MuYXBwZW5kUmVtb3ZlQWxsVGFza3MpXG4gICAgICAgIC8vICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIHRlbXBTZXR0aW5ncy5hcHBlbmRSZW1vdmVBbGxUYXNrcyA9IHZhbHVlO1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgdGhpcy50YXNrTWFya2VyLnVwZGF0ZVNldHRpbmdzKHRlbXBTZXR0aW5ncyk7XG4gICAgICAgIC8vICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgLy8gICAgICAgICAgICAgfSlcbiAgICAgICAgLy8gICAgICk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBcIk1hcmtpbmcgdGFza3NcIiB9KTtcblxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZUVsKFwicFwiLCB7XG4gICAgICAgICAgICB0ZXh0OiBcIk1hcmtlZCB0YXNrcyBnYWluIHRyZWF0bWVudCBiYXNlZCBvbiB0aGUgc2V0dGluZ3MgYmVsb3cuICoqTm90ZSB0aGF0IGlmIGEgbWFyayBjb250YWlucyBib3RoIGluIHJvdyAxIGFuZCByb3cgMiwgdGhlbiB0aGUgbWFyayB3b3VsZCB3b3JrIGFzIHNwZWNpZmllZCBpbiByb3cgMS4qKlwiLFxuICAgICAgICB9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyh0aGlzLmNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJBZGRpdGlvbmFsIHRhc2sgc3RhdHVzZXMgKHJvdyAxKVwiKVxuICAgICAgICAgICAgLnNldERlc2MoXG4gICAgICAgICAgICAgICAgXCJTcGVjaWZ5IHRoZSBzZXQgb2YgY2hhcmFjdGVycyB0aGF0IGluZGljYXRlIGluLXByb2dyZXNzIG9yIGluY29tcGxldGUgdGFza3MsIGUuZy4gJ2k+IT9EJy4gKipBbGwgb2YgdGhlbSAoZXhjbHVkaW5nIHRoZSBmaXJzdCBvcGVuIHN0YXR1cykgY2FuIGJlIGFzc2lnbmVkIHdpdGggaG90a2V5cy4qKlwiXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT5cbiAgICAgICAgICAgICAgICB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIj4hP1wiKVxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGVtcFNldHRpbmdzLmluY29tcGxldGVUYXNrVmFsdWVzKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUuY29udGFpbnMoXCJ4XCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBTZXQgb2YgY2hhcmFjdGVycyBzaG91bGQgbm90IGNvbnRhaW4gdGhlIG1hcmtlciBmb3IgY29tcGxldGVkIHRhc2tzICh4KTogJHt2YWx1ZX1gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIXRlbXBTZXR0aW5ncy5vbmx5TG93ZXJjYXNlWCAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlLmNvbnRhaW5zKFwiWFwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBTZXQgb2YgY2hhcmFjdGVycyBzaG91bGQgbm90IGNvbnRhaW4gdGhlIG1hcmtlciBmb3IgY29tcGxldGVkIHRhc2tzIChYKTogJHt2YWx1ZX1gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcFNldHRpbmdzLnN1cHBvcnRDYW5jZWxlZFRhc2tzICYmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUuY29udGFpbnMoXCItXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYFNldCBvZiBjaGFyYWN0ZXJzIHNob3VsZCBub3QgY29udGFpbiB0aGUgbWFya2VyIGZvciBjYW5jZWxlZCB0YXNrcyAoLSk6ICR7dmFsdWV9YFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdmFsdWUuY29udGFpbnMoXCIgXCIpKSB7IC8vIE5vdCB3b3JraW5nIGlmIHJlbW92ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbWFrZSBzdXJlIHNwYWNlIGlzIGluY2x1ZGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gXCIgXCIgKyB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcFNldHRpbmdzLmluY29tcGxldGVUYXNrVmFsdWVzID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50YXNrTWFya2VyLnVwZGF0ZVNldHRpbmdzKHRlbXBTZXR0aW5ncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgbmV3IFNldHRpbmcodGhpcy5jb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiQXBwZW5kIHRleHQgdG8gbWFya2VkIHRhc2sgKHJvdyAxKVwiKVxuICAgICAgICAgICAgLnNldERlc2MoXG4gICAgICAgICAgICAgICAgXCJEZWZhdWx0IGVtcHR5LiBJZiBzZXQgbm9uLWVtcHR5LCBhcHBlbmQgdGhlIHN0cmluZyBvZiBtb21lbnQuanMgZm9ybWF0IHRvIHRoZSBlbmQgb2YgdGhlIHRhc2sgdGV4dC5cIlxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgLmFkZE1vbWVudEZvcm1hdCgobW9tZW50Rm9ybWF0KSA9PlxuICAgICAgICAgICAgICAgIG1vbWVudEZvcm1hdFxuICAgICAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCJbXHUyNzRFIF1ZWVlZLU1NLUREXCIpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0ZW1wU2V0dGluZ3MuYXBwZW5kVGV4dEZvcm1hdE1hcmspXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVHJ5IGZvcm1hdHRpbmcgXCJub3dcIiB3aXRoIHRoZSBzcGVjaWZpZWQgZm9ybWF0IHN0cmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vbWVudCgpLmZvcm1hdCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcFNldHRpbmdzLmFwcGVuZFRleHRGb3JtYXRNYXJrID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50YXNrTWFya2VyLnVwZGF0ZVNldHRpbmdzKHRlbXBTZXR0aW5ncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBFcnJvciBwYXJzaW5nIHNwZWNpZmllZCBkYXRlIGZvcm1hdDogJHt2YWx1ZX1gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyh0aGlzLmNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIkFkZGl0aW9uYWwgdGFzayBzdGF0dXNlcyAocm93IDIpXCIpXG4gICAgICAgIC5zZXREZXNjKFxuICAgICAgICAgICAgXCJTcGVjaWZ5IHRoZSBzZXQgb2YgY2hhcmFjdGVycyB0aGF0IGluZGljYXRlIHRhc2sgc3RhdHVzZXMsIGUuZy4gJ1JpcCcuICoqQWxsIG9mIHRoZW0gY2FuIGJlIGFzc2lnbmVkIHdpdGggaG90a2V5cy4qKlwiXG4gICAgICAgIClcbiAgICAgICAgLmFkZFRleHQoKHRleHQpID0+XG4gICAgICAgICAgICB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKFwiUmlwXCIpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRlbXBTZXR0aW5ncy5pbmNvbXBsZXRlVGFza1ZhbHVlc1JvdzIpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUuY29udGFpbnMoXCJ4XCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgU2V0IG9mIGNoYXJhY3RlcnMgc2hvdWxkIG5vdCBjb250YWluIHRoZSBtYXJrZXIgZm9yIGNvbXBsZXRlZCB0YXNrcyAoeCk6ICR7dmFsdWV9YFxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgICAgICAgICAgICAgICAgICF0ZW1wU2V0dGluZ3Mub25seUxvd2VyY2FzZVggJiZcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlLmNvbnRhaW5zKFwiWFwiKVxuICAgICAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBTZXQgb2YgY2hhcmFjdGVycyBzaG91bGQgbm90IGNvbnRhaW4gdGhlIG1hcmtlciBmb3IgY29tcGxldGVkIHRhc2tzIChYKTogJHt2YWx1ZX1gXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcFNldHRpbmdzLnN1cHBvcnRDYW5jZWxlZFRhc2tzICYmXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZS5jb250YWlucyhcIi1cIilcbiAgICAgICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgU2V0IG9mIGNoYXJhY3RlcnMgc2hvdWxkIG5vdCBjb250YWluIHRoZSBtYXJrZXIgZm9yIGNhbmNlbGVkIHRhc2tzICgtKTogJHt2YWx1ZX1gXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcFNldHRpbmdzLmluY29tcGxldGVUYXNrVmFsdWVzUm93MiA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50YXNrTWFya2VyLnVwZGF0ZVNldHRpbmdzKHRlbXBTZXR0aW5ncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyh0aGlzLmNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJBcHBlbmQgdGV4dCB0byBtYXJrZWQgdGFzayAocm93IDIpXCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcbiAgICAgICAgICAgICAgICBcIkRlZmF1bHQgZW1wdHkuIElmIHNldCBub24tZW1wdHksIGFwcGVuZCB0aGUgc3RyaW5nIG9mIG1vbWVudC5qcyBmb3JtYXQgdG8gdGhlIGVuZCBvZiB0aGUgdGFzayB0ZXh0LlwiXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAuYWRkTW9tZW50Rm9ybWF0KChtb21lbnRGb3JtYXQpID0+XG4gICAgICAgICAgICAgICAgbW9tZW50Rm9ybWF0XG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIllZWVktTU0tRERcIilcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRlbXBTZXR0aW5ncy5hcHBlbmRUZXh0Rm9ybWF0TWFya1JvdzIpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVHJ5IGZvcm1hdHRpbmcgXCJub3dcIiB3aXRoIHRoZSBzcGVjaWZpZWQgZm9ybWF0IHN0cmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vbWVudCgpLmZvcm1hdCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcFNldHRpbmdzLmFwcGVuZFRleHRGb3JtYXRNYXJrUm93MiA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGFza01hcmtlci51cGRhdGVTZXR0aW5ncyh0ZW1wU2V0dGluZ3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBgRXJyb3IgcGFyc2luZyBzcGVjaWZpZWQgZGF0ZSBmb3JtYXQ6ICR7dmFsdWV9YFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogXCJDeWNsaW5nIHRhc2tzXCIgfSk7XG5cbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5jcmVhdGVFbChcInBcIiwge1xuICAgICAgICAgICAgdGV4dDogXCJDeWNsZWQgdGFza3MgZ2FpbiB0cmVhdG1lbnQgYmFzZWQgb24gdGhlIHNldHRpbmdzIGJlbG93LlwiLFxuICAgICAgICB9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyh0aGlzLmNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIkN5Y2xlZCB0YXNrIHN0YXR1c2VzXCIpXG4gICAgICAgIC5zZXREZXNjKFxuICAgICAgICAgICAgXCJTcGVjaWZ5IHRoZSBzZXQgb2YgY2hhcmFjdGVycyB0aGF0IGluZGljYXRlIGFueSB0YXNrIHN0YXR1c2VzLCBlLmcuICd4LSBSaXA+Jy5cIlxuICAgICAgICApXG4gICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PlxuICAgICAgICAgICAgdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIngtIFJpcFwiKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0ZW1wU2V0dGluZ3MuY3ljbGVUYXNrVmFsdWVzKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcFNldHRpbmdzLmN5Y2xlVGFza1ZhbHVlcyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnRhc2tNYXJrZXIudXBkYXRlU2V0dGluZ3ModGVtcFNldHRpbmdzKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBcIkFwcGVuZGluZyB0ZXh0XCIgfSk7XG5cbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5jcmVhdGVFbChcInBcIiwge1xuICAgICAgICAgICAgdGV4dDogXCJBcHBlbmRlZCB0ZXh0IGdhaW5zIHRyZWF0bWVudCBiYXNlZCBvbiB0aGUgc2V0dGluZ3MgYmVsb3cuXCIsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKHRoaXMuY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIkFwcGVuZCB0ZXh0IHRvIGFueSBsaW5lXCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcbiAgICAgICAgICAgICAgICBcIkRlZmF1bHQgZW1wdHkuIElmIHNldCBub24tZW1wdHksIGFwcGVuZCB0aGUgc3RyaW5nIG9mIG1vbWVudC5qcyBmb3JtYXQgdG8gdGhlIGVuZCBvZiB0aGUgbGluZSB0ZXh0LlwiXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAuYWRkTW9tZW50Rm9ybWF0KChtb21lbnRGb3JtYXQpID0+XG4gICAgICAgICAgICAgICAgbW9tZW50Rm9ybWF0XG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcihcIltcdUQ4M0RcdURDREQgXVlZWVktTU0tRERcIilcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRlbXBTZXR0aW5ncy5hcHBlbmRUZXh0Rm9ybWF0QXBwZW5kKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRyeSBmb3JtYXR0aW5nIFwibm93XCIgd2l0aCB0aGUgc3BlY2lmaWVkIGZvcm1hdCBzdHJpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb21lbnQoKS5mb3JtYXQodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBTZXR0aW5ncy5hcHBlbmRUZXh0Rm9ybWF0QXBwZW5kID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50YXNrTWFya2VyLnVwZGF0ZVNldHRpbmdzKHRlbXBTZXR0aW5ncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGBFcnJvciBwYXJzaW5nIHNwZWNpZmllZCBkYXRlIGZvcm1hdDogJHt2YWx1ZX1gXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICAvLyB0aGlzLmNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBcIk1vdmluZyBjb21wbGV0ZWQgdGFza3NcIiB9KTtcblxuICAgICAgICAvLyBuZXcgU2V0dGluZyh0aGlzLmNvbnRhaW5lckVsKVxuICAgICAgICAvLyAgICAgLnNldE5hbWUoXCJDb21wbGV0ZWQgYXJlYSBoZWFkZXJcIilcbiAgICAgICAgLy8gICAgIC5zZXREZXNjKFxuICAgICAgICAvLyAgICAgICAgIGBDb21wbGV0ZWQgKG9yIGNhbmNlbGVkKSB0YXNrcyB3aWxsIGJlIGluc2VydGVkIHVuZGVyIHRoZSBzcGVjaWZpZWQgaGVhZGVyIChtb3N0IHJlY2VudCBhdCB0aGUgdG9wKS4gV2hlbiBzY2FubmluZyB0aGUgZG9jdW1lbnQgZm9yIGNvbXBsZXRlZC9jYW5jZWxlZCB0YXNrcywgdGhlIGNvbnRlbnRzIGZyb20gdGhpcyBjb25maWd1cmVkIGhlYWRlciB0byB0aGUgbmV4dCBoZWFkaW5nIG9yIHNlcGFyYXRvciAoLS0tKSB3aWxsIGJlIGlnbm9yZWQuIFRoaXMgaGVhZGluZyB3aWxsIGJlIGNyZWF0ZWQgaWYgdGhlIGNvbW1hbmQgaXMgaW52b2tlZCBhbmQgdGhlIGhlYWRpbmcgZG9lcyBub3QgZXhpc3QuIFRoZSBkZWZhdWx0IGhlYWRpbmcgaXMgJyR7REVGQVVMVF9TRVRUSU5HUy5jb21wbGV0ZWRBcmVhSGVhZGVyfScuYFxuICAgICAgICAvLyAgICAgKVxuICAgICAgICAvLyAgICAgLmFkZFRleHQoKHRleHQpID0+XG4gICAgICAgIC8vICAgICAgICAgdGV4dFxuICAgICAgICAvLyAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoXCIjIyBMb2dcIilcbiAgICAgICAgLy8gICAgICAgICAgICAgLnNldFZhbHVlKHRlbXBTZXR0aW5ncy5jb21wbGV0ZWRBcmVhSGVhZGVyKVxuICAgICAgICAvLyAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgIC8vICAgICAgICAgICAgICAgICB0ZW1wU2V0dGluZ3MuY29tcGxldGVkQXJlYUhlYWRlciA9IHZhbHVlLnRyaW0oKTtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIHRoaXMudGFza01hcmtlci51cGRhdGVTZXR0aW5ncyh0ZW1wU2V0dGluZ3MpO1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIC8vICAgICAgICAgICAgIH0pXG4gICAgICAgIC8vICAgICApO1xuXG4gICAgICAgIC8vIG5ldyBTZXR0aW5nKHRoaXMuY29udGFpbmVyRWwpXG4gICAgICAgIC8vICAgICAuc2V0TmFtZShcIlJlbW92ZSB0aGUgY2hlY2tib3ggZnJvbSBtb3ZlZCB0YXNrc1wiKVxuICAgICAgICAvLyAgICAgLnNldERlc2MoXG4gICAgICAgIC8vICAgICAgICAgYFJlbW92ZSB0aGUgY2hlY2tib3ggZnJvbSBjb21wbGV0ZWQgKG9yIGNhbmNlbGVkKSB0YXNrcyBkdXJpbmcgdGhlIG1vdmUgdG8gdGhlIGNvbXBsZXRlZCBhcmVhLiBUaGlzIHRyYW5zZm9ybXMgdGFza3MgaW50byBub3JtYWwgbGlzdCBpdGVtcy4gVGFzayBNYXJrZXIgd2lsbCBub3QgYmUgYWJsZSB0byByZXNldCB0aGVzZSBpdGVtcy4gVGhleSBhbHNvIHdpbGwgbm90IGFwcGVhciBpbiB0YXNrIHNlYXJjaGVzIG9yIHF1ZXJpZXMuIFRoZSBkZWZhdWx0IHZhbHVlIGlzOiAnJHtERUZBVUxUX1NFVFRJTkdTLmNvbXBsZXRlZEFyZWFSZW1vdmVDaGVja2JveH0nLmBcbiAgICAgICAgLy8gICAgIClcbiAgICAgICAgLy8gICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgLy8gICAgICAgICB0b2dnbGVcbiAgICAgICAgLy8gICAgICAgICAgICAgLnNldFZhbHVlKHRlbXBTZXR0aW5ncy5jb21wbGV0ZWRBcmVhUmVtb3ZlQ2hlY2tib3gpXG4gICAgICAgIC8vICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIHRlbXBTZXR0aW5ncy5jb21wbGV0ZWRBcmVhUmVtb3ZlQ2hlY2tib3ggPSB2YWx1ZTtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIHRoaXMudGFza01hcmtlci51cGRhdGVTZXR0aW5ncyh0ZW1wU2V0dGluZ3MpO1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIC8vICAgICAgICAgICAgIH0pXG4gICAgICAgIC8vICAgICApO1xuXG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoMlwiLCB7XG4gICAgICAgICAgICB0ZXh0OiBcIk1hcmtpbmcgdGFza3MgdXNpbmcgbWVudXNcIixcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5jcmVhdGVFbChcInBcIiwge1xuICAgICAgICAgICAgdGV4dDogXCJUYXNrIE1hcmtlciBjcmVhdGVzIGNvbW1hbmRzIHRoYXQgY2FuIGJlIGJvdW5kIHRvIGhvdGtleXMgZm9yIGNvbXBsZXRpbmcsIG1hcmtpbmcgYW5kIHJlc2V0dGluZyB0YXNrcyBpbiBFZGl0aW5nIHZpZXcuIFRoZSBmb2xsb3dpbmcgc2V0dGluZ3MgYWRkIHJpZ2h0IGNsaWNrIGNvbnRleHQgbWVudSBpdGVtcyBmb3IgdGhvc2UgY29tbWFuZHMuXCIsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIG5ldyBTZXR0aW5nKHRoaXMuY29udGFpbmVyRWwpXG4gICAgICAgIC8vICAgICAuc2V0TmFtZShcbiAgICAgICAgLy8gICAgICAgICBcIlByZXZpZXcgLyBMaXZlIHByZXZpZXc6IFNob3cgdGhlIHNlbGVjdGlvbiBtZW51IHdoZW4gYSBjaGVja2JveCBpcyBjbGlja2VkXCJcbiAgICAgICAgLy8gICAgIClcbiAgICAgICAgLy8gICAgIC5zZXREZXNjKFxuICAgICAgICAvLyAgICAgICAgIFwiRGlzcGxheSBhIHBhbmVsIHRoYXQgYWxsb3dzIHlvdSB0byBzZWxlY3QgKHdpdGggbW91c2Ugb3Iga2V5Ym9hcmQpIHRoZSB2YWx1ZSB0byBhc3NpZ24gd2hlbiB5b3UgY2xpY2sgdGhlIHRhc2suIFRoZSBzZWxlY3RlZCB2YWx1ZSB3aWxsIGRldGVybWluZSBmb2xsb3ctb24gYWN0aW9uczogY29tcGxldGUsIGNhbmNlbCwgb3IgcmVzZXQuXCJcbiAgICAgICAgLy8gICAgIClcbiAgICAgICAgLy8gICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgLy8gICAgICAgICB0b2dnbGVcbiAgICAgICAgLy8gICAgICAgICAgICAgLnNldFZhbHVlKHRlbXBTZXR0aW5ncy5wcmV2aWV3T25DbGljaylcbiAgICAgICAgLy8gICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgdGVtcFNldHRpbmdzLnByZXZpZXdPbkNsaWNrID0gdmFsdWU7XG4gICAgICAgIC8vICAgICAgICAgICAgICAgICB0aGlzLnRhc2tNYXJrZXIudXBkYXRlU2V0dGluZ3ModGVtcFNldHRpbmdzKTtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAvLyAgICAgICAgICAgICB9KVxuICAgICAgICAvLyAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyh0aGlzLmNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJBZGQgbWVudSBpdGVtIGZvciBjcmVhdGluZyBhIHRhc2tcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFxuICAgICAgICAgICAgICAgIFwiVGhlIG1lbnUgaXRlbSB3aWxsIGNyZWF0ZSB0aGUgdGFzaywgb24gdGhlIGN1cnJlbnQgbGluZSAob3Igd2l0aGluIHRoZSBjdXJyZW50IHNlbGVjdGlvbiksIGluIGEgd2F5IGFzIHNwZWNpZmllZCBpbiB0aGUgc2VjdGlvbiAqKkNyZWF0aW5nIHRhc2tzKiouXCJcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgICAgICAgICB0b2dnbGVcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRlbXBTZXR0aW5ncy5yaWdodENsaWNrQ3JlYXRlKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wU2V0dGluZ3MucmlnaHRDbGlja0NyZWF0ZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50YXNrTWFya2VyLnVwZGF0ZVNldHRpbmdzKHRlbXBTZXR0aW5ncyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyh0aGlzLmNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJBZGQgbWVudSBpdGVtIGZvciBjb21wbGV0aW5nIGEgdGFza1wiKVxuICAgICAgICAgICAgLnNldERlc2MoXG4gICAgICAgICAgICAgICAgXCJUaGUgbWVudSBpdGVtIHdpbGwgY29tcGxldGUgdGhlIHRhc2ssIG9uIHRoZSBjdXJyZW50IGxpbmUgKG9yIHdpdGhpbiB0aGUgY3VycmVudCBzZWxlY3Rpb24pLCBpbiBhIHdheSBhcyBzcGVjaWZpZWQgaW4gdGhlIHNlY3Rpb24gKipDb21wbGV0aW5nIHRhc2tzKiouXCJcbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgICAgICAgICB0b2dnbGVcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRlbXBTZXR0aW5ncy5yaWdodENsaWNrQ29tcGxldGUpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBTZXR0aW5ncy5yaWdodENsaWNrQ29tcGxldGUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGFza01hcmtlci51cGRhdGVTZXR0aW5ncyh0ZW1wU2V0dGluZ3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgbmV3IFNldHRpbmcodGhpcy5jb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiQWRkIG1lbnUgaXRlbSBmb3IgbWFya2luZyBhIHRhc2tcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFxuICAgICAgICAgICAgICAgIFwiVGhlIHNlbGVjdGVkIHZhbHVlIHdpbGwgbWFyayB0aGUgdGFzaywgb24gdGhlIGN1cnJlbnQgbGluZSAob3Igd2l0aGluIHRoZSBjdXJyZW50IHNlbGVjdGlvbiksIGluIGEgd2F5IGFzIHNwZWNpZmllZCBpbiB0aGUgc2VjdGlvbiAqKk1hcmtpbmcgdGFza3MqKi5cIlxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuICAgICAgICAgICAgICAgIHRvZ2dsZVxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGVtcFNldHRpbmdzLnJpZ2h0Q2xpY2tNYXJrKVxuICAgICAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wU2V0dGluZ3MucmlnaHRDbGlja01hcmsgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGFza01hcmtlci51cGRhdGVTZXR0aW5ncyh0ZW1wU2V0dGluZ3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKHRoaXMuY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiQWRkIG1lbnUgaXRlbSBmb3IgY3ljbGluZyBhIGEgdGFza1wiKVxuICAgICAgICAuc2V0RGVzYyhcbiAgICAgICAgICAgIFwiVGhlIG1lbnUgaXRlbSB3aWxsIGN5Y2xlIHRoZSBzdGF0dXMgb2YgdGhlIHRhc2ssIG9uIHRoZSBjdXJyZW50IGxpbmUgKG9yIHdpdGhpbiB0aGUgY3VycmVudCBzZWxlY3Rpb24pLCBpbiBhIHdheSBhcyBzcGVjaWZpZWQgaW4gdGhlIHNlY3Rpb24gKipDeWNsaW5nIHRhc2tzKiouXCJcbiAgICAgICAgKVxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgICAgICB0b2dnbGVcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGVtcFNldHRpbmdzLnJpZ2h0Q2xpY2tDeWNsZSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBTZXR0aW5ncy5yaWdodENsaWNrQ3ljbGUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50YXNrTWFya2VyLnVwZGF0ZVNldHRpbmdzKHRlbXBTZXR0aW5ncyk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyh0aGlzLmNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJBZGQgbWVudSBpdGVtIGZvciByZXNldHRpbmcgYSB0YXNrXCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcbiAgICAgICAgICAgICAgICBcIlRoZSBtZW51IGl0ZW0gd2lsbCByZXNldCB0aGUgdGFzayBvbiB0aGUgY3VycmVudCBsaW5lIChvciB3aXRoaW4gdGhlIGN1cnJlbnQgc2VsZWN0aW9uKS5cIlxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuICAgICAgICAgICAgICAgIHRvZ2dsZVxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGVtcFNldHRpbmdzLnJpZ2h0Q2xpY2tSZXNldFRhc2spXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBTZXR0aW5ncy5yaWdodENsaWNrUmVzZXRUYXNrID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnRhc2tNYXJrZXIudXBkYXRlU2V0dGluZ3ModGVtcFNldHRpbmdzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIG5ldyBTZXR0aW5nKHRoaXMuY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiQWRkIG1lbnUgaXRlbSBmb3IgYXBwZW5kaW5nIHRleHQgdG8gYSBsaW5lXCIpXG4gICAgICAgIC5zZXREZXNjKFxuICAgICAgICAgICAgXCJUaGUgbWVudSBpdGVtIHdpbGwgYXBwZW5kIHRleHQsIG9uIHRoZSBjdXJyZW50IGxpbmUgKG9yIHdpdGhpbiB0aGUgY3VycmVudCBzZWxlY3Rpb24pLCBpbiBhIHdheSBhcyBzcGVjaWZpZWQgaW4gdGhlIHNlY3Rpb24gKipBcHBlbmRpbmcgdGV4dCoqLlwiXG4gICAgICAgIClcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuICAgICAgICAgICAgdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRlbXBTZXR0aW5ncy5yaWdodENsaWNrQXBwZW5kKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcFNldHRpbmdzLnJpZ2h0Q2xpY2tBcHBlbmQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50YXNrTWFya2VyLnVwZGF0ZVNldHRpbmdzKHRlbXBTZXR0aW5ncyk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gbmV3IFNldHRpbmcodGhpcy5jb250YWluZXJFbClcbiAgICAgICAgLy8gICAgIC5zZXROYW1lKFwiQWRkIG1lbnUgaXRlbSBmb3IgY29tcGxldGluZyBhbGwgdGFza3NcIilcbiAgICAgICAgLy8gICAgIC5zZXREZXNjKFxuICAgICAgICAvLyAgICAgICAgIFwiQWRkIGFuIGl0ZW0gdG8gdGhlIHJpZ2h0LWNsaWNrIG1lbnUgaW4gZWRpdCBtb2RlIHRvIG1hcmsgYWxsIGluY29tcGxldGUgdGFza3MgaW4gdGhlIGN1cnJlbnQgZG9jdW1lbnQgY29tcGxldGUuXCJcbiAgICAgICAgLy8gICAgIClcbiAgICAgICAgLy8gICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgLy8gICAgICAgICB0b2dnbGVcbiAgICAgICAgLy8gICAgICAgICAgICAgLnNldFZhbHVlKHRlbXBTZXR0aW5ncy5yaWdodENsaWNrVG9nZ2xlQWxsKVxuICAgICAgICAvLyAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgIC8vICAgICAgICAgICAgICAgICB0ZW1wU2V0dGluZ3MucmlnaHRDbGlja1RvZ2dsZUFsbCA9IHZhbHVlO1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgdGhpcy50YXNrTWFya2VyLnVwZGF0ZVNldHRpbmdzKHRlbXBTZXR0aW5ncyk7XG4gICAgICAgIC8vICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgLy8gICAgICAgICAgICAgfSlcbiAgICAgICAgLy8gICAgICk7XG5cbiAgICAgICAgLy8gbmV3IFNldHRpbmcodGhpcy5jb250YWluZXJFbClcbiAgICAgICAgLy8gICAgIC5zZXROYW1lKFwiQWRkIG1lbnUgaXRlbSBmb3IgcmVzZXR0aW5nIGFsbCB0YXNrc1wiKVxuICAgICAgICAvLyAgICAgLnNldERlc2MoXG4gICAgICAgIC8vICAgICAgICAgXCJBZGQgYW4gaXRlbSB0byB0aGUgcmlnaHQtY2xpY2sgbWVudSB0byByZXNldCBhbGwgY29tcGxldGVkIChvciBjYW5jZWxlZCkgdGFza3MuXCJcbiAgICAgICAgLy8gICAgIClcbiAgICAgICAgLy8gICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgLy8gICAgICAgICB0b2dnbGVcbiAgICAgICAgLy8gICAgICAgICAgICAgLnNldFZhbHVlKHRlbXBTZXR0aW5ncy5yaWdodENsaWNrUmVzZXRBbGwpXG4gICAgICAgIC8vICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIHRlbXBTZXR0aW5ncy5yaWdodENsaWNrUmVzZXRBbGwgPSB2YWx1ZTtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIHRoaXMudGFza01hcmtlci51cGRhdGVTZXR0aW5ncyh0ZW1wU2V0dGluZ3MpO1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgIC8vICAgICAgICAgICAgIH0pXG4gICAgICAgIC8vICAgICApO1xuXG4gICAgICAgIC8vIG5ldyBTZXR0aW5nKHRoaXMuY29udGFpbmVyRWwpXG4gICAgICAgIC8vICAgICAuc2V0TmFtZShcIkFkZCBtZW51IGl0ZW0gZm9yIG1vdmluZyBhbGwgY29tcGxldGVkIHRhc2tzXCIpXG4gICAgICAgIC8vICAgICAuc2V0RGVzYyhcbiAgICAgICAgLy8gICAgICAgICBcIkFkZCBhbiBpdGVtIHRvIHRoZSByaWdodC1jbGljayBtZW51IHRvIG1vdmUgYWxsIGNvbXBsZXRlZCAob3IgY2FuY2VsZWQpIHRhc2tzLlwiXG4gICAgICAgIC8vICAgICApXG4gICAgICAgIC8vICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgIC8vICAgICAgICAgdG9nZ2xlXG4gICAgICAgIC8vICAgICAgICAgICAgIC5zZXRWYWx1ZSh0ZW1wU2V0dGluZ3MucmlnaHRDbGlja01vdmUpXG4gICAgICAgIC8vICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgLy8gICAgICAgICAgICAgICAgIHRlbXBTZXR0aW5ncy5yaWdodENsaWNrTW92ZSA9IHZhbHVlO1xuICAgICAgICAvLyAgICAgICAgICAgICAgICAgdGhpcy50YXNrTWFya2VyLnVwZGF0ZVNldHRpbmdzKHRlbXBTZXR0aW5ncyk7XG4gICAgICAgIC8vICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgLy8gICAgICAgICAgICAgfSlcbiAgICAgICAgLy8gICAgICk7XG4gICAgfVxufVxuIiwgImltcG9ydCB7IEFwcCwgTW9kYWwgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IFRhc2tNYXJrZXIgfSBmcm9tIFwiLi90YXNrbWFya2VyLVRhc2tNYXJrZXJcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIHByb21wdEZvck1hcmsoXG4gICAgYXBwOiBBcHAsXG4gICAgdGFza01hcmtlcjogVGFza01hcmtlclxuKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgVGFza01hcmtNb2RhbChhcHAsIHRhc2tNYXJrZXIpO1xuXG4gICAgICAgIG1vZGFsLm9uQ2xvc2UgPSAoKSA9PiB7XG4gICAgICAgICAgICByZXNvbHZlKG1vZGFsLmNob3Nlbk1hcmspO1xuICAgICAgICB9O1xuXG4gICAgICAgIG1vZGFsLm9wZW4oKTtcbiAgICB9KTtcbn1cblxuZXhwb3J0IGNsYXNzIFRhc2tNYXJrTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gICAgdGFza01hcmtlcjogVGFza01hcmtlcjtcbiAgICBjaG9zZW5NYXJrOiBzdHJpbmc7XG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHRhc2tNYXJrZXI6IFRhc2tNYXJrZXIpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy50YXNrTWFya2VyID0gdGFza01hcmtlcjtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5pZCA9IFwidGFza21hcmtlci1tb2RhbFwiO1xuICAgIH1cblxuICAgIG9uT3BlbigpOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoXG4gICAgICAgICAgICBcInRhc2ttYXJrZXItc2VsZWN0b3IgbWFya2Rvd24tcHJldmlldy12aWV3XCJcbiAgICAgICAgKTtcblxuICAgICAgICBjb25zdCBjb21wbGV0ZWRMaXN0ID0gc2VsZWN0b3IuY3JlYXRlRWwoXCJ1bFwiKTtcbiAgICAgICAgY29tcGxldGVkTGlzdC5hZGRDbGFzcyhcImNvbnRhaW5zLXRhc2stbGlzdFwiKTtcbiAgICAgICAgdGhpcy5hZGRUYXNrVmFsdWVzKFxuICAgICAgICAgICAgY29tcGxldGVkTGlzdCxcbiAgICAgICAgICAgIHRoaXMudGFza01hcmtlci5pbml0U2V0dGluZ3MuY29tcGxldGVkVGFza3MsXG4gICAgICAgICAgICB0cnVlXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgbGlzdCA9IHNlbGVjdG9yLmNyZWF0ZUVsKFwidWxcIik7XG4gICAgICAgIGxpc3QuYWRkQ2xhc3MoXCJjb250YWlucy10YXNrLWxpc3RcIik7XG4gICAgICAgIHRoaXMuYWRkVGFza1ZhbHVlcyhcbiAgICAgICAgICAgIGxpc3QsXG4gICAgICAgICAgICB0aGlzLnRhc2tNYXJrZXIuc2V0dGluZ3MuaW5jb21wbGV0ZVRhc2tWYWx1ZXMsXG4gICAgICAgICAgICBmYWxzZVxuICAgICAgICApO1xuXG4gICAgICAgIGNvbnN0IGxpc3RSb3cyID0gc2VsZWN0b3IuY3JlYXRlRWwoXCJ1bFwiKTtcbiAgICAgICAgbGlzdFJvdzIuYWRkQ2xhc3MoXCJjb250YWlucy10YXNrLWxpc3RcIik7XG4gICAgICAgIHRoaXMuYWRkVGFza1ZhbHVlcyhcbiAgICAgICAgICAgIGxpc3RSb3cyLFxuICAgICAgICAgICAgdGhpcy50YXNrTWFya2VyLnNldHRpbmdzLmluY29tcGxldGVUYXNrVmFsdWVzUm93MixcbiAgICAgICAgICAgIGZhbHNlXG4gICAgICAgICk7XG5cbiAgICAgICAgY29uc3QgZm9vdGVyID0gc2VsZWN0b3IuY3JlYXRlRWwoXCJuYXZcIik7XG4gICAgICAgIGNvbnN0IGVzYyA9IGZvb3Rlci5jcmVhdGVTcGFuKCk7XG4gICAgICAgIGVzYy5pbm5lckhUTUwgPSBcIjxiPmVzYzwvYj4gdG8gZGlzbWlzc1wiO1xuICAgICAgICBjb25zdCBia3NwID0gZm9vdGVyLmNyZWF0ZVNwYW4oKTtcbiAgICAgICAgYmtzcC5pbm5lckhUTUwgPSBcIjxiPmJrc3A8L2I+IHRvIHJlbW92ZSA8Y29kZT5bXTwvY29kZT5cIjtcblxuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICBjb25zdCBrZXlMaXN0ZW5lciA9IGZ1bmN0aW9uIChldmVudDogS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICAgICAgc2VsZi5jaG9zZW5NYXJrID0gZXZlbnQua2V5O1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGV2ZW50LnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgc2VsZi5jbG9zZSgpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnNjb3BlLnJlZ2lzdGVyKFtdLCBudWxsLCBrZXlMaXN0ZW5lcik7XG4gICAgICAgIHRoaXMuc2NvcGUucmVnaXN0ZXIoW1wiU2hpZnRcIl0sIG51bGwsIGtleUxpc3RlbmVyKTtcbiAgICB9XG5cbiAgICBhZGRUYXNrVmFsdWVzKFxuICAgICAgICBsaXN0OiBIVE1MVUxpc3RFbGVtZW50LFxuICAgICAgICBjaG9pY2VzOiBzdHJpbmcsXG4gICAgICAgIG1hcmtDb21wbGV0ZTogYm9vbGVhblxuICAgICk6IHZvaWQge1xuICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcbiAgICAgICAgZm9yIChjb25zdCBjaGFyYWN0ZXIgb2YgY2hvaWNlcykge1xuICAgICAgICAgICAgY29uc3QgbGkgPSBsaXN0LmNyZWF0ZUVsKFwibGlcIiwge1xuICAgICAgICAgICAgICAgIGNsczpcbiAgICAgICAgICAgICAgICAgICAgXCJ0YXNrLWxpc3QtaXRlbSBcIiArIChjaGFyYWN0ZXIgPT0gXCIgXCIgPyBcIlwiIDogXCIgaXMtY2hlY2tlZFwiKSxcbiAgICAgICAgICAgICAgICBhdHRyOiB7XG4gICAgICAgICAgICAgICAgICAgIFwiZGF0YS10YXNrXCI6IGNoYXJhY3RlcixcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBsaS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgc2VsZi5jaG9zZW5NYXJrID0gY2hhcmFjdGVyO1xuICAgICAgICAgICAgICAgIHNlbGYuY2xvc2UoKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb25zdCBpbnB1dCA9IGxpLmNyZWF0ZUVsKFwiaW5wdXRcIiwge1xuICAgICAgICAgICAgICAgIGNsczogXCJ0YXNrLWxpc3QtaXRlbS1jaGVja2JveFwiLFxuICAgICAgICAgICAgICAgIGF0dHI6IHtcbiAgICAgICAgICAgICAgICAgICAgaWQ6IFwidGFzay1saXN0LWl0ZW0tY2hlY2tib3gtXCIgKyBjaGFyYWN0ZXIsXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiY2hlY2tib3hcIixcbiAgICAgICAgICAgICAgICAgICAgc3R5bGU6IFwicG9pbnRlci1ldmVudHM6IG5vbmU7XCIsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKGNoYXJhY3RlciAhPSBcIiBcIikge1xuICAgICAgICAgICAgICAgIGlucHV0LnNldEF0dHJpYnV0ZShcImNoZWNrZWRcIiwgXCJcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsaS5jcmVhdGVFbChcInNwYW5cIiwge1xuICAgICAgICAgICAgICAgIHRleHQ6IGNoYXJhY3RlciA9PSBcIiBcIiA/IFwiXHUyNDIzXCIgOiBjaGFyYWN0ZXIsXG4gICAgICAgICAgICAgICAgYXR0cjoge1xuICAgICAgICAgICAgICAgICAgICBzdHlsZTogXCJwb2ludGVyLWV2ZW50czogbm9uZTtcIixcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkNsb3NlKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmNvbnRlbnRFbC5lbXB0eSgpO1xuICAgIH1cbn1cbiIsICJpbXBvcnQgeyBBcHAgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEFQSSB9IGZyb20gXCIuL0B0eXBlcy9hcGlcIjtcbmltcG9ydCB7IFRhc2tNYXJrZXIgfSBmcm9tIFwiLi90YXNrbWFya2VyLVRhc2tNYXJrZXJcIjtcbmltcG9ydCB7IHByb21wdEZvck1hcmsgfSBmcm9tIFwiLi90YXNrbWFya2VyLVRhc2tNYXJrTW9kYWxcIjtcblxuZXhwb3J0IGNsYXNzIFRhc2tNYXJrZXJBcGkgaW1wbGVtZW50cyBBUEkge1xuICAgIGFwcDogQXBwO1xuICAgIHRhc2tNYXJrZXI6IFRhc2tNYXJrZXI7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgdGFza01hcmtlcjogVGFza01hcmtlcikge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy50YXNrTWFya2VyID0gdGFza01hcmtlcjtcbiAgICB9XG5cbiAgICBnZXRDb21wbGV0ZWRUYXNrVmFsdWVzKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLnRhc2tNYXJrZXIuaW5pdFNldHRpbmdzLmNvbXBsZXRlZFRhc2tzO1xuICAgIH1cblxuICAgIGdldEluY29tcGxldGVUYXNrVmFsdWVzKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLnRhc2tNYXJrZXIuc2V0dGluZ3MuaW5jb21wbGV0ZVRhc2tWYWx1ZXM7XG4gICAgfVxuXG4gICAgZ2V0TWFyaygpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICByZXR1cm4gcHJvbXB0Rm9yTWFyayh0aGlzLmFwcCwgdGhpcy50YXNrTWFya2VyKTtcbiAgICB9XG5cbiAgICBpc0NvbXBsZXRlKHZhbHVlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgLy8gVGhpcyBtYXkgaW5jbHVkZSBjYW5jZWxsZWQgdGFza3MgKHRob3NlIGFyZSBzdGlsbCBcImNvbXBsZXRlXCIpXG4gICAgICAgIHJldHVybiB0aGlzLmdldENvbXBsZXRlZFRhc2tWYWx1ZXMoKS5jb250YWlucyh2YWx1ZSk7XG4gICAgfVxuICAgIGlzQ2FuY2VsZWQodmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdmFsdWUgPT09IFwiLVwiO1xuICAgIH1cbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7O0FDQUEsSUFBQUEsbUJBVU87OztBQ1ZQLHNCQUFvQztBQU03QixJQUFNLGFBQU4sTUFBaUI7QUFBQSxFQVdwQixZQUFvQixLQUFVO0FBQVY7QUFDaEIsU0FBSyxNQUFNO0FBQ1gsU0FBSyxjQUFjLElBQUksT0FBTyx3QkFBd0I7QUFDdEQsU0FBSyxjQUFjLElBQUksT0FBTywwQkFBMEI7QUFDeEQsU0FBSyxhQUFhLElBQUksT0FBTyxvQkFBb0I7QUFDakQsU0FBSyxXQUFXLElBQUksT0FBTyw0QkFBNEI7QUFDdkQsU0FBSyxlQUFlLElBQUksT0FBTyxhQUFhO0FBQzVDLFNBQUssWUFBWSxJQUFJLE9BQU8sd0JBQXdCO0FBQUEsRUFDeEQ7QUFBQSxFQUVBLGVBQWUsVUFBb0M7QUFDL0MsU0FBSyxXQUFXO0FBQ2hCLFFBQUksb0JBQW9CO0FBRXhCLFFBQUksU0FBUyxrQkFBa0I7QUFFM0IsWUFBTSxXQUFXLENBQUM7QUFFbEIsWUFBTSxTQUFTLE9BQU8sbUJBQW1CLEdBQUc7QUFDNUMsVUFBSTtBQUNKLFVBQUksSUFBSTtBQUVSLDBCQUFvQixTQUFTO0FBQzdCLGNBQVEsUUFBUSxP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
